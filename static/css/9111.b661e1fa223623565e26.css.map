{"version":3,"file":"static/css/9111.b661e1fa223623565e26.css","mappings":"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","sources":["webpack://job/./src/views/home/index/components/card.vue","webpack://job/./src/views/home/index/components/greeting.vue","webpack://job/./src/views/home/index/components/user.vue","webpack://job/./src/views/home/index/components/host-list.vue","webpack://job/./src/views/home/index/components/agent.vue","webpack://job/./src/views/home/index/components/work-statistics.vue","webpack://job/./src/views/home/index/components/favor-task.vue","webpack://job/./src/views/home/index/components/history-record.vue","webpack://job/./src/views/home/index/index.vue"],"sourcesContent":["<template>\n    <div>\n        <div class=\"home-card-layout\">\n            <div v-if=\"title\" class=\"card-title\">{{ title }}</div>\n            <slot />\n        </div>\n    </div>\n</template>\n<script>\n    export default {\n        name: '',\n        props: {\n            title: String,\n        },\n    };\n</script>\n<style lang='postcss'>\n    .home-card-layout {\n        width: 100%;\n        height: 100%;\n        padding: 18px 20px;\n        font-size: 12px;\n        color: #63656e;\n        background: #fff;\n        border-radius: 2px;\n        box-shadow: 0 1px 2px 0 rgb(0 0 0 / 10%);\n\n        .card-title {\n            margin-bottom: 20px;\n            font-size: 14px;\n            font-weight: bold;\n            line-height: 1;\n            color: #313238;\n        }\n    }\n</style>\n","\n<template>\n    <div class=\"greeting-box time-tips\">\n        {{ setAnalysisGreeting() }}\n    </div>\n</template>\n<script>\n   \n    export default {\n        methods: {\n            setAnalysisGreeting () {\n                const txtOne = (currentHour, currentMin) => {\n                    if (currentHour >= 1 && currentHour < 4) {\n                        return `home.现在是凌晨 {HH:MM}！切忌劳累过度，影响身体还容易误操作，赶紧休息吧..., { 'HH:MM': ${currentHour}:${currentMin} }`;\n                    }\n                    return false;\n                };\n                const txtTwo = (currentHour, currentMin) => {\n                    if (currentHour === 4) {\n                        return '感谢你来见证凌晨4点的作业平台，Mamba Forever！曼巴精神！共勉！';\n                    }\n                    return false;\n                };\n                const txtThree = (currentHour, currentMin) => {\n                    if (currentHour >= 5 && currentHour < 7) {\n                        return `home.一年之计在于春、一日之计在于晨！早起的鸟儿有虫吃~ 伙计，加油！', { 'HH:MM': ${currentHour}:${currentMin} })`;\n                    }\n                    return false;\n                };\n                const txtFour = (currentHour, currentMin) => {\n                    if ((currentHour >= 7 && currentHour <= 10) || (currentHour === 11 && currentMin < 40)) {\n                        return `home.上午好！专注工作之时别忘了多饮水，促进身体新陈代谢，有益身体健康噢~', { 'HH:MM': ${currentHour}:${currentMin} })`;\n                    }\n                    return false;\n                };\n                const txtFive = (currentHour, currentMin) => {\n                    if ((currentHour === 11 && currentMin >= 40) || (currentHour === 12 && currentMin < 30)) {\n                        return '午饭时间到了，肠胃很重要！记得按时就餐喔~';\n                    }\n                    return false;\n                };\n                const txtSix = (currentHour, currentMin) => {\n                    if ((currentHour === 12 && currentMin >= 30) || currentHour === 13) {\n                        return '午饭过后，闲庭几步、小憩片刻，下午办公精神更佳！';\n                    }\n                    return false;\n                };\n                const txtSeven = (currentHour, currentMin) => {\n                    if (currentHour >= 14 && currentHour < 18) {\n                        return `home.下午好！预防「久坐成疾」，记得多起来走动走动，松松肩颈，放松片刻。', { 'HH:MM': ${currentHour}:${currentMin} })`;\n                    }\n                    return false;\n                };\n                const txtEight = (currentHour, currentMin) => {\n                    if (currentHour === 18 || (currentHour === 19 && currentMin < 30)) {\n                        return `home.晚上好！夜间人体内消化能力偏弱，饮食切忌太饱，健康绿色膳食为宜。', { 'HH:MM': ${currentHour}:${currentMin} })`;\n                    }\n                    return false;\n                };\n                const txtNight = (currentHour, currentMin) => {\n                    if ((currentHour === 19 && currentMin >= 30) || (currentHour >= 20 && currentHour < 23)) {\n                        return `home.晚上好！少加班，多锻炼噢~ 只要每天做好规划，不怕事情做不好！', { 'HH:MM': ${currentHour}:${currentMin} })`;\n                    }\n                    return false;\n                };\n                const txtTen = (currentHour, currentMin) => {\n                    if (currentHour >= 23 || currentHour < 1) {\n                        return `home.现在是晚上 {HH:MM}，夜深了... 为了自己的身体健康，请早点休息，保持足够睡眠！', { 'HH:MM': ${currentHour}:${currentMin} })`;\n                    }\n                    return false;\n                };\n\n                const greetingMap = {\n                    txtOne,\n                    txtTwo,\n                    txtThree,\n                    txtFour,\n                    txtFive,\n                    txtSix,\n                    txtSeven,\n                    txtEight,\n                    txtNight,\n                    txtTen,\n                };\n                const currentHour = new Date().getHours();\n                const currentMin = new Date().getMinutes() > 10 ? new Date().getMinutes() : `0${new Date().getMinutes()}`;\n                for (const greet in greetingMap) {\n                    const curTxt = greetingMap[greet](currentHour, currentMin);\n                    if (curTxt) {\n                        return curTxt;\n                    }\n                }\n                return '--';\n            },\n        },\n    };\n</script>\n<style lang='postcss' scoped>\n    .time-tips {\n        max-height: 40px;\n        min-height: 20px;\n        margin-top: 15px;\n        margin-bottom: 15px;\n        overflow: hidden;\n    }\n</style>\n","<template>\n    <div class=\"user-box\" v-bkloading=\"{ isLoading }\">\n        <div class=\"user-name\">Hi, {{ userInfo.username }}</div>\n        <greeting />\n        <div\n            class=\"work-tips\"\n            @mousemove=\"handleStopSwiper\"\n            @mouseleave=\"handleBeginSwiper\">\n            <div class=\"work-tips-container\" :style=\"workTipsStyles\">\n                <div v-for=\"(analysis, index) in analysisList\" :key=\"index\" class=\"item\">\n                    <div v-html=\"analysis.description\" @click=\"handleShowList\" />\n                </div>\n            </div>\n        </div>\n        <!-- <jb-dialog\n            v-model=\"isShowList\"\n            :title=\"listInfo.dialogTitle\"\n            :width=\"520\"\n            class=\"home-analysis-detail-dialog\">\n            <div class=\"list-wraper\">\n                <div class=\"data-row-header\">\n                    <div class=\"td-name\">{{ listInfo.columnName }}</div>\n                    <div class=\"td-action\">{{ '操作' }}</div>\n                </div>\n                <div\n                    v-for=\"(item, index) in listData\"\n                    class=\"data-row\"\n                    :key=\"`${item.id}_${index}`\">\n                    <div class=\"td-name\">{{ item.content }}</div>\n                    <div class=\"td-action\" @click=\"handleGoDetail(item)\">{{ '查看详情' }}</div>\n                </div>\n            </div>\n            <template #footer>\n                <bk-button\n                    class=\"list-close-btn\"\n                    @click=\"handleHideList\">\n                    {{ '关闭' }}\n                </bk-button>\n            </template>\n        </jb-dialog> -->\n    </div>\n</template>\n<script>\n    import _ from 'lodash';\n    import marked from 'marked';\n       import StatisticsIndexService from '@service/statistics-index';\n    import UserService from '@service/user';\n    import Greeting from './greeting';\n\n    const dialogTitleMap = {\n        ForbiddenScriptFinder: '使用禁用脚本的作业模板/执行方案',\n        TaskPlanTargetChecker: '存在异常 Agent 的执行方案',\n        TimerTaskFailRateWatcher: '周期成功率低于60%的定时任务',\n        TimerTaskFailWatcher: '近期执行失败的定时任务',\n    };\n    const columnNameMap = {\n        ForbiddenScriptFinder: '作业模板/执行方案',\n        TaskPlanTargetChecker: '作业执行方案',\n        TimerTaskFailRateWatcher: '定时任务',\n        TimerTaskFailWatcher: '定时任务',\n    };\n\n    export default {\n        components: {\n            Greeting,\n        },\n        data () {\n            return {\n                isLoading: true,\n                isShowList: false,\n                dialogTitle: '',\n                analysisIndex: 0,\n                userInfo: {},\n                analysisList: {},\n                greetingInfo: {},\n                listType: '',\n                listData: [],\n            };\n        },\n        computed: {\n            workTipsStyles () {\n                const classes = {\n                    transform: `translateY(${-100 * this.analysisIndex}%)`,\n                };\n                if (this.analysisIndex === 0) {\n                    classes.transition = 'unset';\n                }\n                return classes;\n            },\n            listInfo () {\n                return {\n                    dialogTitle: dialogTitleMap[this.listType],\n                    columnName: columnNameMap[this.listType],\n                };\n            },\n        },\n        created () {\n            this.analysisResultTimer = '';\n            this.analysisMap = {};\n            Promise.all([\n                this.fetchUserInfo(),\n                this.fetchAnalysisResult(),\n            ]).finally(() => {\n                this.isLoading = false;\n            });\n        },\n        methods: {\n            fetchUserInfo () {\n                return UserService.fetchUserInfo()\n                    .then((data) => {\n                        this.userInfo = Object.freeze(data);\n                    });\n            },\n            fetchAnalysisResult () {\n                return StatisticsIndexService.fetchAnalysisResult()\n                    .then((data) => {\n                        const analysisList = [];\n                        const analysisMap = {};\n                        data.forEach((item) => {\n                            const formatLink = link => link.replace(/(?=( href))/g, ' target=\"_blank\"');\n                            let description = _.trim(formatLink(marked(item.description)), '\\n');\n                            if (dialogTitleMap[item.analysisTaskCode]) {\n                                description = description.replace(/(?=<\\/p>$)/, `<span data-id=\"${item.id}\" class=\"action-list\">${'查看列表'}</span>`);\n                            }\n                            const analysis = {\n                                ...item,\n                                description,\n                            };\n                            analysisList.push(analysis);\n                            analysisMap[analysis.id] = analysis;\n                        });\n                        this.analysisList = Object.freeze(analysisList);\n                        this.analysisMap = analysisMap;\n                        this.swiperAnalysisResult();\n                    });\n            },\n            handleHideList () {\n                this.isShowList = false;\n            },\n            handleShowList (event) {\n                const $target = event.target;\n                if ($target.className !== 'action-list') {\n                    return;\n                }\n                const id = $target.getAttribute('data-id');\n                this.listType = this.analysisMap[id].analysisTaskCode;\n                this.listData = Object.freeze(this.analysisMap[id].contents);\n                this.isShowList = true;\n            },\n            handleGoDetail (payload) {\n                let router = {};\n                if (payload.type === 'TEMPLATE') {\n                    router = this.$router.resolve({\n                        name: 'templateDetail',\n                        params: {\n                            id: payload.location.content,\n                        },\n                    });\n                }\n                if (payload.type === 'TASK_PLAN') {\n                    const [templateId, planId] = payload.location.content.split(',');\n                    router = this.$router.resolve({\n                        name: 'viewPlan',\n                        params: {\n                            templateId,\n                        },\n                        query: {\n                            viewPlanId: planId,\n                        },\n                    });\n                }\n                if (payload.type === 'TIMER_TASK') {\n                    router = this.$router.resolve({\n                        name: 'cronList',\n                        query: {\n                            name: payload.location.content,\n                            mode: 'detail',\n                        },\n                    });\n                }\n                window.open(router.href);\n            },\n            handleStopSwiper () {\n                clearTimeout(this.analysisResultTimer);\n            },\n            handleBeginSwiper () {\n                this.swiperAnalysisResult();\n            },\n            swiperAnalysisResult () {\n                if (this.analysisList.length < 1) {\n                    return;\n                }\n                clearTimeout(this.analysisResultTimer);\n                this.analysisResultTimer = setTimeout(() => {\n                    this.swiperAnalysisResult();\n                    if (this.isShowList) {\n                        return;\n                    }\n                    if (this.analysisIndex < this.analysisList.length - 1) {\n                        this.analysisIndex += 1;\n                    } else {\n                        this.analysisIndex = 0;\n                    }\n                }, 3000);\n            },\n        },\n    };\n</script>\n<style lang='postcss'>\n    .user-box {\n        line-height: 20px;\n\n        .user-name {\n            font-size: 24px;\n            line-height: 1;\n            color: #313238;\n        }\n\n        .work-tips {\n            width: 100%;\n            height: 60px;\n            overflow: hidden;\n\n            .work-tips-container {\n                display: flex;\n                flex-direction: column;\n                height: 100%;\n                transition: all 0.15s;\n            }\n\n            .action-list {\n                color: #3a84ff;\n                cursor: pointer;\n            }\n\n            .item {\n                /* stylelint-disable value-no-vendor-prefix */\n                display: -webkit-box;\n                overflow: hidden;\n                text-overflow: ellipsis;\n                -webkit-box-orient: vertical;\n                flex: 0 0 100%;\n                -webkit-line-clamp: 3;\n            }\n\n            code {\n                padding: 2px 4px;\n                font-family: Consolas, monospace, tahoma, Arial;\n                color: #d14;\n                border: 1px solid #e1e1e8;\n            }\n\n            em {\n                font-style: italic;\n            }\n\n            a:hover,\n            a:active {\n                outline: 0;\n            }\n\n            a:focus {\n                outline: thin dotted #333;\n                outline: 5px auto -webkit-focus-ring-color;\n                outline-offset: -2px;\n            }\n\n            a:hover {\n                color: #5590cc;\n                text-decoration: underline;\n            }\n\n            a {\n                color: #6293e2;\n                text-decoration: none;\n            }\n        }\n    }\n\n    .home-analysis-detail-dialog {\n        .bk-dialog-wrapper .bk-dialog-body {\n            padding: 0;\n        }\n\n        .bk-dialog-header-inner {\n            text-align: left;\n        }\n\n        .list-wraper {\n            max-height: 450px;\n            overflow-y: auto;\n            line-height: 41px;\n        }\n\n        .data-row-header {\n            display: flex;\n            background: #fafbfd;\n            border-top: 1px solid #dcdee5;\n\n            .td-name,\n            .td-action {\n                color: #313238;\n            }\n        }\n\n        .data-row {\n            display: flex;\n            font-size: 12px;\n            color: #63656e;\n            border-top: 1px solid #dcdee5;\n\n            .td-action {\n                color: #3a84ff;\n                cursor: pointer;\n            }\n        }\n\n        .td-name {\n            width: 390px;\n            padding-left: 24px;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            white-space: nowrap;\n        }\n\n        .td-action {\n            flex: 0 0 100px;\n            margin-left: auto;\n        }\n\n        .list-close-btn {\n            width: 76px;\n        }\n    }\n\n</style>\n","<template>\n    <div class=\"host-list-wrapper\" v-bkloading=\"{ isLoading }\">\n        <bk-table\n            ext-cls=\"host-table\"\n            :data=\"hostList\"\n            :pagination=\"pagination\"\n            width=\"100%\"\n            @page-change=\"handlePageChange\"\n            @page-limit-change=\"handleLimitChange\">\n            <bk-table-column prop=\"ip\" label=\"IP\" class-name=\"ip-item\" />\n            <bk-table-column :label=\"'云区域'\">\n                <template slot-scope=\"{ row }\">{{ row.cloudAreaInfo.name || '--' }}</template>\n            </bk-table-column>\n            <bk-table-column :label=\"'主机名'\">\n                <template slot-scope=\"{ row }\">{{ row.ipDesc || '--' }}</template>\n            </bk-table-column>\n            <bk-table-column :label=\"'操作系统名称'\">\n                <template slot-scope=\"{ row }\">{{ row.os || '--' }}</template>\n            </bk-table-column>\n        </bk-table>\n    </div>\n</template>\n\n<script>\n    import HomeService from '@service/home';\n\n    export default {\n        props: {\n            statusType: {\n                type: String,\n                default: '',\n            },\n        },\n        data () {\n            return {\n                isLoading: false,\n                hostList: [{},{},{}],\n                pagination: {\n                    count: 30,\n                    current: 1,\n                    limit: 10,\n                },\n            };\n        },\n        created () {\n            this.fetchData();\n        },\n        methods: {\n            fetchData () {\n                const pageSize = this.pagination.limit;\n                const start = parseInt(this.pagination.current - 1, 10) * pageSize;\n                const params = {\n                    agentStatus: this.statusType === 'fail' ? 0 : 1,\n                    start,\n                    pageSize,\n                };\n                this.$request(HomeService.fetchAgentStatus(params), () => {\n                    this.isLoading = true;\n                }).then((data) => {\n                    this.hostList = data.data;\n                    this.pagination = {\n                        ...this.pagination,\n                        count: data.total || 0,\n                    };\n                })\n                    .finally(() => {\n                        this.isLoading = false;\n                    });\n            },\n            handlePageChange (value) {\n                this.pagination.current = value;\n                this.fetchData();\n            },\n            handleLimitChange (value) {\n                this.pagination.current = 1;\n                this.pagination.limit = value;\n                this.fetchData();\n            },\n        },\n    };\n</script>\n\n<style lang=\"postcss\">\n    .host-list-wrapper {\n        height: 100%;\n\n        .host-table {\n            height: 100%;\n            overflow: auto;\n            border: none;\n        }\n\n        .ip-item {\n            padding-left: 40px;\n        }\n    }\n</style>\n","<template>\n    <div class=\"agent-box\" v-bkloading=\"{ isLoading }\">\n        <div class=\"agent-statistics\">\n            <div ref=\"agentStatistics\" style=\"width: 126px; height: 126px;\" />\n        </div>\n        <div class=\"agent-statistics-detail\">\n            <div class=\"detail-item normal\"\n                @mouseover=\"handlePieScale('正常')\"\n                @click=\"handleShowAgentDetail('normal', agentInfo.normalNum)\">\n                <span>{{ '正常' }}</span>\n                <span class=\"detail-value\">{{ agentInfo.normalNum }}</span>\n            </div>\n            <div class=\"detail-item fail\"\n                @mouseover=\"handlePieScale('异常')\"\n                @click=\"handleShowAgentDetail('fail', agentInfo.normalNum)\">\n                <span>{{ '异常' }}</span>\n                <span class=\"detail-value\">{{ agentInfo.abnormalNum }}</span>\n            </div>\n        </div>\n        <sideslider-box :value=\"isShow\" @change=\"handleClose\">\n            <div slot=\"title\">{{ listTitle }}</div>\n            <div slot=\"desc\">\n                <action-extend>\n                    <div class=\"action-item\" @click=\"handleCopyAll\">{{ '复制全部' }}</div>\n                </action-extend>\n            </div>\n            <host-list :status-type=\"statusType\" />\n        </sideslider-box>\n    </div>\n</template>\n<script>\n       import echarts from 'lib/echarts.min.js';\n    import HomeService from '@service/home';\n    import SidesliderBox from '@components/choose-ip/components/sideslider-box';\n    import ActionExtend from '@components/choose-ip/components/action-extend';\n    import HostList from './host-list';\n    import {\n        execCopy,\n    } from '@utils/assist';\n\n    export default {\n        name: '',\n        components: {\n            SidesliderBox,\n            ActionExtend,\n            HostList,\n        },\n        data () {\n            return {\n                isLoading: false,\n                isShow: false,\n                statusType: '',\n                allHostList: [{},{},{}],\n                agentInfo: {},\n            };\n        },\n        computed: {\n            listTitle () {\n                const statusListMap = {\n                    normal: 'Agent 正常的机器列表：',\n                    fail: 'Agent 异常的机器列表：',\n                };\n                return statusListMap[this.statusType];\n            },\n            defaultHighlight () {\n                return (this.agentInfo.abnormalNum || !this.agentInfo.normalNum)\n                    ? '异常'\n                    : '正常';\n            },\n        },\n        created () {\n            this.fetchStatisticsAgent();\n        },\n        methods: {\n            fetchStatisticsAgent () {\n                this.$request(HomeService.fetchStatisticsAgent(), () => {\n                    this.isLoading = true;\n                }).then((data) => {\n                    this.agentInfo = data;\n                    this.initAgentStatistics();\n                })\n                    .finally(() => {\n                        this.isLoading = false;\n                    });\n            },\n            handleShowAgentDetail (status, count) {\n                if (!count) {\n                    return;\n                }\n                this.isShow = true;\n                this.statusType = status;\n                this.fetchAllAgentStatus();\n            },\n            handleClose () {\n                this.isShow = false;\n            },\n            handleCopyAll () {\n                const allIP = this.allHostList.map(_ => _.split(':').pop());\n                execCopy(allIP.join('\\n'), `${'复制成功'}（${allIP.length}${'个IP'}）`);\n            },\n            fetchAllAgentStatus () {\n                const agentStatus = this.statusType === 'fail' ? 0 : 1;\n                HomeService.fetchAllAgentStatus({\n                    agentStatus,\n                }).then((data) => {\n                    this.allHostList = data.data;\n                });\n            },\n            handlePieScale (curName) {\n                const statusMap = [\n                    '正常',\n                    '异常',\n                ];\n                const selectItem = [\n                    curName,\n                ];\n                const unSelectItems = statusMap.filter(item => item !== selectItem[0]);\n                this.myChart.dispatchAction({ type: 'highlight', name: selectItem });\n                this.myChart.dispatchAction({ type: 'downplay', name: unSelectItems });\n            },\n            initAgentStatistics () {\n                this.myChart = echarts.init(this.$refs.agentStatistics);\n                const option = {\n                    series: [\n                        {\n                            type: 'pie',\n                            radius: [\n                                '43',\n                                '53',\n                            ],\n                            selectedMode: 'single',\n                            hoverOffset: 5,\n                            selectedOffset: 0,\n                            avoidLabelOverlap: false,\n                            label: {\n                                normal: {\n                                    show: false,\n                                    position: 'center',\n                                },\n                                emphasis: {\n                                    show: true,\n                                    label: {\n                                        fontSize: '12',\n                                        fontWeight: 'bold',\n                                    },\n                                    formatter: [\n                                        '{value|{d}%}',\n                                        '{b}',\n                                    ].join('\\n'),\n\n                                    rich: {\n                                        name: {\n                                            fontSize: 12,\n                                            lineHieght: 16,\n                                        },\n                                        value: {\n                                            fontSize: 20,\n                                            fontWeight: 600,\n                                            lineHeight: 26,\n                                            color: '#000',\n                                        },\n                                    },\n                                },\n                            },\n                            labelLine: {\n                                normal: {\n                                    show: false,\n                                },\n                            },\n                            data: [\n                                {\n                                    value: this.agentInfo.normalNum,\n                                    key: 'normal',\n                                    name: '正常',\n                                    itemStyle: {\n                                        color: '#2DCB9D',\n                                    },\n                                    emphasis: {\n                                        label: {\n                                            show: true,\n                                        },\n                                    },\n                                },\n                                {\n                                    value: this.agentInfo.abnormalNum,\n                                    key: 'fail',\n                                    name: '异常',\n                                    itemStyle: {\n                                        color: '#FF565C',\n                                    },\n                                },\n                            ],\n                        },\n                    ],\n                };\n                this.myChart.setOption(option);\n                this.myChart.on('click', (params) => {\n                    this.handleShowAgentDetail(params.data.key, params.data.value);\n                });\n                this.myChart.on('mouseover', (params) => {\n                    this.handlePieScale(params.data.name);\n                });\n                this.myChart.dispatchAction({\n                    type: 'highlight',\n                    name: this.defaultHighlight,\n                });\n            },\n        },\n    };\n</script>\n<style lang='postcss' scoped>\n    .agent-box {\n        display: flex;\n        justify-content: center;\n\n        .agent-statistics {\n            margin-top: -10px;\n        }\n\n        .agent-statistics-detail {\n            width: 102px;\n            margin-left: 7.4%;\n            font-size: 12px;\n            line-height: 30px;\n        }\n\n        .detail-item {\n            display: flex;\n            align-items: center;\n            color: #63656e;\n            cursor: pointer;\n\n            &::before {\n                display: block;\n                width: 12px;\n                height: 3px;\n                margin-right: 8px;\n                content: \"\";\n            }\n\n            &.normal {\n                &::before {\n                    background: #2dcb9d;\n                }\n            }\n\n            &.fail {\n                &::before {\n                    background: #ff565c;\n                }\n            }\n\n            &.uninstalled {\n                &::before {\n                    background: #dcdee5;\n                }\n            }\n\n            .detail-value {\n                margin-left: auto;\n                font-weight: bold;\n            }\n        }\n    }\n</style>\n","<template>\n    <router-link class=\"work-statistics-box\" :to=\"{ name: link }\">\n        <div class=\"work-flag\">\n            <Icon class=\"hexagon\" type=\"hexagon\" svg />\n            <Icon class=\"statistics\" :type=\"type\" svg />\n        </div>\n        <div class=\"work-total\">\n            <slot v-bind:jobNum=\"jobNum\" v-bind:scriptNum=\"scriptNum\" />\n        </div>\n        <div class=\"work-name\">\n            <slot name=\"name\" />\n        </div>\n    </router-link>\n</template>\n<script>\n    import HomeService from '@service/home';\n\n    export default {\n        name: '',\n        props: {\n            type: {\n                type: String,\n                default: '',\n            },\n            link: {\n                type: String,\n                default: '',\n            },\n        },\n        data () {\n            return {\n                jobNum: 0,\n                scriptNum: 0,\n            };\n        },\n        created () {\n            this.fetchStatisticsJobAndScript();\n        },\n        methods: {\n            fetchStatisticsJobAndScript () {\n                HomeService.fetchStatisticsJobAndScript()\n                    .then(({ jobNum, scriptNum }) => {\n                        this.jobNum = jobNum;\n                        this.scriptNum = scriptNum;\n                    });\n            },\n        },\n    };\n</script>\n<style lang='postcss'>\n    @keyframes hexagon-scale {\n        0% {\n            transform: scale(0);\n        }\n\n        70% {\n            transform: scale(1.5);\n        }\n\n        80% {\n            transform: scale(1.2);\n        }\n\n        90% {\n            transform: scale(1.4);\n        }\n\n        100% {\n            transform: scale(1.3);\n        }\n    }\n\n    .work-statistics-box {\n        display: flex;\n        justify-content: center;\n        flex-direction: column;\n        align-items: center;\n        padding-top: 18px;\n        text-align: center;\n        cursor: pointer;\n\n        .work-flag {\n            position: relative;\n            display: flex;\n            justify-content: center;\n            width: 100px;\n            height: 60px;\n            margin-bottom: 15px;\n        }\n\n        .work-total {\n            font-size: 24px;\n            font-weight: bold;\n            color: #313238;\n        }\n\n        .work-name {\n            margin-top: 2px;\n            color: #979ba5;\n        }\n\n        .hexagon {\n            font-size: 60px;\n            color: #e3edff;\n        }\n\n        .statistics {\n            position: absolute;\n            top: 15px;\n            font-size: 30px;\n            color: #3a84ff;\n        }\n    }\n</style>\n","<template>\n    <div class=\"favor-task-box\" ref=\"container\" v-bkloading=\"{ isLoading }\">\n        <template v-if=\"!isLoading\">\n            <bk-table v-if=\"favorList.length > 0\" :data=\"favorList\" :height=\"height\">\n                <bk-table-column prop=\"name\" :label=\"'作业模板名称'\" show-overflow-tooltip>\n                    <template slot-scope=\"{ row }\">\n                        <auth-router-link\n                            :permission=\"row.canView\"\n                            auth=\"job_template/view\"\n                            :resource-id=\"row.id\"\n                            class=\"task-name-text\"\n                            :to=\"{\n                                name: 'templateDetail',\n                                params: {\n                                    id: 4 || row.id,\n                                },\n                            }\">\n                            {{ row.name }}\n                        </auth-router-link>\n                    </template>\n                </bk-table-column>\n                <bk-table-column\n                    width=\"100\"\n                    prop=\"status\"\n                    :label=\"'状态'\">\n                    {{ '已上线' }}\n                </bk-table-column>\n                <bk-table-column\n                    width=\"180\"\n                    prop=\"lastModifyUser\"\n                    :label=\"'更新人'\" />\n                <bk-table-column\n                    width=\"180\"\n                    prop=\"lastModifyTime\"\n                    :label=\"'更新时间'\" />\n                <bk-table-column :label=\"'操作'\" width=\"200\" class-name=\"task-action\">\n                    <template slot-scope=\"{ row }\">\n                        <auth-router-link\n                            :permission=\"row.canView\"\n                            auth=\"job_template/view\"\n                            :resource-id=\"row.id\"\n                            :to=\"{\n                                name: 'viewPlan',\n                                params: {\n                                    templateId: 4 || row.id,\n                                },\n                            }\">\n                            {{ '执行方案' }}\n                        </auth-router-link>\n                        <auth-router-link\n                            :permission=\"row.canDebug\"\n                            auth=\"job_template/debug\"\n                            :resource-id=\"row.id\"\n                            :to=\"{\n                                name: 'debugPlan',\n                                params: {\n                                    id: 4 || row.id,\n                                },\n                            }\">\n                            {{ '调试' }}\n                        </auth-router-link>\n                        <auth-router-link\n                            :permission=\"row.canEdit\"\n                            auth=\"job_template/edit\"\n                            :resource-id=\"row.id\"\n                            :to=\"{\n                                name: 'templateEdit',\n                                params: {\n                                    id: 4 || row.id,\n                                },\n                            }\">\n                            {{ '编辑' }}\n                        </auth-router-link>\n                    </template>\n                </bk-table-column>\n            </bk-table>\n            <div v-else class=\"list-empty\">\n                <img class=\"empty-flag\" src=\"/static/images/favor-task-empty.png\">\n                <div style=\"margin-top: 12px; font-size: 14px; color: #63656e;\">{{ '暂无收藏的作业' }}</div>\n                <div style=\"margin-top: 10px; font-size: 12px; color: #979ba5;\">{{ '将鼠标悬浮到作业模板行，点击收藏图标' }}</div>\n            </div>\n        </template>\n    </div>\n</template>\n<script>\n    import HomeService from '@service/home';\n\n    export default {\n        data () {\n            return {\n                isLoading: true,\n                height: undefined,\n                favorList: [{},{},{}],\n            };\n        },\n        created () {\n            this.fetchMyFavorList();\n        },\n        mounted () {\n            this.init();\n            window.addEventListener('resize', this.init);\n            this.$once('hook:beforeDestroy', () => {\n                window.removeEventListener('resize', this.init);\n            });\n        },\n        methods: {\n            fetchMyFavorList () {\n                HomeService.fetchMyFavorList()\n                    .then((data) => {\n                        this.favorList = Object.freeze(data);\n                    })\n                    .finally(() => {\n                        this.isLoading = false;\n                    });\n            },\n            init () {\n                const { height } = this.$refs.container.getBoundingClientRect();\n                this.height = height;\n            },\n        },\n    };\n</script>\n<style lang='postcss' scoped>\n    .favor-task-box {\n        height: calc(100vh - 484px);\n\n        .task-action {\n            .cell {\n                & > * {\n                    margin-right: 10px;\n                }\n            }\n        }\n\n        .list-empty {\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            align-items: center;\n            height: 100%;\n            margin: 0 auto;\n            text-align: center;\n\n            .empty-flag {\n                width: auto;\n                height: 50%;\n                max-height: 240px;\n                margin-top: -40px;\n            }\n        }\n    }\n</style>\n","<template>\n    <div class=\"history-record-box\" v-bkloading=\"{ isLoading }\">\n        <div v-if=\"!isLoading\" class=\"history-record\">\n            <template v-if=\"recordList.length > 0\">\n                <scroll-faker>\n                    <div\n                        v-for=\"record in recordList\"\n                        :key=\"record.id\"\n                        class=\"record-item\"\n                        :class=\"record.statusClass\"\n                        @click=\"handleViewExecuteDetail(record)\">\n                        <div class=\"item-header\">\n                            <div class=\"record-name\">{{ record.name }}</div>\n                            <div class=\"record-label\" v-html=\"record.statusDescHtml\" />\n                        </div>\n                        <div class=\"item-body\">\n                            <span>{{ record.startTime }}</span>\n                            <span class=\"record-operator\">{{ record.operator }}</span>\n                            <div class=\"record-total-time\">{{ record.totalTimeText }}</div>\n                        </div>\n                    </div>\n                </scroll-faker>\n            </template>\n            <Empty v-else :title=\"'暂无执行记录'\" class=\"record-empty\" />\n            <div class=\"record-actions\">\n                <bk-radio-group\n                    :value=\"recordOperator\"\n                    @change=\"handleRecordFilterChange\"\n                    class=\"record-filter\">\n                    <bk-radio-button value=\"\">\n                        {{ '全部' }}\n                    </bk-radio-button>\n                    <bk-radio-button :value=\"userInfo.username\">\n                        {{ '我执行' }}\n                    </bk-radio-button>\n                </bk-radio-group>\n                <router-link :to=\"{ name: 'historyList' }\" class=\"action-btn\">\n                    {{ '更多' }}\n                </router-link>\n            </div>\n        </div>\n    </div>\n</template>\n<script>\n    import TaskExecuteService from '@service/task-execute';\n    import UserService from '@service/user';\n    import Empty from '@components/empty';\n\n    export default {\n        components: {\n            Empty,\n        },\n        data () {\n            return {\n                userInfo: {},\n                isLoading: true,\n                recordOperator: '',\n                recordList: [{},{},{}],\n            };\n        },\n        created () {\n            this.fetchUserInfo();\n            this.fetchExecuteHistory();\n        },\n        methods: {\n            /**\n             * @desc 获取登录用户信息\n            */\n            fetchUserInfo () {\n                UserService.fetchUserInfo()\n                    .then((data) => {\n                        this.userInfo = Object.freeze(data);\n                    });\n            },\n            /**\n             * @desc 获取任务执行历史\n             *\n             * 时间返回默认是 30 天\n            */\n            fetchExecuteHistory () {\n                this.isLoading = true;\n\n                const params = {\n                    timeRange: 30,\n                };\n                if (this.recordOperator) {\n                    params.operator = this.recordOperator;\n                    params.startupModes = '1,2';\n                }\n                TaskExecuteService.fetchExecutionHistoryList(params)\n                    .then((data) => {\n                        this.recordList = Object.freeze(data.data);\n                    })\n                    .finally(() => {\n                        this.isLoading = false;\n                    });\n            },\n            /**\n             * @desc 筛选登录用户执行列表\n             * @param {String} operator 登录用户名\n            */\n            handleRecordFilterChange (operator) {\n                this.recordOperator = operator;\n                this.fetchExecuteHistory();\n            },\n            /**\n             * @desc 跳转任务执行详情页面\n             * @param {Object} taskInstance 任务执行实例\n            */\n            handleViewExecuteDetail (taskInstance) {\n                if (taskInstance.isTask) {\n                    this.$router.push({\n                        name: 'historyTask',\n                        params: {\n                            id: taskInstance.id,\n                        },\n                    });\n                    return;\n                }\n                this.$router.push({\n                    name: 'historyStep',\n                    params: {\n                        taskInstanceId: taskInstance.id,\n                    },\n                });\n            },\n        },\n    };\n</script>\n<style lang='postcss'>\n    .history-record-box {\n        position: relative;\n        width: 100%;\n        height: calc(100vh - 484px);\n\n        .history-record {\n            height: 100%;\n            padding-right: 15px;\n            margin-right: -15px;\n        }\n\n        .record-empty {\n            height: 100%;\n\n            img {\n                margin-top: -30px;\n            }\n        }\n\n        .record-item {\n            display: flex;\n            flex-direction: column;\n            padding: 3px 6px 5px;\n            margin-bottom: 5px;\n            line-height: 16px;\n            color: #c4c6cc;\n            cursor: pointer;\n\n            &:hover {\n                background: #fafbfd;\n\n                .record-name {\n                    color: #3a84ff;\n                }\n            }\n\n            &.success,\n            &.forced {\n                .record-label {\n                    background: rgb(45 203 157 / 14%);\n                }\n            }\n\n            &.fail {\n                .record-label {\n                    background: rgb(255 86 92 / 14%);\n                }\n            }\n\n            &.confirm {\n                .record-label {\n                    background: rgb(255 156 1 / 14%);\n                }\n            }\n\n            &.loading {\n                .record-label {\n                    background: rgb(58 132 255 / 14%);\n                }\n            }\n\n            .item-header,\n            .item-body {\n                display: flex;\n            }\n\n            .item-body {\n                margin-top: 6px;\n            }\n\n            .record-name {\n                margin-right: auto;\n                color: #63656e;\n            }\n\n            .record-label {\n                display: flex;\n                height: 17px;\n                padding: 0 3px;\n                white-space: nowrap;\n                border-radius: 2px;\n                align-items: center;\n                justify-content: center;\n            }\n\n            .record-operator {\n                padding-left: 10px;\n                margin-right: auto;\n            }\n        }\n\n        .record-actions {\n            position: absolute;\n            top: -30px;\n            right: 0;\n            display: flex;\n            align-items: center;\n            height: 20px;\n\n            .record-filter {\n                .bk-radio-button-text {\n                    width: 50px;\n                    height: 22px;\n                    min-width: 50px;\n                    padding: 0;\n                    font-size: 12px;\n                    line-height: 22px;\n                    text-align: center;\n                }\n            }\n\n            .action-btn {\n                width: 50px;\n                height: 22px;\n                line-height: 22px;\n                color: #63656e;\n                text-align: center;\n                background: #fff;\n                border: 1px solid #c4c6cc;\n                border-radius: 2px;\n            }\n        }\n    }\n</style>\n","<template>\n    <div class=\"page-home\">\n        <div class=\"layout-row\">\n            <div class=\"layout-left\">\n                <div class=\"layout-row content-top\">\n                    <layout-card class=\"user-card\">\n                        <user />\n                    </layout-card>\n                    <layout-card class=\"agent-card\" :title=\"'Agent 状态分布'\">\n                        <agent />\n                    </layout-card>\n                </div>\n                <div class=\"layout-row\">\n                    <layout-card :title=\"'我收藏的作业'\" class=\"my-task\">\n                        <favor-task />\n                    </layout-card>\n                </div>\n            </div>\n            <div class=\"layout-right\">\n                <div class=\"layout-row content-top\">\n                    <layout-card class=\"work-statistics-card\">\n                        <work-statistics type=\"job-statistics\" link=\"taskList\">\n                            <template #default=\"{ jobNum }\">\n                                <span>{{ jobNum }}</span>\n                            </template>\n                            <span slot=\"name\">{{ '作业量' }}</span>\n                        </work-statistics>\n                    </layout-card>\n                    <layout-card class=\"work-statistics-card\">\n                        <work-statistics type=\"script-statistics\" link=\"scriptList\">\n                            <template #default=\"{ scriptNum }\">\n                                <span>{{ scriptNum }}</span>\n                            </template>\n                            <span slot=\"name\">{{ '脚本量' }}</span>\n                        </work-statistics>\n                    </layout-card>\n                </div>\n                <div class=\"layout-row\">\n                    <layout-card :title=\"'最近执行记录'\" class=\"record-card\">\n                        <history-record />\n                    </layout-card>\n                </div>\n            </div>\n        </div>\n        <div class=\"page-footer\">\n            <div v-html=\"footerLink\" />\n            <div v-html=\"footerCopyRight\" />\n        </div>\n    </div>\n</template>\n<script>\n    import marked from 'marked';\n    import QueryGlobalSettingService from '@service/query-global-setting';\n    import LayoutCard from './components/card';\n    import User from './components/user';\n    import Agent from './components/agent';\n    import WorkStatistics from './components/work-statistics';\n    import FavorTask from './components/favor-task';\n    import HistoryRecord from './components/history-record';\n\n    export default {\n        name: '',\n        components: {\n            LayoutCard,\n            User,\n            Agent,\n            WorkStatistics,\n            FavorTask,\n            HistoryRecord,\n        },\n        data () {\n            return {\n                footerLink: '',\n                footerCopyRight: '',\n            };\n        },\n        created () {\n            this.fetchTitleAndFooter();\n        },\n        methods: {\n            fetchTitleAndFooter () {\n                const formatLink = link => link.replace(/(?=( href))/g, ' target=\"_blank\"');\n                QueryGlobalSettingService.fetchFooterConfig()\n                    .then((data) => {\n                        this.footerLink = formatLink(marked(`${data.footerLink}`));\n                        this.footerCopyRight = marked(data.footerCopyRight);\n                    });\n            },\n        },\n    };\n</script>\n<style lang='postcss'>\n    .page-home {\n        display: flex;\n        flex-direction: column;\n\n        .layout-left {\n            display: flex;\n            flex-direction: column;\n            flex: 1;\n            margin-right: 20px;\n        }\n\n        .layout-right {\n            display: flex;\n            width: 28.6168%;\n            max-width: 480px;\n            min-width: 360px;\n            flex-direction: column;\n            flex: 1;\n        }\n\n        .layout-row {\n            display: flex;\n\n            &.content-top {\n                height: 196px;\n                margin-bottom: 20px;\n            }\n        }\n\n        .user-card {\n            flex: 1 0 480px;\n            min-width: 480px;\n            margin-right: 20px;\n        }\n\n        .agent-card {\n            flex: 1 1 378px;\n        }\n\n        .work-statistics-card {\n            width: calc(50% - 10px);\n            margin-right: 20px;\n\n            &:hover {\n                box-shadow: 0 2px 6px 0 rgb(0 0 0 / 10%);\n\n                .hexagon {\n                    animation: hexagon-scale 0.3s ease-in forwards;\n                }\n            }\n\n            &:last-child {\n                margin-right: 0;\n            }\n        }\n\n        .record-card {\n            flex: 1;\n        }\n\n        .my-task {\n            flex: 1;\n            width: 878px;\n        }\n\n        .page-footer {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            height: 52px;\n            margin-top: 20px;\n            font-size: 12px;\n            color: #63656e;\n            border-top: 1px solid #dcdee5;\n        }\n    }\n</style>\n"],"names":[],"sourceRoot":""}