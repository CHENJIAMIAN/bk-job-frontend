(self.webpackChunkjob=self.webpackChunkjob||[]).push([[6089],{85050:function(t,e,a){"use strict";var n=a(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,a(87033),a(35948),a(94522),a(7170),a(23232),a(80433);var s=n(a(15399)),i=n(a(67713)),r=n(a(39986)),l=n(a(52189)),o=n(a(81920)),u={name:"",components:{GlobalVariableLayout:l.default,GlobalVariable:o.default},data:()=>({taskName:"",taskVariables:[],isLoading:!0,isSubmiting:!1,templateId:0,taskId:0}),computed:{isSkeletonLoading(){return this.isLoading}},created(){this.taskInstanceId=this.$route.params.taskInstanceId,this.fetchData()},methods:{fetchData(){var t=this;i.default.fetchTaskInstance({id:this.taskInstanceId}).then((function(e){t.taskName=e.taskInstance.name,t.taskVariables=Object.freeze(e.variables.map((function(t){var e=t.id,a=t.name,n=t.type,s=t.value,i=t.targetValue,l=t.changeable;return{id:e,name:a,type:n,defaultValue:s,defaultTargetValue:new r.default(i||{}),changeable:l}})))})).finally((function(){t.isLoading=!1}))},handleGoExec(){var t=this;this.$refs.variable&&Promise.all(this.$refs.variable.map((function(t){return t.validate()}))).then((function(e){t.isSubmiting=!0,i.default.redoTask({taskInstanceId:t.taskInstanceId,taskVariables:e.map((function(t){return{id:t.id,name:t.name,type:t.type,value:t.value,targetValue:t.targetValue}}))}).then((function(e){var a=e.taskInstanceId;t.$bkMessage({theme:"success",message:s.default.t("history.操作成功")}),window.changeAlert=!1,t.$router.push({name:"historyTask",params:{id:a}})})).catch((function(){t.isSubmiting=!1}))}))},handleCancle(){this.routerBack()},routerBack(){this.$router.push({name:"historyList"})}}};e.Z=u},33401:function(){},24013:function(t,e,a){"use strict";a.r(e),a.d(e,{__esModule:function(){return s.X},default:function(){return l}});var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.isLoading},expression:"{ isLoading }"}],staticClass:"setting-variable"},[a("h2",{staticClass:"title"},[t._v(t._s(t.$t("history.全局变量")))]),t._v(" "),a("smart-action",{attrs:{"offset-target":"variable-value"},scopedSlots:t._u([{key:"action",fn:function(){return[a("bk-button",{staticClass:"w120 mr10",attrs:{theme:"primary",loading:t.isSubmiting},on:{click:t.handleGoExec}},[t._v("\n                "+t._s(t.$t("history.执行"))+"\n            ")]),t._v(" "),a("bk-button",{on:{click:t.handleCancle}},[t._v(t._s(t.$t("history.取消")))])]},proxy:!0}])},[a("global-variable-layout",t._l(t.taskVariables,(function(t){return a("global-variable",{key:t.id,ref:"variable",refInFor:!0,attrs:{type:t.type,data:t}})})),1)],1),t._v(" "),t.taskName?a("element-teleport",[a("div",{staticStyle:{"font-size":"12px",color:"#63656e"}},[t._v("（"+t._s(t.taskName)+"）")])]):t._e()],1)};n._withStripped=!0;var s=a(85050),i=s.Z,r=(a(78842),(0,a(35471).Z)(i,n,[],!1,null,null,null));r.options.__file="src/views/executive-history/redo-task/index.vue";var l=r.exports},78842:function(t,e,a){var n=a(33401);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[t.id,n,""]]),n.locals&&(t.exports=n.locals);(0,a(13570).Z)("7d9258cb",n,!1,{})}}]);