{"version":3,"file":"js/6089.3c72a424a71ca0893408.js","mappings":"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","sources":["webpack://job/src/views/executive-history/redo-task/index.vue","webpack://job/./src/views/executive-history/redo-task/index.vue?3857","webpack://job/./src/views/executive-history/redo-task/index.vue?78eb","webpack://job/./src/views/executive-history/redo-task/index.vue?f889","webpack://job/./src/views/executive-history/redo-task/index.vue?7d24"],"sourcesContent":["<template>\r\n    <div class=\"setting-variable\" v-bkloading=\"{ isLoading }\">\r\n        <h2 class=\"title\">{{ '全局变量' }}</h2>\r\n        <smart-action offset-target=\"variable-value\">\r\n            <global-variable-layout>\r\n                <global-variable\r\n                    v-for=\"variable in taskVariables\"\r\n                    ref=\"variable\"\r\n                    :type=\"variable.type\"\r\n                    :key=\"variable.id\"\r\n                    :data=\"variable\" />\r\n            </global-variable-layout>\r\n            <template #action>\r\n                <bk-button\r\n                    theme=\"primary\"\r\n                    class=\"w120 mr10\"\r\n                    :loading=\"isSubmiting\"\r\n                    @click=\"handleGoExec\">\r\n                    {{ '执行' }}\r\n                </bk-button>\r\n                <bk-button @click=\"handleCancle\">{{ '取消' }}</bk-button>\r\n            </template>\r\n        </smart-action>\r\n        <element-teleport v-if=\"taskName\">\r\n            <div style=\"font-size: 12px; color: #63656e;\">（{{ taskName }}）</div>\r\n        </element-teleport>\r\n    </div>\r\n</template>\r\n<script>\r\n       import TaskExecuteService from '@service/task-execute';\r\n    import TaskHostNodeModel from '@model/task-host-node';\r\n    import GlobalVariableLayout from '@components/global-variable/layout';\r\n    import GlobalVariable from '@components/global-variable/edit';\r\n\r\n    export default {\r\n        name: '',\r\n        components: {\r\n            GlobalVariableLayout,\r\n            GlobalVariable,\r\n        },\r\n        data () {\r\n            return {\r\n                taskName: '123',\r\n                taskVariables: [],\r\n                isLoading: true,\r\n                isSubmiting: false,\r\n                templateId: 0,\r\n                taskId: 0,\r\n            };\r\n        },\r\n        computed: {\r\n            isSkeletonLoading () {\r\n                return this.isLoading;\r\n            },\r\n        },\r\n        created () {\r\n            this.taskInstanceId = this.$route.params.taskInstanceId;\r\n            this.fetchData();\r\n        },\r\n        methods: {\r\n            /**\r\n             * @desc 获取任务详情数据\r\n             */\r\n            fetchData () {\r\n                TaskExecuteService.fetchTaskInstance({\r\n                    id: this.taskInstanceId,\r\n                }).then((data) => {\r\n                    this.taskName = data.taskInstance.name;\r\n                    this.taskVariables = Object.freeze(data.variables.map(({\r\n                        id,\r\n                        name,\r\n                        type,\r\n                        value,\r\n                        targetValue,\r\n                        changeable,\r\n                    }) => ({\r\n                        id,\r\n                        name,\r\n                        type,\r\n                        defaultValue: value,\r\n                        defaultTargetValue: new TaskHostNodeModel(targetValue || {}),\r\n                        changeable,\r\n                    })));\r\n                })\r\n                    .finally(() => {\r\n                        this.isLoading = false;\r\n                    });\r\n            },\r\n            /**\r\n             * @desc 任务重做执行\r\n             */\r\n            handleGoExec () {\r\n                if (!this.$refs.variable) {\r\n                    return;\r\n                }\r\n                Promise.all(this.$refs.variable.map(item => item.validate()))\r\n                    .then((taskVariables) => {\r\n                        this.isSubmiting = true;\r\n                        TaskExecuteService.redoTask({\r\n                            taskInstanceId: this.taskInstanceId,\r\n                            taskVariables: taskVariables.map(({ id, name, type, value, targetValue }) => ({\r\n                                id,\r\n                                name,\r\n                                type,\r\n                                value,\r\n                                targetValue,\r\n                            })),\r\n                        }).then(({ taskInstanceId }) => {\r\n                            this.$bkMessage({\r\n                                theme: 'success',\r\n                                message: '操作成功',\r\n                            });\r\n                            window.changeAlert = false;\r\n                            this.$router.push({\r\n                                name: 'historyTask',\r\n                                params: {\r\n                                    id: taskInstanceId,\r\n                                },\r\n                            });\r\n                        })\r\n                            .catch(() => {\r\n                                this.isSubmiting = false;\r\n                            });\r\n                    });\r\n            },\r\n            /**\r\n             * @desc 取消重做\r\n             */\r\n            handleCancle () {\r\n                this.routerBack();\r\n            },\r\n            /**\r\n             * @desc 路由回退\r\n             */\r\n            routerBack () {\r\n                this.$router.push({\r\n                    name: 'historyList',\r\n                });\r\n            },\r\n        },\r\n    };\r\n</script>\r\n<style lang='postcss'>\r\n    .setting-variable {\r\n        .title {\r\n            margin-bottom: 20px;\r\n            font-size: 14px;\r\n            line-height: 1;\r\n            color: #313238;\r\n        }\r\n\r\n        .variable-list {\r\n            display: inline-block;\r\n        }\r\n    }\r\n\r\n    .setting-wariable-operate {\r\n        margin-left: 88px;\r\n    }\r\n</style>\r\n","var render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    {\n      directives: [\n        {\n          name: \"bkloading\",\n          rawName: \"v-bkloading\",\n          value: { isLoading: _vm.isLoading },\n          expression: \"{ isLoading }\",\n        },\n      ],\n      staticClass: \"setting-variable\",\n    },\n    [\n      _c(\"h2\", { staticClass: \"title\" }, [_vm._v(_vm._s(\"全局变量\"))]),\n      _vm._v(\" \"),\n      _c(\n        \"smart-action\",\n        {\n          attrs: { \"offset-target\": \"variable-value\" },\n          scopedSlots: _vm._u([\n            {\n              key: \"action\",\n              fn: function () {\n                return [\n                  _c(\n                    \"bk-button\",\n                    {\n                      staticClass: \"w120 mr10\",\n                      attrs: { theme: \"primary\", loading: _vm.isSubmiting },\n                      on: { click: _vm.handleGoExec },\n                    },\n                    [\n                      _vm._v(\n                        \"\\n                \" + _vm._s(\"执行\") + \"\\n            \"\n                      ),\n                    ]\n                  ),\n                  _vm._v(\" \"),\n                  _c(\"bk-button\", { on: { click: _vm.handleCancle } }, [\n                    _vm._v(_vm._s(\"取消\")),\n                  ]),\n                ]\n              },\n              proxy: true,\n            },\n          ]),\n        },\n        [\n          _c(\n            \"global-variable-layout\",\n            _vm._l(_vm.taskVariables, function (variable) {\n              return _c(\"global-variable\", {\n                key: variable.id,\n                ref: \"variable\",\n                refInFor: true,\n                attrs: { type: variable.type, data: variable },\n              })\n            }),\n            1\n          ),\n        ],\n        1\n      ),\n      _vm._v(\" \"),\n      _vm.taskName\n        ? _c(\"element-teleport\", [\n            _c(\n              \"div\",\n              { staticStyle: { \"font-size\": \"12px\", color: \"#63656e\" } },\n              [_vm._v(\"（\" + _vm._s(_vm.taskName) + \"）\")]\n            ),\n          ])\n        : _vm._e(),\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/_babel-loader@8.2.5@babel-loader/lib/index.js??clonedRuleSet-1[0].rules[0].use[0]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/_babel-loader@8.2.5@babel-loader/lib/index.js??clonedRuleSet-1[0].rules[0].use[0]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=34a99326&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=postcss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"D:\\\\Desktop\\\\bk-job-frontend\\\\node_modules\\\\_vue-hot-reload-api@2.3.4@vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('34a99326')) {\n      api.createRecord('34a99326', component.options)\n    } else {\n      api.reload('34a99326', component.options)\n    }\n    module.hot.accept(\"./index.vue?vue&type=template&id=34a99326&\", function () {\n      api.rerender('34a99326', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/views/executive-history/redo-task/index.vue\"\nexport default component.exports","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/_mini-css-extract-plugin@2.6.0@mini-css-extract-plugin/dist/loader.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../node_modules/_css-loader@6.7.1@css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/_postcss-loader@6.2.1@postcss-loader/dist/cjs.js!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=postcss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/_vue-style-loader@4.1.3@vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"7d9258cb\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/_mini-css-extract-plugin@2.6.0@mini-css-extract-plugin/dist/loader.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../node_modules/_css-loader@6.7.1@css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/_postcss-loader@6.2.1@postcss-loader/dist/cjs.js!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=postcss&\", function() {\n     var newContent = require(\"!!../../../../node_modules/_mini-css-extract-plugin@2.6.0@mini-css-extract-plugin/dist/loader.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../node_modules/_css-loader@6.7.1@css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/_postcss-loader@6.2.1@postcss-loader/dist/cjs.js!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=postcss&\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}"],"names":["name","components","GlobalVariableLayout","GlobalVariable","data","taskName","taskVariables","isLoading","isSubmiting","templateId","taskId","computed","methods","TaskExecuteService","id","then","type","value","targetValue","changeable","defaultValue","defaultTargetValue","finally","Promise","taskInstanceId","theme","message","window","params","catch","render","_vm","this","_h","$createElement","_c","_self","directives","rawName","expression","staticClass","_v","_s","attrs","scopedSlots","_u","key","fn","loading","on","click","handleGoExec","handleCancle","proxy","_l","variable","ref","refInFor","staticStyle","color","_e","_withStripped","component","options","__file","content","__esModule","default","module","locals","exports","add"],"sourceRoot":""}