{"version":3,"file":"js/3301.1bd3d2054b1ad9580094.js","mappings":"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","sources":["webpack://job/src/views/task-manage/template-operation/components/toggle-display.vue","webpack://job/src/views/task-manage/template-operation/index.vue","webpack://job/./src/views/task-manage/template-operation/components/toggle-display.vue?6d82","webpack://job/./src/views/task-manage/template-operation/components/toggle-display.vue?4ee6","webpack://job/./src/views/task-manage/template-operation/components/toggle-display.vue?93c7","webpack://job/./src/views/task-manage/template-operation/index.vue?83db","webpack://job/./src/views/task-manage/template-operation/index.vue?f6eb","webpack://job/./src/views/task-manage/template-operation/index.vue?2829","webpack://job/./src/views/task-manage/template-operation/components/toggle-display.vue?9c15","webpack://job/./src/views/task-manage/template-operation/index.vue?ecf8"],"sourcesContent":["\r\n\r\n<template>\r\n    <div class=\"toggle-display\">\r\n        <div v-show=\"isOpen\">\r\n            <slot />\r\n        </div>\r\n        <bk-form-item label=\" \" style=\"margin-top: -10px;\">\r\n            <div class=\"action\" @click=\"handleToggle\">\r\n                <template v-if=\"isOpen\">\r\n                    <Icon type=\"angle-double-up\" class=\"toggle-arrow\" />\r\n                    <span>{{ '收起更多设置' }}</span>\r\n                </template>\r\n                <template v-else>\r\n                    <Icon type=\"angle-double-down\" class=\"toggle-arrow\" />\r\n                    <span>{{ '展开更多设置' }}</span>\r\n                </template>\r\n            </div>\r\n        </bk-form-item>\r\n    </div>\r\n</template>\r\n<script>\r\n    export default {\r\n        name: 'ToggleDisplay',\r\n        data () {\r\n            return {\r\n                isOpen: false,\r\n            };\r\n        },\r\n        methods: {\r\n            handleToggle () {\r\n                this.isOpen = !this.isOpen;\r\n            },\r\n        },\r\n    };\r\n</script>\r\n<style lang='postcss' scoped>\r\n    .toggle-display {\r\n        .action {\r\n            display: flex;\r\n            align-items: center;\r\n            font-size: 14px;\r\n            color: #3a84ff;\r\n            cursor: pointer;\r\n        }\r\n\r\n        .toggle-arrow {\r\n            margin-right: 3px;\r\n            font-size: 12px;\r\n        }\r\n    }\r\n</style>\r\n","\r\n\r\n<template>\r\n    <div\r\n        id=\"templateOperation\"\r\n        class=\"template-operation\">\r\n        <div class=\"layout-left\">\r\n            <scroll-faker ref=\"contentScroll\">\r\n                <div class=\"template-container\">\r\n                    <smart-action offset-target=\"bk-form-content\">\r\n                        <jb-form\r\n                            :model=\"formData\"\r\n                            :rules=\"rules\"\r\n                            ref=\"templateOperateRef\"\r\n                            v-test=\"{ type: 'form', value: 'template' }\">\r\n                            <bk-alert class=\"info\" :title=\"'「对作业模板的修改不会立即自动更新执行方案，需要由用户手动触发」'\" />\r\n                            <jb-form-item\r\n                                :label=\"'模板名称'\"\r\n                                required property=\"name\">\r\n                                <jb-input\r\n                                    class=\"input form-item-content\"\r\n                                    :placeholder=\"'输入作业模板名称'\"\r\n                                    v-model=\"formData.name\"\r\n                                    :maxlength=\"60\" />\r\n                            </jb-form-item>\r\n                            <toggle-display style=\"margin-bottom: 20px;\">\r\n                                <jb-form-item\r\n                                    :label=\"'场景标签'\"\r\n                                    property=\"tags\">\r\n                                    <jb-tag-select\r\n                                        class=\"input form-item-content\"\r\n                                        :placeholder=\"'标签对资源的分类管理有很大帮助'\"\r\n                                        v-model=\"formData.tags\" />\r\n                                </jb-form-item>\r\n                                <jb-form-item :label=\"'模板描述'\">\r\n                                    <bk-input\r\n                                        v-model=\"formData.description\"\r\n                                        class=\"template-desc-textarea form-item-content\"\r\n                                        type=\"textarea\"\r\n                                        :maxlength=\"500\"\r\n                                        :placeholder=\"'填写该模板的功能介绍等详细描述...'\" />\r\n                                </jb-form-item>\r\n                            </toggle-display>\r\n                            <jb-form-item\r\n                                :label=\"'全局变量'\"\r\n                                style=\"margin-bottom: 30px;\">\r\n                                <render-global-var\r\n                                    :list=\"formData.variables\"\r\n                                    mode=\"operate\"\r\n                                    @on-change=\"handleGlobalVariableChange\" />\r\n                            </jb-form-item>\r\n                            <jb-form-item\r\n                                :label=\"'作业步骤'\"\r\n                                required\r\n                                property=\"steps\"\r\n                                style=\"margin-bottom: 30px;\">\r\n                                <render-task-step\r\n                                    ref=\"step\"\r\n                                    :list=\"formData.steps\"\r\n                                    :variable=\"formData.variables\"\r\n                                    mode=\"operation\"\r\n                                    @on-change=\"handleTaskStepChange\" />\r\n                            </jb-form-item>\r\n                        </jb-form>\r\n                        <template #action>\r\n                            <bk-button\r\n                                class=\"w120 mr10\"\r\n                                theme=\"primary\"\r\n                                :loading=\"isSubmiting\"\r\n                                @click=\"handlerSubmit\"\r\n                                v-test=\"{ type: 'button', value: 'operationTemplateSubmit' }\">\r\n                                {{ submitText }}\r\n                            </bk-button>\r\n                            <bk-button\r\n                                @click=\"handleCancel\"\r\n                                v-test=\"{ type: 'button', value: 'operationTemplateCancel' }\">\r\n                                {{ '取消' }}\r\n                            </bk-button>\r\n                        </template>\r\n                    </smart-action>\r\n                </div>\r\n            </scroll-faker>\r\n            <back-top :target=\"getScrollParent\" />\r\n        </div>\r\n        <div id=\"templateOperationLayoutRight\" class=\"layout-right\" />\r\n    </div>\r\n</template>\r\n<script>\r\n    import _ from 'lodash';\r\n       import TaskManageService from '@service/task-manage';\r\n    import TaskPlanService from '@service/task-plan';\r\n    import { taskTemplateName } from '@utils/validator';\r\n    import JbTagSelect from '@components/jb-tag-select';\r\n    import JbInput from '@components/jb-input';\r\n    import BackTop from '@components/back-top';\r\n    import RenderGlobalVar from '../common/render-global-var';\r\n    import RenderTaskStep from '../common/render-task-step';\r\n    import ToggleDisplay from './components/toggle-display';\r\n\r\n    export default {\r\n        name: '',\r\n        components: {\r\n            JbTagSelect,\r\n            JbInput,\r\n            BackTop,\r\n            ToggleDisplay,\r\n            RenderGlobalVar,\r\n            RenderTaskStep,\r\n        },\r\n        data () {\r\n            return {\r\n                isLoading: true,\r\n                isPlanListLoading: true,\r\n                formData: {\r\n                    name: '',\r\n                    tags: [],\r\n                    variables: [],\r\n                    steps: [],\r\n                    description: '',\r\n                },\r\n                planList: [{},{},{}],\r\n                isSubmiting: false,\r\n                execLoading: false,\r\n            };\r\n        },\r\n        computed: {\r\n            isSkeletonLoading () {\r\n                return this.isLoading;\r\n            },\r\n        },\r\n        watch: {\r\n            formData: {\r\n                handler  () {\r\n                    if (this.isLoading) {\r\n                        return;\r\n                    }\r\n                    this.hasChange = true;\r\n                },\r\n                deep: true,\r\n            },\r\n        },\r\n        created () {\r\n            this.taskId = this.$route.params.id || 0;\r\n            this.isEdit = this.$route.name === 'templateEdit';\r\n            this.isClone = this.$route.name === 'templateClone';\r\n            // 是否默认显示步骤编辑框\r\n            this.initShowStepId = Number(this.$route.params.stepId);\r\n\r\n            // 编辑和克隆作业模板时需要获取模板数据\r\n            if (this.$route.name !== 'templateCreate') {\r\n                this.fetchData(true);\r\n            }\r\n            // 编辑作业模板需要获取模板对应的执行方案列表\r\n            if (this.isEdit) {\r\n                this.fetchPlanList();\r\n            }\r\n            this.submitText = this.isEdit ? '保存' : '提交';\r\n            this.rules = {\r\n                name: [\r\n                    {\r\n                        required: true,\r\n                        message: '模板名称必填',\r\n                        trigger: 'blur',\r\n                    },\r\n                    {\r\n                        validator: taskTemplateName.validator,\r\n                        message: taskTemplateName.message,\r\n                        trigger: 'blur',\r\n                    },\r\n                    {\r\n                        validator: this.checkName,\r\n                        message: '模板名已存在，请重新输入',\r\n                        trigger: 'blur',\r\n                    },\r\n                ],\r\n                steps: [\r\n                    {\r\n                        validator: value => value.length && value.some(item => !item.delete),\r\n                        message: '作业步骤必填',\r\n                        trigger: 'blur',\r\n                    },\r\n                ],\r\n            };\r\n        },\r\n        methods: {\r\n            /**\r\n             * @desc 获取模板详情\r\n             * @param {Boolean} isFirst 是否是第一次执行\r\n             */\r\n            fetchData (isFirst = false) {\r\n                this.isLoading = true;\r\n                const requestHandler = this.isEdit ? TaskManageService.taskDetail : TaskManageService.taskClone;\r\n                requestHandler({\r\n                    id: this.taskId,\r\n                }, {\r\n                    permission: 'page',\r\n                }).then((data) => {\r\n                    const { name, description, tags, variables, stepList } = data;\r\n                    this.formData = {\r\n                        name,\r\n                        description,\r\n                        tags,\r\n                        variables,\r\n                        steps: stepList,\r\n                    };\r\n                    // 克隆模板提示密文变量\r\n                    if (this.isClone) {\r\n                        this.searchCiphertextVariable();\r\n                    }\r\n                    // 编辑执行步骤\r\n                    if (isFirst && this.isEdit && this.initShowStepId > 0) {\r\n                        setTimeout(() => {\r\n                            this.$refs.step.clickStepByIndex(_.findIndex(stepList, ({ id }) => id === this.initShowStepId));\r\n                        });\r\n                    }\r\n                    // 再次编辑\r\n                    // 拉取模板最新数据\r\n                    if (!isFirst) {\r\n                        setTimeout(() => {\r\n                            window.changeAlert = false;\r\n                        }, 100);\r\n                    }\r\n                })\r\n                    .catch((error) => {\r\n                        if ([\r\n                            1,\r\n                            400,\r\n                        ].includes(error.code)) {\r\n                            setTimeout(() => {\r\n                                this.$router.push({\r\n                                    name: 'taskList',\r\n                                });\r\n                            }, 3000);\r\n                        }\r\n                    })\r\n                    .finally(() => {\r\n                        this.isLoading = false;\r\n                    });\r\n            },\r\n            /**\r\n             * @desc 获取模板关联的执行方案\r\n             */\r\n            fetchPlanList () {\r\n                this.isPlanListLoading = true;\r\n                TaskPlanService.fetchTaskPlan({\r\n                    id: this.taskId,\r\n                }).then((data) => {\r\n                    this.planList = Object.freeze(data);\r\n                })\r\n                    .finally(() => {\r\n                        this.isPlanListLoading = false;\r\n                    });\r\n            },\r\n            /**\r\n             * @desc 验证作业模板的名\r\n             * @param {String} name 作业模板名\r\n             *\r\n             */\r\n            checkName (name) {\r\n                return TaskManageService.taskCheckName({\r\n                    id: this.isEdit ? this.taskId : 0,\r\n                    name,\r\n                });\r\n            },\r\n            getScrollParent () {\r\n                return this.$refs.contentScroll.$el.querySelector('.scroll-faker-content');\r\n            },\r\n            /**\r\n             * @desc 克隆作业模板时提示密文变量\r\n             */\r\n            searchCiphertextVariable () {\r\n                const stack = [];\r\n                \r\n                this.formData.variables.forEach((current) => {\r\n                    if (current.isPassword) {\r\n                        stack.push(current.name);\r\n                    }\r\n                });\r\n                if (stack.length < 1) {\r\n                    return;\r\n                }\r\n                this.$bkInfo({\r\n                    title: '模板中包含密文变量，请重新设置值',\r\n                    subTitle: '“密文”类型的变量经过特殊加密处理，为避免信息泄露，克隆后初始值不会还原，需用户重新设置。',\r\n                    okText: '我知道了',\r\n                    extCls: 'password-variable-info',\r\n                });\r\n            },\r\n            \r\n            /**\r\n             * @desc 删除全局变量-删除步骤中的变量引用\r\n             * @param {Array} stepList 步骤列表\r\n             * @param {Object} deleteMap 删除的变量名\r\n             * @returns {Array}\r\n             *\r\n             * 忽略已经删除的步骤\r\n             */\r\n            syncStepVarialbeDelete (stepList, deleteMap) {\r\n                let changeFlag = false;\r\n                // 所有主机全局变量\r\n                stepList.forEach((currentStep) => {\r\n                    // 步骤已经删除\r\n                    if (currentStep.delete) {\r\n                        return;\r\n                    }\r\n                    if (currentStep.isFile) {\r\n                        // 分发文件步骤\r\n                        const { fileDestination, fileSourceList } = currentStep.fileStepInfo;\r\n                        // 执行目标使用变量\r\n                        const { server } = fileDestination;\r\n                        if (deleteMap[server.variable]) {\r\n                            server.variable = '';\r\n                            currentStep.localValidator = false;\r\n                            changeFlag = true;\r\n                        }\r\n                        // 源文件使用变量\r\n                        fileSourceList.forEach((currentFile) => {\r\n                            if (currentFile.fileType === 1) {\r\n                                if (deleteMap[currentFile.host.variable]) {\r\n                                    currentFile.host.variable = '';\r\n                                    // 步骤使用的全局变量被删除，步骤需要被标记为待补全状态\r\n                                    currentStep.localValidator = false;\r\n                                    changeFlag = true;\r\n                                }\r\n                            }\r\n                        });\r\n                        return;\r\n                    }\r\n                    if (currentStep.isScript) {\r\n                        // 脚本步骤\r\n                        const { executeTarget } = currentStep.scriptStepInfo;\r\n                        if (deleteMap[executeTarget.variable]) {\r\n                            executeTarget.variable = '';\r\n                            // 步骤使用的全局变量被删除，步骤需要被标记为待补全状态\r\n                            currentStep.localValidator = false;\r\n                            changeFlag = true;\r\n                        }\r\n                    }\r\n                });\r\n                return changeFlag ? [...stepList] : stepList;\r\n            },\r\n            /**\r\n             * @desc 修改全局变量名-同步步骤中引用的变量\r\n             * @param {Array} stepList 步骤列表\r\n             * @param {Object} renameMap 全局变量对应的最新名字\r\n             * @returns {Array}\r\n             *\r\n             * 忽略已经删除的步骤\r\n             */\r\n            syncStepVariableRename (stepList, renameMap) {\r\n                stepList.forEach((currentStep) => {\r\n                    // 步骤已经删除\r\n                    if (currentStep.delete) {\r\n                        return;\r\n                    }\r\n                    // 分发文件步骤\r\n                    if (currentStep.isFile) {\r\n                        // 执行目标使用全局变量\r\n                        const { fileDestination, fileSourceList } = currentStep.fileStepInfo;\r\n                        const { server } = fileDestination;\r\n                        if (renameMap[server.variable]) {\r\n                            server.variable = renameMap[server.variable];\r\n                        }\r\n                        // 源文件使用全局变量\r\n                        fileSourceList.forEach((currentFile) => {\r\n                            if (currentFile.fileType === 1) {\r\n                                // 服务器文件\r\n                                if (renameMap[currentFile.host.variable]) {\r\n                                    currentFile.host.variable = renameMap[currentFile.host.variable];\r\n                                }\r\n                            }\r\n                        });\r\n                        return;\r\n                    }\r\n                    // 脚本步骤\r\n                    if (currentStep.isScript) {\r\n                        // 执行目标使用全局变量\r\n                        const { executeTarget } = currentStep.scriptStepInfo;\r\n                        if (renameMap[executeTarget.variable]) {\r\n                            executeTarget.variable = renameMap[executeTarget.variable];\r\n                        }\r\n                    }\r\n                });\r\n                return [...stepList];\r\n            },\r\n            /**\r\n             * @desc 全局变量更新\r\n             * @param {Array} variableList 最新的变量列表\r\n             *\r\n             * 更新主机变量名\r\n             *  -自动替换步骤中已经引用的全局变量\r\n             * 删除主机变量\r\n             *  -将使用了该全局变量的步骤标记为待补全\r\n             */\r\n            handleGlobalVariableChange (variableList) {\r\n                const newVariableMap = variableList.reduce((result, variable) => {\r\n                    result[variable.id] = {\r\n                        name: variable.name,\r\n                        delete: variable.delete,\r\n                    };\r\n                    return result;\r\n                }, {});\r\n                // 主机变量修改变量名自动同步步骤里面的变量引用\r\n                const renameMap = {};\r\n                // 主机变量被删除同步删除步骤里面的引用记录\r\n                const deleteMap = {};\r\n                this.formData.variables.forEach((variable) => {\r\n                    if (!variable.isHost) {\r\n                        return;\r\n                    }\r\n                    const {\r\n                        id,\r\n                        name,\r\n                    } = variable;\r\n                    // 全局变量被删除\r\n                    if (!newVariableMap[id] || newVariableMap[id].delete) {\r\n                        deleteMap[name] = true;\r\n                        return;\r\n                    }\r\n                    // 修改了变量\r\n                    if (newVariableMap[id].name !== name) {\r\n                        renameMap[name] = newVariableMap[id].name;\r\n                    }\r\n                });\r\n                // 优先同步删除操作\r\n                let stepList = this.syncStepVarialbeDelete(this.formData.steps, deleteMap);\r\n                // 同步改名操作\r\n                stepList = this.syncStepVariableRename(stepList, renameMap);\r\n                this.formData.variables = variableList;\r\n                this.formData.steps = stepList;\r\n            },\r\n            /**\r\n             * @desc 步骤更新\r\n             * @param {Array} steps 最新的步骤列表\r\n             */\r\n            handleTaskStepChange (steps) {\r\n                this.formData.steps = steps;\r\n                this.$refs.templateOperateRef.clearError();\r\n            },\r\n            /**\r\n             * @desc 保存作业模板\r\n             *\r\n             * 需要对作模板数据做逻辑验证处理\r\n             * - 步骤的基本数据是否完整\r\n             */\r\n            handlerSubmit () {\r\n                // eslint-disable-next-line no-plusplus\r\n                for (let i = 0; i < this.formData.steps.length; i++) {\r\n                    if (this.formData.steps[i].delete !== 1\r\n                        && this.formData.steps[i].localValidator === false) {\r\n                        this.messageError('请将「待补全」的步骤信息完善后提交重试');\r\n                        return;\r\n                    }\r\n                }\r\n\r\n                // 提交作业模板\r\n                // 再主动拉取作业模板对应的执行方案列表，判断执行方案是否为空和是否需要同步\r\n                this.isSubmiting = true;\r\n                this.$refs.templateOperateRef.validate()\r\n                    .then(() => TaskManageService.taskUpdate({\r\n                        ...this.formData,\r\n                        id: this.isEdit ? this.taskId : 0,\r\n                    }).then((taskId) => {\r\n                        window.changeAlert = false;\r\n                        return TaskPlanService.fetchTaskPlan({\r\n                            id: taskId,\r\n                        }).then((planList) => {\r\n                            let planSync = false;\r\n                            // eslint-disable-next-line no-plusplus\r\n                            for (let i = 0; i < planList.length; i++) {\r\n                                if (planList[i].needUpdate) {\r\n                                    planSync = true;\r\n                                    break;\r\n                                }\r\n                            }\r\n                            this.planList = Object.freeze(planList);\r\n                            if (this.isEdit) {\r\n                                this.editSuccessCallback(taskId, planSync);\r\n                            } else {\r\n                                this.createSuccessCallback(taskId);\r\n                            }\r\n                        });\r\n                    }))\r\n                    .finally(() => {\r\n                        this.isSubmiting = false;\r\n                    });\r\n            },\r\n            /**\r\n             * @desc 创建作业模板成功\r\n             * @param {Number} taskId 作业模板id\r\n             */\r\n            createSuccessCallback (taskId) {\r\n                let confirmInfo = '';\r\n                let isClickClose = false;\r\n                const handleGoTemplateEdit = () => {\r\n                    this.$router.push({\r\n                        name: 'templateEdit',\r\n                        params: {\r\n                            id: taskId,\r\n                        },\r\n                    });\r\n                    isClickClose = true;\r\n                    confirmInfo.close();\r\n                };\r\n                const handleGoTemplateDetail = () => {\r\n                    this.$router.push({\r\n                        name: 'templateDetail',\r\n                        params: {\r\n                            id: taskId,\r\n                        },\r\n                    });\r\n                    isClickClose = true;\r\n                    confirmInfo.close();\r\n                };\r\n                const handleGoPlan = () => {\r\n                    this.$router.push({\r\n                        name: 'viewPlan',\r\n                        params: {\r\n                            templateId: taskId,\r\n                        },\r\n                        query: {\r\n                            mode: 'create',\r\n                        },\r\n                    });\r\n                    isClickClose = true;\r\n                    confirmInfo.close();\r\n                };\r\n                \r\n                const subHeader = () => (\r\n                <div>\r\n                    <p style={{ marginBottom: '10px', color: '#979BA5' }}>\r\n                        {'还差一步「 设置执行方案」，即可执行作业'}\r\n                    </p>\r\n                    <p>\r\n                        <bk-button\r\n                            style={{ marginRight: '10px' }}\r\n                            text\r\n                            onClick={handleGoTemplateEdit}>\r\n                            {'继续编辑'}\r\n                        </bk-button>\r\n                        <bk-button\r\n                            style={{ marginRight: '10px' }}\r\n                            text\r\n                            onClick={handleGoTemplateDetail}>\r\n                            {'立即查看'}\r\n                        </bk-button>\r\n                        <bk-button\r\n                            text\r\n                            onClick={handleGoPlan}>\r\n                            {'设置方案'}\r\n                        </bk-button>\r\n                    </p>\r\n                </div>\r\n                );\r\n\r\n                confirmInfo = this.$bkInfo({\r\n                    type: 'success',\r\n                    title: '作业创建成功',\r\n                    showFooter: false,\r\n                    subHeader: subHeader(),\r\n                    cancelFn: () => {\r\n                        if (isClickClose) {\r\n                            return;\r\n                        }\r\n                        this.$router.push({\r\n                            name: 'templateEdit',\r\n                            params: {\r\n                                id: taskId,\r\n                            },\r\n                        });\r\n                    },\r\n                });\r\n            },\r\n            /**\r\n             * @desc 编辑作业模板成功\r\n             * @param {Number} taskId 作业模板id\r\n             * @param {Boolean} planSync 执行方案是否需要同步\r\n             */\r\n            editSuccessCallback (taskId, planSync) {\r\n                let confirmInfo = '';\r\n                let isClickClose = false;\r\n                const handleGoTemplateDetail = () => {\r\n                    this.$router.push({\r\n                        name: 'templateDetail',\r\n                        params: {\r\n                            id: taskId,\r\n                        },\r\n                    });\r\n                    isClickClose = true;\r\n                    confirmInfo.close();\r\n                };\r\n                const handleGoSync = () => {\r\n                    this.$router.push({\r\n                        name: 'syncPlanBatch',\r\n                        query: {\r\n                            planIds: this.planList.map(_ => _.id).join(','),\r\n                            from: 'templateEdit',\r\n                        },\r\n                    });\r\n                    isClickClose = true;\r\n                    confirmInfo.close();\r\n                };\r\n                const handleGoPlan = () => {\r\n                    this.$router.push({\r\n                        name: 'viewPlan',\r\n                        params: {\r\n                            templateId: taskId,\r\n                        },\r\n                        query: {\r\n                            from: 'templateDetail',\r\n                        },\r\n                    });\r\n                    isClickClose = true;\r\n                    confirmInfo.close();\r\n                };\r\n                const subHeader = () => (\r\n                <div>\r\n                    <p style={{ marginBottom: '10px', color: '#979BA5' }}>\r\n                        {'可以通过 “立即同步” 入口前往更新所有执行方案'}\r\n                    </p>\r\n                    <p>\r\n                        <bk-button\r\n                            class=\"mr10\"\r\n                            text\r\n                            onClick={handleGoTemplateDetail}>\r\n                            {'返回查看'}\r\n                        </bk-button>\r\n                        <bk-button\r\n                            class=\"mr10\"\r\n                            text\r\n                            disabled={!planSync}\r\n                            onClick={handleGoSync}>\r\n                            {'立即同步'}\r\n                        </bk-button>\r\n                        <bk-button\r\n                            text\r\n                            onClick={handleGoPlan}>\r\n                            {'查看方案'}\r\n                        </bk-button>\r\n                    </p>\r\n                </div>\r\n                );\r\n\r\n                confirmInfo = this.$bkInfo({\r\n                    type: 'success',\r\n                    title: '编辑保存成功',\r\n                    showFooter: false,\r\n                    subHeader: subHeader(),\r\n                    cancelFn: () => {\r\n                        if (isClickClose) {\r\n                            return;\r\n                        }\r\n                        this.fetchData(false);\r\n                    },\r\n                });\r\n            },\r\n            /**\r\n             * @desc 取消\r\n             */\r\n            handleCancel () {\r\n                this.routerBack();\r\n            },\r\n            /**\r\n             * @desc 路由回退\r\n             */\r\n            routerBack () {\r\n                const { from } = this.$route.query;\r\n                if (from === 'templateDetail') {\r\n                    this.$router.push({\r\n                        name: 'templateDetail',\r\n                        params: {\r\n                            id: this.taskId,\r\n                        },\r\n                    });\r\n                    return;\r\n                }\r\n                this.$router.push({\r\n                    name: 'taskList',\r\n                });\r\n            },\r\n        },\r\n    };\r\n</script>\r\n<style lang='postcss'>\r\n    @import \"@/css/mixins/media\";\r\n\r\n    .template-operation {\r\n        display: flex;\r\n\r\n        .layout-left {\r\n            height: calc(100vh - 124px);\r\n            margin-right: auto;\r\n            flex: 0 1 auto;\r\n            transform: translate(0, 0);\r\n\r\n            .template-container {\r\n                padding-right: 100px;\r\n            }\r\n        }\r\n\r\n        .layout-right {\r\n            height: calc(100vh - 104px);\r\n            margin-top: -20px;\r\n            margin-right: -24px;\r\n            flex: 0 0 auto;\r\n        }\r\n\r\n        .info {\r\n            margin-bottom: 20px;\r\n        }\r\n\r\n        .template-desc-textarea {\r\n            .bk-textarea-wrapper .bk-form-textarea.textarea-maxlength {\r\n                margin-bottom: 0;\r\n            }\r\n\r\n            .bk-form-textarea {\r\n                min-height: 86px;\r\n            }\r\n        }\r\n\r\n        .form-item-content {\r\n            @media (--small-viewports) {\r\n                width: 500px;\r\n            }\r\n\r\n            @media (--medium-viewports) {\r\n                width: 560px;\r\n            }\r\n\r\n            @media (--large-viewports) {\r\n                width: 620px;\r\n            }\r\n\r\n            @media (--huge-viewports) {\r\n                width: 680px;\r\n            }\r\n        }\r\n    }\r\n\r\n    .invalid-variable-info,\r\n    .password-variable-info {\r\n        .bk-dialog-content {\r\n            width: 500px !important;\r\n        }\r\n    }\r\n\r\n    .password-variable-info {\r\n        .bk-dialog-header-inner {\r\n            white-space: normal !important;\r\n        }\r\n\r\n        .bk-default {\r\n            display: none;\r\n        }\r\n    }\r\n</style>\r\n","var render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"toggle-display\" },\n    [\n      _c(\n        \"div\",\n        {\n          directives: [\n            {\n              name: \"show\",\n              rawName: \"v-show\",\n              value: _vm.isOpen,\n              expression: \"isOpen\",\n            },\n          ],\n        },\n        [_vm._t(\"default\")],\n        2\n      ),\n      _vm._v(\" \"),\n      _c(\n        \"bk-form-item\",\n        { staticStyle: { \"margin-top\": \"-10px\" }, attrs: { label: \" \" } },\n        [\n          _c(\n            \"div\",\n            { staticClass: \"action\", on: { click: _vm.handleToggle } },\n            [\n              _vm.isOpen\n                ? [\n                    _c(\"Icon\", {\n                      staticClass: \"toggle-arrow\",\n                      attrs: { type: \"angle-double-up\" },\n                    }),\n                    _vm._v(\" \"),\n                    _c(\"span\", [_vm._v(_vm._s(\"收起更多设置\"))]),\n                  ]\n                : [\n                    _c(\"Icon\", {\n                      staticClass: \"toggle-arrow\",\n                      attrs: { type: \"angle-double-down\" },\n                    }),\n                    _vm._v(\" \"),\n                    _c(\"span\", [_vm._v(_vm._s(\"展开更多设置\"))]),\n                  ],\n            ],\n            2\n          ),\n        ]\n      ),\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../../node_modules/_babel-loader@8.2.5@babel-loader/lib/index.js??clonedRuleSet-1[0].rules[0].use[0]!../../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./toggle-display.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/_babel-loader@8.2.5@babel-loader/lib/index.js??clonedRuleSet-1[0].rules[0].use[0]!../../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./toggle-display.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./toggle-display.vue?vue&type=template&id=d5d452ba&scoped=true&\"\nimport script from \"./toggle-display.vue?vue&type=script&lang=js&\"\nexport * from \"./toggle-display.vue?vue&type=script&lang=js&\"\nimport style0 from \"./toggle-display.vue?vue&type=style&index=0&id=d5d452ba&lang=postcss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d5d452ba\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"D:\\\\Desktop\\\\bk-job-frontend\\\\node_modules\\\\_vue-hot-reload-api@2.3.4@vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('d5d452ba')) {\n      api.createRecord('d5d452ba', component.options)\n    } else {\n      api.reload('d5d452ba', component.options)\n    }\n    module.hot.accept(\"./toggle-display.vue?vue&type=template&id=d5d452ba&scoped=true&\", function () {\n      api.rerender('d5d452ba', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/views/task-manage/template-operation/components/toggle-display.vue\"\nexport default component.exports","var render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    { staticClass: \"template-operation\", attrs: { id: \"templateOperation\" } },\n    [\n      _c(\n        \"div\",\n        { staticClass: \"layout-left\" },\n        [\n          _c(\"scroll-faker\", { ref: \"contentScroll\" }, [\n            _c(\n              \"div\",\n              { staticClass: \"template-container\" },\n              [\n                _c(\n                  \"smart-action\",\n                  {\n                    attrs: { \"offset-target\": \"bk-form-content\" },\n                    scopedSlots: _vm._u([\n                      {\n                        key: \"action\",\n                        fn: function () {\n                          return [\n                            _c(\n                              \"bk-button\",\n                              {\n                                directives: [\n                                  {\n                                    name: \"test\",\n                                    rawName: \"v-test\",\n                                    value: {\n                                      type: \"button\",\n                                      value: \"operationTemplateSubmit\",\n                                    },\n                                    expression:\n                                      \"{ type: 'button', value: 'operationTemplateSubmit' }\",\n                                  },\n                                ],\n                                staticClass: \"w120 mr10\",\n                                attrs: {\n                                  theme: \"primary\",\n                                  loading: _vm.isSubmiting,\n                                },\n                                on: { click: _vm.handlerSubmit },\n                              },\n                              [\n                                _vm._v(\n                                  \"\\n                            \" +\n                                    _vm._s(_vm.submitText) +\n                                    \"\\n                        \"\n                                ),\n                              ]\n                            ),\n                            _vm._v(\" \"),\n                            _c(\n                              \"bk-button\",\n                              {\n                                directives: [\n                                  {\n                                    name: \"test\",\n                                    rawName: \"v-test\",\n                                    value: {\n                                      type: \"button\",\n                                      value: \"operationTemplateCancel\",\n                                    },\n                                    expression:\n                                      \"{ type: 'button', value: 'operationTemplateCancel' }\",\n                                  },\n                                ],\n                                on: { click: _vm.handleCancel },\n                              },\n                              [\n                                _vm._v(\n                                  \"\\n                            \" +\n                                    _vm._s(\"取消\") +\n                                    \"\\n                        \"\n                                ),\n                              ]\n                            ),\n                          ]\n                        },\n                        proxy: true,\n                      },\n                    ]),\n                  },\n                  [\n                    _c(\n                      \"jb-form\",\n                      {\n                        directives: [\n                          {\n                            name: \"test\",\n                            rawName: \"v-test\",\n                            value: { type: \"form\", value: \"template\" },\n                            expression: \"{ type: 'form', value: 'template' }\",\n                          },\n                        ],\n                        ref: \"templateOperateRef\",\n                        attrs: { model: _vm.formData, rules: _vm.rules },\n                      },\n                      [\n                        _c(\"bk-alert\", {\n                          staticClass: \"info\",\n                          attrs: {\n                            title:\n                              \"「对作业模板的修改不会立即自动更新执行方案，需要由用户手动触发」\",\n                          },\n                        }),\n                        _vm._v(\" \"),\n                        _c(\n                          \"jb-form-item\",\n                          {\n                            attrs: {\n                              label: \"模板名称\",\n                              required: \"\",\n                              property: \"name\",\n                            },\n                          },\n                          [\n                            _c(\"jb-input\", {\n                              staticClass: \"input form-item-content\",\n                              attrs: {\n                                placeholder: \"输入作业模板名称\",\n                                maxlength: 60,\n                              },\n                              model: {\n                                value: _vm.formData.name,\n                                callback: function ($$v) {\n                                  _vm.$set(_vm.formData, \"name\", $$v)\n                                },\n                                expression: \"formData.name\",\n                              },\n                            }),\n                          ],\n                          1\n                        ),\n                        _vm._v(\" \"),\n                        _c(\n                          \"toggle-display\",\n                          { staticStyle: { \"margin-bottom\": \"20px\" } },\n                          [\n                            _c(\n                              \"jb-form-item\",\n                              {\n                                attrs: { label: \"场景标签\", property: \"tags\" },\n                              },\n                              [\n                                _c(\"jb-tag-select\", {\n                                  staticClass: \"input form-item-content\",\n                                  attrs: {\n                                    placeholder:\n                                      \"标签对资源的分类管理有很大帮助\",\n                                  },\n                                  model: {\n                                    value: _vm.formData.tags,\n                                    callback: function ($$v) {\n                                      _vm.$set(_vm.formData, \"tags\", $$v)\n                                    },\n                                    expression: \"formData.tags\",\n                                  },\n                                }),\n                              ],\n                              1\n                            ),\n                            _vm._v(\" \"),\n                            _c(\n                              \"jb-form-item\",\n                              { attrs: { label: \"模板描述\" } },\n                              [\n                                _c(\"bk-input\", {\n                                  staticClass:\n                                    \"template-desc-textarea form-item-content\",\n                                  attrs: {\n                                    type: \"textarea\",\n                                    maxlength: 500,\n                                    placeholder:\n                                      \"填写该模板的功能介绍等详细描述...\",\n                                  },\n                                  model: {\n                                    value: _vm.formData.description,\n                                    callback: function ($$v) {\n                                      _vm.$set(_vm.formData, \"description\", $$v)\n                                    },\n                                    expression: \"formData.description\",\n                                  },\n                                }),\n                              ],\n                              1\n                            ),\n                          ],\n                          1\n                        ),\n                        _vm._v(\" \"),\n                        _c(\n                          \"jb-form-item\",\n                          {\n                            staticStyle: { \"margin-bottom\": \"30px\" },\n                            attrs: { label: \"全局变量\" },\n                          },\n                          [\n                            _c(\"render-global-var\", {\n                              attrs: {\n                                list: _vm.formData.variables,\n                                mode: \"operate\",\n                              },\n                              on: {\n                                \"on-change\": _vm.handleGlobalVariableChange,\n                              },\n                            }),\n                          ],\n                          1\n                        ),\n                        _vm._v(\" \"),\n                        _c(\n                          \"jb-form-item\",\n                          {\n                            staticStyle: { \"margin-bottom\": \"30px\" },\n                            attrs: {\n                              label: \"作业步骤\",\n                              required: \"\",\n                              property: \"steps\",\n                            },\n                          },\n                          [\n                            _c(\"render-task-step\", {\n                              ref: \"step\",\n                              attrs: {\n                                list: _vm.formData.steps,\n                                variable: _vm.formData.variables,\n                                mode: \"operation\",\n                              },\n                              on: { \"on-change\": _vm.handleTaskStepChange },\n                            }),\n                          ],\n                          1\n                        ),\n                      ],\n                      1\n                    ),\n                  ],\n                  1\n                ),\n              ],\n              1\n            ),\n          ]),\n          _vm._v(\" \"),\n          _c(\"back-top\", { attrs: { target: _vm.getScrollParent } }),\n        ],\n        1\n      ),\n      _vm._v(\" \"),\n      _c(\"div\", {\n        staticClass: \"layout-right\",\n        attrs: { id: \"templateOperationLayoutRight\" },\n      }),\n    ]\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/_babel-loader@8.2.5@babel-loader/lib/index.js??clonedRuleSet-1[0].rules[0].use[0]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/_babel-loader@8.2.5@babel-loader/lib/index.js??clonedRuleSet-1[0].rules[0].use[0]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=77c0a293&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=postcss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"D:\\\\Desktop\\\\bk-job-frontend\\\\node_modules\\\\_vue-hot-reload-api@2.3.4@vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('77c0a293')) {\n      api.createRecord('77c0a293', component.options)\n    } else {\n      api.reload('77c0a293', component.options)\n    }\n    module.hot.accept(\"./index.vue?vue&type=template&id=77c0a293&\", function () {\n      api.rerender('77c0a293', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/views/task-manage/template-operation/index.vue\"\nexport default component.exports","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../../node_modules/_mini-css-extract-plugin@2.6.0@mini-css-extract-plugin/dist/loader.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../../node_modules/_css-loader@6.7.1@css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/_postcss-loader@6.2.1@postcss-loader/dist/cjs.js!../../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./toggle-display.vue?vue&type=style&index=0&id=d5d452ba&lang=postcss&scoped=true&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../../node_modules/_vue-style-loader@4.1.3@vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"b5bc35b6\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../../node_modules/_mini-css-extract-plugin@2.6.0@mini-css-extract-plugin/dist/loader.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../../node_modules/_css-loader@6.7.1@css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/_postcss-loader@6.2.1@postcss-loader/dist/cjs.js!../../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./toggle-display.vue?vue&type=style&index=0&id=d5d452ba&lang=postcss&scoped=true&\", function() {\n     var newContent = require(\"!!../../../../../node_modules/_mini-css-extract-plugin@2.6.0@mini-css-extract-plugin/dist/loader.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../../node_modules/_css-loader@6.7.1@css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/_postcss-loader@6.2.1@postcss-loader/dist/cjs.js!../../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./toggle-display.vue?vue&type=style&index=0&id=d5d452ba&lang=postcss&scoped=true&\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/_mini-css-extract-plugin@2.6.0@mini-css-extract-plugin/dist/loader.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../node_modules/_css-loader@6.7.1@css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/_postcss-loader@6.2.1@postcss-loader/dist/cjs.js!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=postcss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/_vue-style-loader@4.1.3@vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"dbce0916\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/_mini-css-extract-plugin@2.6.0@mini-css-extract-plugin/dist/loader.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../node_modules/_css-loader@6.7.1@css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/_postcss-loader@6.2.1@postcss-loader/dist/cjs.js!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=postcss&\", function() {\n     var newContent = require(\"!!../../../../node_modules/_mini-css-extract-plugin@2.6.0@mini-css-extract-plugin/dist/loader.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../node_modules/_css-loader@6.7.1@css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/_postcss-loader@6.2.1@postcss-loader/dist/cjs.js!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=postcss&\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}"],"names":["name","data","isOpen","methods","components","JbTagSelect","JbInput","BackTop","ToggleDisplay","RenderGlobalVar","RenderTaskStep","isLoading","isPlanListLoading","formData","tags","variables","steps","description","planList","isSubmiting","execLoading","computed","watch","deep","required","message","trigger","validator","requestHandler","id","permission","then","setTimeout","window","catch","includes","error","finally","TaskPlanService","checkName","stack","title","subTitle","okText","extCls","syncStepVarialbeDelete","stepList","server","currentStep","changeFlag","fileSourceList","currentFile","executeTarget","syncStepVariableRename","handleGlobalVariableChange","result","delete","variable","renameMap","deleteMap","handleTaskStepChange","planSync","createSuccessCallback","params","isClickClose","confirmInfo","templateId","query","mode","type","showFooter","marginBottom","color","marginRight","handleGoTemplateEdit","handleGoTemplateDetail","handleGoPlan","cancelFn","editSuccessCallback","planIds","from","handleGoSync","render","_vm","this","_h","$createElement","_c","_self","staticClass","directives","rawName","value","expression","_t","_v","staticStyle","attrs","label","on","click","handleToggle","_s","_withStripped","component","options","__file","ref","scopedSlots","_u","key","fn","theme","loading","handlerSubmit","submitText","handleCancel","proxy","model","rules","property","placeholder","maxlength","callback","$$v","$set","list","target","getScrollParent","content","__esModule","default","module","locals","exports","add"],"sourceRoot":""}