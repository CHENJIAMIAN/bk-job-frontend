{"version":3,"file":"js/7467.db16a3b0c0bbca0d759a.js","mappings":"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","sources":["webpack://job/src/views/executive-history/redo-task/index.vue","webpack://job/./src/views/executive-history/redo-task/index.vue?936f","webpack://job/./src/views/executive-history/redo-task/index.vue?1d9e","webpack://job/./src/views/executive-history/redo-task/index.vue?1a56","webpack://job/./src/views/executive-history/redo-task/index.vue?7e2a"],"sourcesContent":["<template>\n    <div class=\"setting-variable\" v-bkloading=\"{ isLoading }\">\n        <h2 class=\"title\">{{ '全局变量' }}</h2>\n        <smart-action offset-target=\"variable-value\">\n            <global-variable-layout>\n                <global-variable\n                    v-for=\"variable in taskVariables\"\n                    ref=\"variable\"\n                    :type=\"variable.type\"\n                    :key=\"variable.id\"\n                    :data=\"variable\" />\n            </global-variable-layout>\n            <template #action>\n                <bk-button\n                    theme=\"primary\"\n                    class=\"w120 mr10\"\n                    :loading=\"isSubmiting\"\n                    @click=\"handleGoExec\">\n                    {{ '执行' }}\n                </bk-button>\n                <bk-button @click=\"handleCancle\">{{ '取消' }}</bk-button>\n            </template>\n        </smart-action>\n        <element-teleport v-if=\"taskName\">\n            <div style=\"font-size: 12px; color: #63656e;\">（{{ taskName }}）</div>\n        </element-teleport>\n    </div>\n</template>\n<script>\n       import TaskExecuteService from '@service/task-execute';\n    import TaskHostNodeModel from '@model/task-host-node';\n    import GlobalVariableLayout from '@components/global-variable/layout';\n    import GlobalVariable from '@components/global-variable/edit';\n\n    export default {\n        name: '',\n        components: {\n            GlobalVariableLayout,\n            GlobalVariable,\n        },\n        data () {\n            return {\n                taskName: '123',\n                taskVariables: [],\n                isLoading: true,\n                isSubmiting: false,\n                templateId: 0,\n                taskId: 0,\n            };\n        },\n        computed: {\n            isSkeletonLoading () {\n                return this.isLoading;\n            },\n        },\n        created () {\n            this.taskInstanceId = this.$route.params.taskInstanceId;\n            this.fetchData();\n        },\n        methods: {\n            /**\n             * @desc 获取任务详情数据\n             */\n            fetchData () {\n                TaskExecuteService.fetchTaskInstance({\n                    id: this.taskInstanceId,\n                }).then((data) => {\n                    this.taskName = data.taskInstance.name;\n                    this.taskVariables = Object.freeze(data.variables.map(({\n                        id,\n                        name,\n                        type,\n                        value,\n                        targetValue,\n                        changeable,\n                    }) => ({\n                        id,\n                        name,\n                        type,\n                        defaultValue: value,\n                        defaultTargetValue: new TaskHostNodeModel(targetValue || {}),\n                        changeable,\n                    })));\n                })\n                    .finally(() => {\n                        this.isLoading = false;\n                    });\n            },\n            /**\n             * @desc 任务重做执行\n             */\n            handleGoExec () {\n                if (!this.$refs.variable) {\n                    return;\n                }\n                Promise.all(this.$refs.variable.map(item => item.validate()))\n                    .then((taskVariables) => {\n                        this.isSubmiting = true;\n                        TaskExecuteService.redoTask({\n                            taskInstanceId: this.taskInstanceId,\n                            taskVariables: taskVariables.map(({ id, name, type, value, targetValue }) => ({\n                                id,\n                                name,\n                                type,\n                                value,\n                                targetValue,\n                            })),\n                        }).then(({ taskInstanceId }) => {\n                            this.$bkMessage({\n                                theme: 'success',\n                                message: '操作成功',\n                            });\n                            window.changeAlert = false;\n                            this.$router.push({\n                                name: 'historyTask',\n                                params: {\n                                    id: taskInstanceId,\n                                },\n                            });\n                        })\n                            .catch(() => {\n                                this.isSubmiting = false;\n                            });\n                    });\n            },\n            /**\n             * @desc 取消重做\n             */\n            handleCancle () {\n                this.routerBack();\n            },\n            /**\n             * @desc 路由回退\n             */\n            routerBack () {\n                this.$router.push({\n                    name: 'historyList',\n                });\n            },\n        },\n    };\n</script>\n<style lang='postcss'>\n    .setting-variable {\n        .title {\n            margin-bottom: 20px;\n            font-size: 14px;\n            line-height: 1;\n            color: #313238;\n        }\n\n        .variable-list {\n            display: inline-block;\n        }\n    }\n\n    .setting-wariable-operate {\n        margin-left: 88px;\n    }\n</style>\n","var render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    {\n      directives: [\n        {\n          name: \"bkloading\",\n          rawName: \"v-bkloading\",\n          value: { isLoading: _vm.isLoading },\n          expression: \"{ isLoading }\",\n        },\n      ],\n      staticClass: \"setting-variable\",\n    },\n    [\n      _c(\"h2\", { staticClass: \"title\" }, [_vm._v(_vm._s(\"全局变量\"))]),\n      _vm._v(\" \"),\n      _c(\n        \"smart-action\",\n        {\n          attrs: { \"offset-target\": \"variable-value\" },\n          scopedSlots: _vm._u([\n            {\n              key: \"action\",\n              fn: function () {\n                return [\n                  _c(\n                    \"bk-button\",\n                    {\n                      staticClass: \"w120 mr10\",\n                      attrs: { theme: \"primary\", loading: _vm.isSubmiting },\n                      on: { click: _vm.handleGoExec },\n                    },\n                    [\n                      _vm._v(\n                        \"\\n                \" + _vm._s(\"执行\") + \"\\n            \"\n                      ),\n                    ]\n                  ),\n                  _vm._v(\" \"),\n                  _c(\"bk-button\", { on: { click: _vm.handleCancle } }, [\n                    _vm._v(_vm._s(\"取消\")),\n                  ]),\n                ]\n              },\n              proxy: true,\n            },\n          ]),\n        },\n        [\n          _c(\n            \"global-variable-layout\",\n            _vm._l(_vm.taskVariables, function (variable) {\n              return _c(\"global-variable\", {\n                key: variable.id,\n                ref: \"variable\",\n                refInFor: true,\n                attrs: { type: variable.type, data: variable },\n              })\n            }),\n            1\n          ),\n        ],\n        1\n      ),\n      _vm._v(\" \"),\n      _vm.taskName\n        ? _c(\"element-teleport\", [\n            _c(\n              \"div\",\n              { staticStyle: { \"font-size\": \"12px\", color: \"#63656e\" } },\n              [_vm._v(\"（\" + _vm._s(_vm.taskName) + \"）\")]\n            ),\n          ])\n        : _vm._e(),\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-1[0].rules[0].use[0]!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-1[0].rules[0].use[0]!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=34a99326&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=postcss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/home/runner/work/bk-job-frontend/bk-job-frontend/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('34a99326')) {\n      api.createRecord('34a99326', component.options)\n    } else {\n      api.reload('34a99326', component.options)\n    }\n    module.hot.accept(\"./index.vue?vue&type=template&id=34a99326&\", function () {\n      api.rerender('34a99326', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/views/executive-history/redo-task/index.vue\"\nexport default component.exports","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=postcss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"201758c8\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=postcss&\", function() {\n     var newContent = require(\"!!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../node_modules/css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/dist/cjs.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=postcss&\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}"],"names":["name","components","GlobalVariableLayout","GlobalVariable","data","taskName","taskVariables","isLoading","isSubmiting","templateId","taskId","computed","isSkeletonLoading","created","methods","fetchData","TaskExecuteService","id","then","type","value","targetValue","changeable","defaultValue","defaultTargetValue","finally","handleGoExec","Promise","taskInstanceId","theme","message","window","params","catch","handleCancle","routerBack","render","_vm","this","_h","$createElement","_c","_self","directives","rawName","expression","staticClass","_v","_s","attrs","scopedSlots","_u","key","fn","loading","on","click","proxy","_l","variable","ref","refInFor","staticStyle","color","_e","_withStripped","component","options","__file","content","__esModule","default","module","locals","exports","add"],"sourceRoot":""}