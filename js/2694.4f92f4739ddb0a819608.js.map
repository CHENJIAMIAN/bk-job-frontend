{"version":3,"file":"js/2694.4f92f4739ddb0a819608.js","mappings":"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","sources":["webpack://job/src/views/service-state/list/index.vue","webpack://job/./src/domain/model/service-state.js","webpack://job/./src/domain/service/service-state.js","webpack://job/./src/domain/source/service-state.js","webpack://job/./src/views/service-state/list/index.vue?5c96","webpack://job/./src/views/service-state/list/index.vue?85ce","webpack://job/./src/views/service-state/list/index.vue?57c8","webpack://job/./src/views/service-state/list/index.vue?eb4e"],"sourcesContent":["\r\n<template>\r\n    <div class=\"service-state-info\" v-bkloading=\"{ isLoading }\">\r\n        <bk-table\r\n            :data=\"serviceData\"\r\n            :size=\"tableSize\"\r\n            row-key=\"name\"\r\n            ext-cls=\"service-table\"\r\n            :expand-row-keys=\"expandRow\"\r\n            @row-click=\"toggleRowExpansion\">\r\n            <bk-table-column\r\n                type=\"expand\"\r\n                key=\"expand\"\r\n                :before-expand-change=\"onBeforeExpandChange\">\r\n                <template slot-scope=\"{ row }\">\r\n                    <bk-table\r\n                        ext-cls=\"service-expand-table\"\r\n                        :data=\"row.instanceList\"\r\n                        :outer-border=\"false\"\r\n                        :header-border=\"false\">\r\n                        <bk-table-column\r\n                            key=\"index\"\r\n                            width=\"60\"\r\n                            :label=\"$t('service.序号.colHead')\">\r\n                            <template slot-scope=\"{ $index }\">\r\n                                #{{ $index + 1 }}\r\n                            </template>\r\n                        </bk-table-column>\r\n                        <bk-table-column\r\n                            prop=\"name\"\r\n                            key=\"name\"\r\n                            width=\"420\"\r\n                            :label=\"$t('service.实例名.colHead')\">\r\n                            <template slot-scope=\"scope\">\r\n                                {{ scope.row.name }}\r\n                            </template>\r\n                        </bk-table-column>\r\n                        <bk-table-column\r\n                            prop=\"version\"\r\n                            key=\"version\"\r\n                            width=\"310\"\r\n                            :label=\"$t('service.版本号.label')\" />\r\n                        <bk-table-column\r\n                            prop=\"status\"\r\n                            key=\"status\"\r\n                            :label=\"$t('service.状态.colHead')\">\r\n                            <template slot-scope=\"scope\">\r\n                                <Icon :type=\"statusIcon(scope.row)\" svg />\r\n                                <span v-html=\"statusHtml(scope.row)\" />\r\n                            </template>\r\n                        </bk-table-column>\r\n                        <bk-table-column\r\n                            prop=\"ip\"\r\n                            key=\"ip\"\r\n                            width=\"150\"\r\n                            :label=\"$t('service.绑定IP.colHead')\">\r\n                            <template slot-scope=\"scope\">\r\n                                <span class=\"service-ip\" @click=\"handleCopyIp(scope.row.ip)\">\r\n                                    {{ scope.row.ip }}\r\n                                    <Icon class=\"ml5 copy-ip-icon\" type=\"step-copy\" svg />\r\n                                    <!-- <Icon class=\"skip-icon\" type=\"edit\" svg /> -->\r\n                                </span>\r\n                            </template>\r\n                        </bk-table-column>\r\n                        <bk-table-column\r\n                            prop=\"port\"\r\n                            key=\"port\"\r\n                            width=\"100\"\r\n                            :label=\"$t('service.端口.colHead')\" />\r\n                    </bk-table>\r\n                </template>\r\n            </bk-table-column>\r\n            <bk-table-column\r\n                :label=\"$t('service.服务名.colHead')\"\r\n                prop=\"name\"\r\n                width=\"480\"\r\n                key=\"name\"\r\n                align=\"left\" />\r\n            <bk-table-column\r\n                :label=\"$t('service.版本号.colHead')\"\r\n                prop=\"version\"\r\n                width=\"310\"\r\n                key=\"version\"\r\n                align=\"left\">\r\n                <template slot-scope=\"{ row }\">\r\n                    <span v-html=\"row.versionHtml\" />\r\n                </template>\r\n            </bk-table-column>\r\n            <bk-table-column\r\n                :label=\"$t('service.实例状态.colHead')\"\r\n                prop=\"instanceList\"\r\n                key=\"instanceList\"\r\n                align=\"left\">\r\n                <template slot-scope=\"{ row }\">\r\n                    <div v-bk-tooltips=\"instanceTips(row)\">\r\n                        <span class=\"service-instance-num abnormal\" v-if=\"row.abnormalNum\">{{ row.abnormalNum }}</span>\r\n                        <span class=\"service-instance-num unknown\" v-if=\"row.unknownNum\">{{ row.unknownNum }}</span>\r\n                        <span class=\"service-instance-num normal\" v-if=\"row.normalNum\">{{ row.normalNum }}</span>\r\n                    </div>\r\n                </template>\r\n            </bk-table-column>\r\n        </bk-table>\r\n    </div>\r\n</template>\r\n \r\n<script>\r\n    import I18n from '@/i18n';\r\n    import ServiceStateService from '@service/service-state';\r\n    import {\r\n        execCopy,\r\n    } from '@utils/assist';\r\n\r\n    export default {\r\n        name: 'Service',\r\n        data () {\r\n            return {\r\n                isLoading: false,\r\n                tableSize: 'small',\r\n                serviceData: [],\r\n                expandRow: [],\r\n                timer: null,\r\n                showFirstExpandRow: true,\r\n            };\r\n        },\r\n        computed: {\r\n            isSkeletonLoading () {\r\n                return this.isLoading;\r\n            },\r\n        },\r\n        created () {\r\n            this.fetchData();\r\n        },\r\n        destroyed () {\r\n            clearInterval(this.timer);\r\n        },\r\n        methods: {\r\n            /**\r\n             * @desc 获取服务运行状态数据,每三秒轮询一次\r\n             */\r\n            fetchData () {\r\n                // ServiceStateService.serviceList({}, {\r\n                //     permission: 'page',\r\n                // })\r\n                //     .then((data) => {\r\n                const data = [{}, {}, {}];\r\n                if (data.length < 1) {\r\n                    return;\r\n                }\r\n                this.serviceData = Object.freeze(data);\r\n                // 折叠表格默认展开第一个\r\n                if (this.showFirstExpandRow) {\r\n                    this.expandRow.push(this.serviceData[0].name);\r\n                }\r\n                this.serviceData.forEach((service) => {\r\n                    let abnormalNum = 0;\r\n                    let normalNum = 0;\r\n                    let unknownNum = 0;\r\n                    service.instanceList.forEach((instance) => {\r\n                        if (instance.status === 1) {\r\n                            normalNum += 1;\r\n                        } else if (instance.status === -1) {\r\n                            unknownNum += 1;\r\n                        } else if (instance.status === 0) {\r\n                            abnormalNum += 1;\r\n                        }\r\n                    });\r\n                    const statusMap = {\r\n                        abnormalNum,\r\n                        normalNum,\r\n                        unknownNum,\r\n                    };\r\n                    Object.assign(service, statusMap);\r\n                    this.showFirstExpandRow = false;\r\n                    clearInterval(this.timer);\r\n                    this.timer = setInterval(() => {\r\n                        this.fetchData();\r\n                    }, 3000);\r\n                });\r\n                    \r\n                // })\r\n                //     .finally(() => {\r\n                this.isLoading = false;\r\n                // });\r\n            },\r\n\r\n            /**\r\n             * @desc 控制折叠表格只能展开一项\r\n             * @param {Object} row 表格当前行数据\r\n             */\r\n            toggleRowExpansion (row) {\r\n                if (this.expandRow.includes(row.name)) {\r\n                    this.expandRow = [];\r\n                } else {\r\n                    this.expandRow = [\r\n                        row.name,\r\n                    ];\r\n                }\r\n            },\r\n\r\n            /**\r\n             * @desc 控制折叠表格只能展开一项\r\n             * @param {Object} row 表格当前行数据\r\n             */\r\n            onBeforeExpandChange ({ row }) {\r\n                this.toggleRowExpansion(row);\r\n            },\r\n\r\n            /**\r\n             * @desc 自定义表格状态内容\r\n             */\r\n            statusHtml (row) {\r\n                const styles = 'color: #aaacb5';\r\n                const statusHtmlMap = {\r\n                    0: `<span>${I18n.t('异常')}<span style=\"${styles}\"> #SERVICE UNAVAILABLE (503)</span></span>`,\r\n                    1: `<span>${I18n.t('正常')}</span>`,\r\n                    '-1': `<span>${I18n.t('未知')}<span style=\"${styles}\"> #NO MAPPING</span></span>`,\r\n                };\r\n                return statusHtmlMap[row.status];\r\n            },\r\n\r\n            /**\r\n             * @desc 自定义表格状态图标\r\n             */\r\n            statusIcon (row) {\r\n                const statusIcomMap = {\r\n                    0: 'abnormal',\r\n                    1: 'normal',\r\n                    '-1': 'unknown',\r\n                };\r\n                return statusIcomMap[row.status];\r\n            },\r\n\r\n            /**\r\n             * @desc 自定义实例状态tooltips内容\r\n             */\r\n            instanceTips (row) {\r\n                let tipsStr = '';\r\n                if (row.abnormalNum) {\r\n                    tipsStr = `${I18n.t('异常')}: ${row.abnormalNum}`;\r\n                }\r\n                if (row.unknownNum) {\r\n                    tipsStr += ` ${I18n.t('未知')}: ${row.unknownNum}`;\r\n                }\r\n                if (row.normalNum) {\r\n                    tipsStr += ` ${I18n.t('正常')}: ${row.normalNum}`;\r\n                }\r\n                return { content: tipsStr, placement: 'top' };\r\n            },\r\n\r\n            /**\r\n             * @desc 复制IP\r\n             */\r\n            handleCopyIp (ip) {\r\n                execCopy(ip, `${I18n.t('复制成功')}`);\r\n            },\r\n        },\r\n    };\r\n</script>\r\n\r\n<style lang=\"postcss\">\r\n    .service-state-info {\r\n        .service-table > .bk-table-body-wrapper > table > tbody > .bk-table-row {\r\n            cursor: pointer;\r\n        }\r\n\r\n        .service-expand-table {\r\n            background-color: #fafbfd;\r\n\r\n            tr {\r\n                background-color: #fafbfd;\r\n            }\r\n        }\r\n\r\n        .bk-table .bk-table-body td.bk-table-expanded-cell {\r\n            padding: 0 48px;\r\n            background-color: #fafbfd;\r\n        }\r\n\r\n        .service-ip {\r\n            display: flex;\r\n            align-items: center;\r\n            cursor: pointer;\r\n\r\n            &:hover {\r\n                .copy-ip-icon {\r\n                    color: #3a84ff;\r\n                }\r\n            }\r\n        }\r\n\r\n        .copy-ip-icon {\r\n            color: #979ba5;\r\n        }\r\n\r\n        .service-instance-num {\r\n            display: inline-block;\r\n            width: 20px;\r\n            height: 20px;\r\n            font-size: 12px;\r\n            font-weight: 700;\r\n            line-height: 18px;\r\n            text-align: center;\r\n            border: 1px solid #fff;\r\n        }\r\n\r\n        .unknown {\r\n            color: #979ba5;\r\n            background-color: #e6e8f0;\r\n        }\r\n\r\n        .abnormal {\r\n            color: #ea3536;\r\n            background-color: #fdd;\r\n        }\r\n\r\n        .normal {\r\n            color: #14a568;\r\n            background-color: #dff0e4;\r\n        }\r\n\r\n        .expanded {\r\n            background-color: #f0f1f5;\r\n        }\r\n\r\n        .bk-table-expand-icon-expanded {\r\n            color: #979ba5;\r\n        }\r\n    }\r\n</style>\r\n","\r\n\r\n// import I18n from '@/i18n'\r\nimport Model from '@model/model';\r\n\r\n// const STATUS_ABNORMAL = 0 // 异常\r\n// const STATUS_NORMAL = 1 // 正常\r\n// const STATUS_UNKNOWN = -1 // 未知\r\n\r\nexport default class SeverState extends Model {\r\n    constructor (payload) {\r\n        super();\r\n        this.name = payload.name;\r\n        this.instanceList = payload.instanceList;\r\n        this.version = payload.version || '--';\r\n        this.versionConsistent = payload.versionConsistent;\r\n    }\r\n\r\n    get versionHtml () {\r\n    /* eslint-disable max-len */\r\n        return this.versionConsistent\r\n            ? `<span>${this.version}</span>`\r\n            : '<i class=\"job-icon job-icon-script-disable\" style=\"color: #EA3636;\" svg /><span style=\"color: #63656E;\">存在不同版本</span>';\r\n    }\r\n}\r\n","\r\n\r\n/* eslint-disable no-param-reassign */\r\nimport serviceState from '../source/service-state';\r\nimport ServiceStateModel from '@model/service-state';\r\n\r\nexport default {\r\n    serviceList (params = {}, paylaod = {}) {\r\n        return serviceState.getList(params, paylaod)\r\n            .then(({ data }) => data.map(service => new ServiceStateModel(service)));\r\n    },\r\n};\r\n","\r\n\r\nimport Request from '@utils/request';\r\nimport ModuleBase from './module-base';\r\n\r\nclass ServiceState extends ModuleBase {\r\n    constructor () {\r\n        super();\r\n        this.module = '/job-manage/web/serviceInfo';\r\n    }\r\n\r\n    // 获取所有服务信息\r\n    getList (params = {}, payload = {}) {\r\n        return Request.get(`${this.module}/listAll`, {\r\n            params,\r\n            payload,\r\n        });\r\n    }\r\n}\r\nexport default new ServiceState();\r\n","var render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    {\n      directives: [\n        {\n          name: \"bkloading\",\n          rawName: \"v-bkloading\",\n          value: { isLoading: _vm.isLoading },\n          expression: \"{ isLoading }\",\n        },\n      ],\n      staticClass: \"service-state-info\",\n    },\n    [\n      _c(\n        \"bk-table\",\n        {\n          attrs: {\n            data: _vm.serviceData,\n            size: _vm.tableSize,\n            \"row-key\": \"name\",\n            \"ext-cls\": \"service-table\",\n            \"expand-row-keys\": _vm.expandRow,\n          },\n          on: { \"row-click\": _vm.toggleRowExpansion },\n        },\n        [\n          _c(\"bk-table-column\", {\n            key: \"expand\",\n            attrs: {\n              type: \"expand\",\n              \"before-expand-change\": _vm.onBeforeExpandChange,\n            },\n            scopedSlots: _vm._u([\n              {\n                key: \"default\",\n                fn: function (ref) {\n                  var row = ref.row\n                  return [\n                    _c(\n                      \"bk-table\",\n                      {\n                        attrs: {\n                          \"ext-cls\": \"service-expand-table\",\n                          data: row.instanceList,\n                          \"outer-border\": false,\n                          \"header-border\": false,\n                        },\n                      },\n                      [\n                        _c(\"bk-table-column\", {\n                          key: \"index\",\n                          attrs: {\n                            width: \"60\",\n                            label: _vm.$t(\"service.序号.colHead\"),\n                          },\n                          scopedSlots: _vm._u(\n                            [\n                              {\n                                key: \"default\",\n                                fn: function (ref) {\n                                  var $index = ref.$index\n                                  return [\n                                    _vm._v(\n                                      \"\\n                            #\" +\n                                        _vm._s($index + 1) +\n                                        \"\\n                        \"\n                                    ),\n                                  ]\n                                },\n                              },\n                            ],\n                            null,\n                            true\n                          ),\n                        }),\n                        _vm._v(\" \"),\n                        _c(\"bk-table-column\", {\n                          key: \"name\",\n                          attrs: {\n                            prop: \"name\",\n                            width: \"420\",\n                            label: _vm.$t(\"service.实例名.colHead\"),\n                          },\n                          scopedSlots: _vm._u(\n                            [\n                              {\n                                key: \"default\",\n                                fn: function (scope) {\n                                  return [\n                                    _vm._v(\n                                      \"\\n                            \" +\n                                        _vm._s(scope.row.name) +\n                                        \"\\n                        \"\n                                    ),\n                                  ]\n                                },\n                              },\n                            ],\n                            null,\n                            true\n                          ),\n                        }),\n                        _vm._v(\" \"),\n                        _c(\"bk-table-column\", {\n                          key: \"version\",\n                          attrs: {\n                            prop: \"version\",\n                            width: \"310\",\n                            label: _vm.$t(\"service.版本号.label\"),\n                          },\n                        }),\n                        _vm._v(\" \"),\n                        _c(\"bk-table-column\", {\n                          key: \"status\",\n                          attrs: {\n                            prop: \"status\",\n                            label: _vm.$t(\"service.状态.colHead\"),\n                          },\n                          scopedSlots: _vm._u(\n                            [\n                              {\n                                key: \"default\",\n                                fn: function (scope) {\n                                  return [\n                                    _c(\"Icon\", {\n                                      attrs: {\n                                        type: _vm.statusIcon(scope.row),\n                                        svg: \"\",\n                                      },\n                                    }),\n                                    _vm._v(\" \"),\n                                    _c(\"span\", {\n                                      domProps: {\n                                        innerHTML: _vm._s(\n                                          _vm.statusHtml(scope.row)\n                                        ),\n                                      },\n                                    }),\n                                  ]\n                                },\n                              },\n                            ],\n                            null,\n                            true\n                          ),\n                        }),\n                        _vm._v(\" \"),\n                        _c(\"bk-table-column\", {\n                          key: \"ip\",\n                          attrs: {\n                            prop: \"ip\",\n                            width: \"150\",\n                            label: _vm.$t(\"service.绑定IP.colHead\"),\n                          },\n                          scopedSlots: _vm._u(\n                            [\n                              {\n                                key: \"default\",\n                                fn: function (scope) {\n                                  return [\n                                    _c(\n                                      \"span\",\n                                      {\n                                        staticClass: \"service-ip\",\n                                        on: {\n                                          click: function ($event) {\n                                            return _vm.handleCopyIp(\n                                              scope.row.ip\n                                            )\n                                          },\n                                        },\n                                      },\n                                      [\n                                        _vm._v(\n                                          \"\\n                                \" +\n                                            _vm._s(scope.row.ip) +\n                                            \"\\n                                \"\n                                        ),\n                                        _c(\"Icon\", {\n                                          staticClass: \"ml5 copy-ip-icon\",\n                                          attrs: { type: \"step-copy\", svg: \"\" },\n                                        }),\n                                      ],\n                                      1\n                                    ),\n                                  ]\n                                },\n                              },\n                            ],\n                            null,\n                            true\n                          ),\n                        }),\n                        _vm._v(\" \"),\n                        _c(\"bk-table-column\", {\n                          key: \"port\",\n                          attrs: {\n                            prop: \"port\",\n                            width: \"100\",\n                            label: _vm.$t(\"service.端口.colHead\"),\n                          },\n                        }),\n                      ],\n                      1\n                    ),\n                  ]\n                },\n              },\n            ]),\n          }),\n          _vm._v(\" \"),\n          _c(\"bk-table-column\", {\n            key: \"name\",\n            attrs: {\n              label: _vm.$t(\"service.服务名.colHead\"),\n              prop: \"name\",\n              width: \"480\",\n              align: \"left\",\n            },\n          }),\n          _vm._v(\" \"),\n          _c(\"bk-table-column\", {\n            key: \"version\",\n            attrs: {\n              label: _vm.$t(\"service.版本号.colHead\"),\n              prop: \"version\",\n              width: \"310\",\n              align: \"left\",\n            },\n            scopedSlots: _vm._u([\n              {\n                key: \"default\",\n                fn: function (ref) {\n                  var row = ref.row\n                  return [\n                    _c(\"span\", {\n                      domProps: { innerHTML: _vm._s(row.versionHtml) },\n                    }),\n                  ]\n                },\n              },\n            ]),\n          }),\n          _vm._v(\" \"),\n          _c(\"bk-table-column\", {\n            key: \"instanceList\",\n            attrs: {\n              label: _vm.$t(\"service.实例状态.colHead\"),\n              prop: \"instanceList\",\n              align: \"left\",\n            },\n            scopedSlots: _vm._u([\n              {\n                key: \"default\",\n                fn: function (ref) {\n                  var row = ref.row\n                  return [\n                    _c(\n                      \"div\",\n                      {\n                        directives: [\n                          {\n                            name: \"bk-tooltips\",\n                            rawName: \"v-bk-tooltips\",\n                            value: _vm.instanceTips(row),\n                            expression: \"instanceTips(row)\",\n                          },\n                        ],\n                      },\n                      [\n                        row.abnormalNum\n                          ? _c(\n                              \"span\",\n                              { staticClass: \"service-instance-num abnormal\" },\n                              [_vm._v(_vm._s(row.abnormalNum))]\n                            )\n                          : _vm._e(),\n                        _vm._v(\" \"),\n                        row.unknownNum\n                          ? _c(\n                              \"span\",\n                              { staticClass: \"service-instance-num unknown\" },\n                              [_vm._v(_vm._s(row.unknownNum))]\n                            )\n                          : _vm._e(),\n                        _vm._v(\" \"),\n                        row.normalNum\n                          ? _c(\n                              \"span\",\n                              { staticClass: \"service-instance-num normal\" },\n                              [_vm._v(_vm._s(row.normalNum))]\n                            )\n                          : _vm._e(),\n                      ]\n                    ),\n                  ]\n                },\n              },\n            ]),\n          }),\n        ],\n        1\n      ),\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/_babel-loader@8.2.5@babel-loader/lib/index.js??clonedRuleSet-1[0].rules[0].use[0]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/_babel-loader@8.2.5@babel-loader/lib/index.js??clonedRuleSet-1[0].rules[0].use[0]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=476b2f11&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=postcss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"D:\\\\Desktop\\\\bk-job-frontend\\\\node_modules\\\\_vue-hot-reload-api@2.3.4@vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('476b2f11')) {\n      api.createRecord('476b2f11', component.options)\n    } else {\n      api.reload('476b2f11', component.options)\n    }\n    module.hot.accept(\"./index.vue?vue&type=template&id=476b2f11&\", function () {\n      api.rerender('476b2f11', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/views/service-state/list/index.vue\"\nexport default component.exports","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/_mini-css-extract-plugin@2.6.0@mini-css-extract-plugin/dist/loader.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../node_modules/_css-loader@6.7.1@css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/_postcss-loader@6.2.1@postcss-loader/dist/cjs.js!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=postcss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/_vue-style-loader@4.1.3@vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"582f6a1a\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/_mini-css-extract-plugin@2.6.0@mini-css-extract-plugin/dist/loader.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../node_modules/_css-loader@6.7.1@css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/_postcss-loader@6.2.1@postcss-loader/dist/cjs.js!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=postcss&\", function() {\n     var newContent = require(\"!!../../../../node_modules/_mini-css-extract-plugin@2.6.0@mini-css-extract-plugin/dist/loader.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../node_modules/_css-loader@6.7.1@css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/_postcss-loader@6.2.1@postcss-loader/dist/cjs.js!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=postcss&\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}"],"names":["name","data","isLoading","tableSize","serviceData","expandRow","timer","showFirstExpandRow","computed","clearInterval","methods","service","normalNum","unknownNum","abnormalNum","Object","toggleRowExpansion","row","onBeforeExpandChange","statusHtml","statusIcon","instanceTips","tipsStr","content","placement","handleCopyIp","SeverState","Model","constructor","payload","super","this","instanceList","version","versionConsistent","versionHtml","serviceList","params","paylaod","serviceState","getList","then","map","ServiceStateModel","ServiceState","ModuleBase","module","Request","get","render","_vm","_h","$createElement","_c","_self","directives","rawName","value","expression","staticClass","attrs","size","on","key","type","scopedSlots","_u","fn","ref","width","label","$t","$index","_v","_s","prop","scope","svg","domProps","innerHTML","click","$event","ip","align","_e","_withStripped","component","options","__file","__esModule","default","id","locals","exports","add"],"sourceRoot":""}