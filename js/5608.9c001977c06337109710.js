(self.webpackChunkjob=self.webpackChunkjob||[]).push([[5608],{26370:function(t,e,a){"use strict";a(35927),a(43364);var i=a(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,a(23232),a(80433),a(63762),a(2156),a(56259),a(95179),a(45974),a(87033),a(7170),a(9042),a(90004),a(71959),a(92974),a(57024),a(35948),a(94522);var s=i(a(33610)),r=i(a(97122)),n=i(a(36410)),l=a(30651),c=i(a(15399)),o=i(a(34601)),d=i(a(60299)),u=i(a(44068)),p=i(a(12e3)),h=a(41980);function f(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function g(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?f(Object(a),!0).forEach((function(e){(0,s.default)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var m={components:{OperationTag:i(a(60174)).default},props:{scriptList:{type:Array,required:!0}},emit:["on-change"],setup(t,e){var a=(0,l.getCurrentInstance)().proxy,i=(0,l.reactive)({isLoading:!0,isShowCreate:!1,search:"",newTagList:[],wholeTagList:[],renderList:[],templateNums:t.scriptList.length,operationList:[],tagRelateNumMap:{},tagCheckInfoMap:{}}),s=(0,l.ref)(null),f=(0,h.checkPublicScript)(a.$route),m=f?p.default:u.default,v=f?o.default.fetchTagList:d.default.fetchWholeList,b={},_={},y={},k={},S=(0,l.computed)((function(){var t=[...i.newTagList,...i.wholeTagList];if(!i.search)return t;var e=new RegExp((0,h.encodeRegexp)(i.search),"i"),a=t.filter((function(t){return e.test(t.name)}));return Object.freeze(a)}));return(0,l.onBeforeMount)((function(){i.isLoading=!0,Promise.all([m.fetchBatchBasicInfo({ids:t.scriptList.map((function(t){return t.id})).join(",")}).then((function(t){t.forEach((function(t){t.tags.forEach((function(t){var e=t.id;b[e]?b[e]+=1:b[e]=1,k[e]||(k[e]={indeterminate:!0},y[e]=!0),b[e]===i.templateNums&&(delete y[e],_[e]=e,k[e]={checked:!0})}))})),i.tagRelateNumMap=Object.freeze(b),i.operationList=Object.values(_),i.tagCheckInfoMap=Object.freeze(k)})),v().then((function(t){i.wholeTagList=Object.freeze(t.reduce((function(t,e){return b[e.id]?t.unshift(e):t.push(e),t}),[]))}))]).finally((function(){i.isLoading=!1}))})),g(g({},(0,l.toRefs)(i)),{},{scrollRef:s,isPublicScript:f,renderList:S,handleSearch:function(t){i.search=(0,n.default)(t)},handleClearSearch:function(){i.search=""},handleNew:function(){i.isShowCreate=!0},handleTagCheckChange:function(t,e){var a=Object.assign({},i.tagCheckInfoMap);a[e]&&a[e].checked?a[e]={checked:!1}:a[e]={checked:!0},window.changeAlert=!0,i.tagCheckInfoMap=Object.freeze(a)},handleTagNew:function(t){s.value&&s.value.scrollTo(0,0),t.isNew=!0,i.newTagList.unshift(t),window.changeAlert=!0},submit:function(){var s=i.operationList.reduce((function(t,e){return t[e]=!0,t}),{}),n=[...i.operationList];(0,r.default)(n,(function(t){return _[t]}));var l=[];return Object.keys(_).forEach((function(t){s[t]||l.push(Number(t))})),Object.keys(y).forEach((function(t){i.tagCheckInfoMap[t].indeterminate||i.tagCheckInfoMap[t].checked||l.push(Number(t))})),m.batchUpdateTag({addTagIdList:n,deleteTagIdList:l,idList:t.scriptList.map((function(t){return t.id}))}).then((function(){a.messageSuccess(c.default.t("script.编辑标签成功")),e.emit("on-change")}))}})}};e.Z=m},39405:function(t,e,a){"use strict";Object.defineProperty(e,"X",{value:!0}),e.Z=void 0;var i=a(41980),s="script_list_tag_panel_toggle",r={data(){var t=localStorage.getItem(s);return{isOpen:t=!t||JSON.parse(t),styles:{}}},mounted(){var t=(0,i.getOffset)(this.$refs.handler).top;this.styles={height:"calc(100vh  - ".concat(t,"px)")}},methods:{handleToggle(){this.isOpen=!this.isOpen,localStorage.setItem(s,JSON.stringify(this.isOpen))}}};e.Z=r},52460:function(t,e,a){"use strict";var i=a(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0;var s=i(a(56318));a(87033),a(35948),a(94522),a(23232),a(80433),a(9042),a(85604);var r=i(a(15399)),n=i(a(44068)),l=i(a(12e3)),c=i(a(60299)),o=i(a(34601)),d=a(41980),u={name:"RenderTagTabItem",components:{TabItem:i(a(14564)).default},data:()=>({isLoading:!1,classesId:1,tagId:0,list:[],countMap:{},isNumberLoading:!1}),computed:{totalCount(){return this.countMap.total||0},unclassifiedCount(){return this.countMap.unclassified||0}},created(){this.isPublicScript=(0,d.checkPublicScript)(this.$route),this.init()},mounted(){this.parseDefaultValueFromURL()},methods:{fetchTagList(){return this.isPublicScript?o.default.fetchTagList():c.default.fetchWholeList()},fetchTagScriptNum(){return this.isPublicScript?l.default.fetchTagCount():n.default.fetchTagCount()},init(){var t=this;this.isLoading=!0,Promise.all([this.fetchTagList(),this.fetchTagScriptNum()]).then((function(e){var a=(0,s.default)(e,2),i=a[0],r=a[1];t.countMap=Object.freeze(r);var n=[];i.forEach((function(t){t.relatedScriptNum=r.tagCount[t.id]||0,n.push(t)})),t.list=Object.freeze(n),t.$emit("on-init",n)})).finally((function(){t.isLoading=!1}))},parseDefaultValueFromURL(){var t=1;if(this.$route.query.panelType)return t=~~this.$route.query.panelType||1,void this.handleClassesSelect(t);if(this.$route.query.panelTag){var e=parseInt(this.$route.query.panelTag,10);e>0&&(this.classesId=0,this.handleSelect(e))}},handleClassesSelect(t){this.classesId!==t&&(this.classesId=t,this.tagId=0,this.$emit("on-change",{panelType:this.classesId,panelTag:""}))},handleSelect(t){t!==this.tagId&&(this.tagId=t,this.classesId=0,this.$emit("on-change",{panelType:"",panelTag:this.tagId}))},handleEdit(t){var e=this;c.default.updateTag(t).then((function(){e.messageSuccess(r.default.t("script.标签名更新成功")),e.fetchTagList()}))}}};e.Z=u},52351:function(t,e,a){"use strict";var i=a(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,a(57024),a(45974),a(87033),a(70969),a(58794);var s=i(a(93435)),r=i(a(18306)),n=i(a(15399)),l=a(61681),c={name:"",props:{icon:{type:String,default:"tag"},loading:{type:Boolean,default:!0},count:{type:Number,default:0},name:{type:String,default:""},value:{type:Number},description:String,tooltipsDisabled:{type:Boolean,default:!1},id:{type:Number},canEdit:{type:Boolean,default:!1},tagList:{type:Array,default:function(){return[]}}},data(){return{displayName:this.name,isEditable:!1,error:""}},computed:{checkRenameList(){var t=this;return this.tagList.filter((function(e){return e.name!==t.name}))},errorTipsConfig(){return{placement:"top-left",content:{1:n.default.t("template.标签名不可为空"),2:n.default.t("template.标签名已存在，请重新输入"),3:l.tagNameRule.message}[this.error],width:3===this.error?200:""}}},created(){this.sefId="tag_".concat((0,r.default)(1,1e3),"_").concat(Date.now())},mounted(){var t=this;document.body.addEventListener("click",this.hideEdit),this.$once("hook:beforeDestroy",(function(){document.body.removeEventListener("click",t.hideEdit)}))},methods:{handleSelect(){this.$emit("on-select",this.id,this.name)},triggerChange(){var t=this;this.displayName!==this.name?""!==this.displayName?(0,s.default)(this.checkRenameList,(function(e){return e.name===t.displayName}))?this.error=2:l.tagNameRule.validator(this.displayName)?(this.error="",this.isEditable=!1,this.$emit("on-edit",{id:this.id,name:this.displayName})):this.error=3:this.error=1:this.isEditable=!1},handleEdit(){var t=this;document.body.click(),this.isEditable=!0,this.$nextTick((function(){t.$refs.input.focus()}))},handleChange(t){this.displayName=t.trim()},handleBlur(){this.triggerChange()},handleEnter(t,e){this.isEditable&&"Enter"===e.key&&13===e.keyCode&&this.triggerChange()},hideEdit(){this.isEditable&&(this.error||(this.isEditable=!1))}}};e.Z=c},69937:function(t,e,a){"use strict";a(35927),a(45974),a(9042),a(43364);var i=a(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0;var s=i(a(33610));a(71959),a(87033);var r=i(a(15399)),n=i(a(60299)),l=i(a(34601)),c=i(a(44068)),o=i(a(12e3)),d=i(a(46117)),u=a(41980),p=a(61681),h=a(46790),f=i(a(80712)),g=i(a(27452)),m=i(a(2645)),v=i(a(36894)),b=i(a(53823)),_=i(a(78621)),y=i(a(25109)),k=i(a(33814)),S=i(a(5315));function w(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function C(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?w(Object(a),!0).forEach((function(e){(0,s.default)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):w(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var T="script_list_columns",$={name:"",components:{ListActionLayout:f.default,RenderList:g.default,ScriptRelatedInfo:_.default,JbSearchSelect:m.default,JbEditInput:v.default,JbEditTag:b.default,Layout:y.default,TagPanel:k.default,BatchEditTag:S.default},data:()=>({showRelated:!1,isShowBatchEditTag:!1,listSelect:[],relatedScriptInfo:{id:0},searchParams:{},selectedTableColumn:[],tableSize:"small"}),computed:{isSkeletonLoading(){return this.$refs.list.isLoading},isBatchEditTagDisabled(){for(var t=0;t<this.listSelect.length;t++){if(!this.listSelect[t].canManage)return!0}return this.listSelect.length<1},allRenderColumnMap(){return this.selectedTableColumn.reduce((function(t,e){return t[e.id]=!0,t}),{})}},created(){this.isPublicScript=(0,u.checkPublicScript)(this.$route),this.serviceHandler=this.isPublicScript?o.default:c.default,this.tagSericeHandler=this.isPublicScript?l.default:n.default,this.getScriptList=this.serviceHandler.scriptList,this.searchClass={},this.searchSelect=[{name:"ID",id:"scriptId",description:r.default.t("script.将覆盖其它条件")},{name:r.default.t("script.脚本名称.colHead"),id:"name",default:!0},{name:r.default.t("script.脚本语言"),id:"type",remoteMethod:o.default.scriptTypeList,remoteExecuteImmediate:!0},{name:r.default.t("script.场景标签.colHead"),id:"tags",remoteMethod:this.tagSericeHandler.fetchTagOfSearch,remoteExecuteImmediate:!0},{name:r.default.t("script.创建人.colHead"),id:"creator",remoteMethod:d.default.fetchUsersOfSearch,inputInclude:!0},{name:r.default.t("script.更新人.colHead"),id:"lastModifyUser",remoteMethod:d.default.fetchUsersOfSearch,inputInclude:!0}],this.tableColumn=[{id:"id",label:"ID"},{id:"name",label:r.default.t("script.脚本名称.colHead"),disabled:!0},{id:"tags",label:r.default.t("script.场景标签.colHead"),disabled:!0},{id:"type",label:r.default.t("script.脚本语言")},{id:"related",label:r.default.t("script.被引用.colHead")},{id:"version",label:r.default.t("script.线上版本")},{id:"creator",label:r.default.t("script.创建人.colHead")},{id:"createTime",label:r.default.t("script.创建时间")},{id:"lastModifyUser",label:r.default.t("script.更新人.colHead")},{id:"lastModifyTime",label:r.default.t("script.更新时间")}];var t=h.listColumnsCache.getItem(T);t?(this.selectedTableColumn=Object.freeze(t.columns),this.tableSize=t.size):this.selectedTableColumn=Object.freeze([{id:"name"},{id:"tags"},{id:"type"},{id:"related"},{id:"version"},{id:"related"},{id:"version"},{id:"lastModifyUser"},{id:"lastModifyTime"}]),this.rules={name:[{required:!0,message:r.default.t("script.脚本名称必填"),trigger:"blur"},{validator:p.scriptNameRule.validator,message:p.scriptNameRule.message,trigger:"blur"}]}},methods:{fetchData(){var t=C({},this.searchParams);this.searchClass.panelType&&(t.panelType=this.searchClass.panelType),this.searchClass.panelTag&&(t.panelTag=this.searchClass.panelTag),this.$refs.list.$emit("onFetch",C({},t))},handleTagPlanChange(t){this.searchClass=t,this.fetchData()},handleBatchEditTag(){this.isShowBatchEditTag=!0},handleBatchEditChange(){this.fetchData(),this.$refs.tagPanelRef.init()},handleSearch(t){this.searchParams=t,this.fetchData()},handleCreate(){this.isPublicScript?this.$router.push({name:"createPublicScript"}):this.$router.push({name:"createScript"})},handleUpdateScript(t,e){var a=this;return this.serviceHandler.scriptUpdateMeta(C(C({id:t},e),{},{updateField:Object.keys(e)[0]})).then((function(){a.$refs.tagPanelRef&&a.$refs.tagPanelRef.init()}))},handleSelection(t){this.listSelect=Object.freeze(t)},handleSettingChange(t){var e=t.fields,a=t.size;this.selectedTableColumn=Object.freeze(e),this.tableSize=a,h.listColumnsCache.setItem(T,{columns:e,size:a})},handleVersion(t){this.isPublicScript?this.$router.push({name:"publicScriptVersion",params:{id:t.id}}):this.$router.push({name:"scriptVersion",params:{id:t.id}})},handleExec(t){this.$router.push({name:"fastExecuteScript",params:{taskInstanceId:0,scriptVersionId:0}})},handleDelete(t){var e=this;return t.isEnableRemove?this.serviceHandler.scriptDelete({id:t.id}).then((function(){return e.fetchData(),e.messageSuccess(r.default.t("script.删除成功")),!0})):(this.messageError(r.default.t("script.脚本正被作业引用中，无法删除")),!1)},handleShowRelated(t){this.showRelated=!0,this.relatedScriptInfo=t},renderHeader:(t,e)=>t("span",[t("span",[e.column.label]),t("bk-popover",[t("icon",{attrs:{type:"circle-italics-info"},style:"margin-left: 8px; font-size: 12px;"}),t("div",{slot:"content"},[t("div",[r.default.t("script.显示被作业引用的次数")]),t("div",[r.default.t("script.显示被执行方案引用的次数")])])])])}};e.Z=$},19759:function(){},4331:function(){},61640:function(){},25218:function(){},5315:function(t,e,a){"use strict";a.r(e),a.d(e,{__esModule:function(){return s.X},default:function(){return l}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.isLoading},expression:"{ isLoading }"}],staticClass:"script-manage-batch-edit-tag"},[a("div",{staticStyle:{"margin-bottom":"8px"}},[t._v("\n        "+t._s(t.$t("script.范围"))+"："+t._s(t.$t("script.共"))),a("span",{staticClass:"strong number"},[t._v(t._s(t.templateNums))]),t._v(t._s(t.$t("script.个脚本"))+"\n    ")]),t._v(" "),a("jb-form",{attrs:{"form-type":"vertical"}},[a("jb-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:t.$t("script.标签"),required:""}},[a("div",{staticClass:"tag-panel"},[a("bk-input",{staticClass:"tag-search",attrs:{value:t.search,spellcheck:!1,"left-icon":"bk-icon icon-search"},on:{change:t.handleSearch}}),t._v(" "),a("div",{staticClass:"wrapper",staticStyle:{height:"210px"}},[t.renderList.length>0?a("scroll-faker",{ref:"scrollRef"},[a("bk-checkbox-group",{staticClass:"tag-list",model:{value:t.operationList,callback:function(e){t.operationList=e},expression:"operationList"}},t._l(t.renderList,(function(e){return a("bk-checkbox",t._b({key:e.id,staticClass:"tag-item",attrs:{value:e.id},on:{change:function(a){return t.handleTagCheckChange(a,e.id)}}},"bk-checkbox",t.tagCheckInfoMap[e.id],!1),[t._v("\n                                "+t._s(e.name)+"\n                                "),t.tagCheckInfoMap[e.id]?[t.tagCheckInfoMap[e.id].checked?a("span",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.right",value:t.$t("script.勾选范围里，全部脚本使用"),expression:"$t('script.勾选范围里，全部脚本使用')",modifiers:{right:!0}}],staticClass:"relate-all"},[t._v("\n                                        All\n                                    ")]):t._e(),t._v(" "),t.tagCheckInfoMap[e.id].indeterminate?a("span",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.right",value:t.$t("script.勾选范围里，有")+" "+t.tagRelateNumMap[e.id]+" "+t.$t("script.个脚本使用"),expression:"`${$t('script.勾选范围里，有')} ${tagRelateNumMap[tagItem.id]} ${$t('script.个脚本使用')}`",modifiers:{right:!0}}],staticClass:"relate-nums"},[t._v("\n                                        "+t._s(t.tagRelateNumMap[e.id])+"/"+t._s(t.templateNums)+"\n                                    ")]):t._e()]:t._e(),t._v(" "),e.isNew?a("span",{staticClass:"new-tag-flag"},[t._v("\n                                    new\n                                ")]):t._e()],2)})),1)],1):t.search?a("Empty",{staticStyle:{"margin-top":"20px"},attrs:{type:"search"}},[a("span",[t._v(t._s(t.$t("script.搜索结果为空"))+"，")]),t._v(" "),a("bk-button",{attrs:{text:""},on:{click:t.handleClearSearch}},[t._v("\n                            "+t._s(t.$t("script.清空搜索"))+"\n                        ")])],1):t._e()],1),t._v(" "),t.isPublicScript?t._e():[a("auth-component",{attrs:{auth:"tag/create"}},[a("div",{staticClass:"tag-create",on:{click:t.handleNew}},[a("bk-icon",{staticStyle:{"margin-right":"8px","font-size":"16px"},attrs:{type:"plus-circle"}}),t._v(" "),a("span",[t._v(t._s(t.$t("script.新建标签")))])],1),t._v(" "),a("div",{staticClass:"tag-create",attrs:{slot:"forbid"},slot:"forbid"},[a("bk-icon",{staticStyle:{"margin-right":"8px","font-size":"16px"},attrs:{type:"plus-circle"}}),t._v(" "),a("span",[t._v(t._s(t.$t("script.新建标签")))])],1)])]],2)])],1),t._v(" "),a("lower-component",{attrs:{level:"custom",custom:t.isShowCreate}},[a("operation-tag",{on:{"on-change":t.handleTagNew},model:{value:t.isShowCreate,callback:function(e){t.isShowCreate=e},expression:"isShowCreate"}})],1)],1)};i._withStripped=!0;var s=a(26370),r=s.Z,n=(a(60844),(0,a(35471).Z)(r,i,[],!1,null,null,null));n.options.__file="src/views/script-manage/list/components/batch-edit-tag.vue";var l=n.exports},25109:function(t,e,a){"use strict";a.r(e),a.d(e,{__esModule:function(){return s.X},default:function(){return l}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"handler",staticClass:"script-manage-list-layout"},[t.$slots.tag?a("div",{class:{"layout-left":!0,expended:t.isOpen}},[a("scroll-faker",{style:t.styles},[t._t("tag")],2)],1):t._e(),t._v(" "),a("div",{staticClass:"layout-right",class:{"no-tag":!t.$slots.tag}},[t.$slots.tag?a("div",{staticClass:"toggle-button",on:{click:t.handleToggle}},[a("Icon",{staticClass:"toggle-arrow",class:{open:t.isOpen},attrs:{type:"down-small"}})],1):t._e(),t._v(" "),t._t("default")],2)])};i._withStripped=!0;var s=a(39405),r=s.Z,n=(a(25334),(0,a(35471).Z)(r,i,[],!1,null,null,null));n.options.__file="src/views/script-manage/list/components/layout.vue";var l=n.exports},33814:function(t,e,a){"use strict";a.r(e),a.d(e,{__esModule:function(){return s.X},default:function(){return l}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.isLoading},expression:"{ isLoading }"}],staticClass:"script-list-tag-panel"},[a("tab-item",{attrs:{name:t.$t("script.全部脚本"),id:1,value:t.classesId,icon:"business-manage",count:t.totalCount,"tooltips-disabled":!0},on:{"on-select":t.handleClassesSelect}}),t._v(" "),a("tab-item",{attrs:{name:t.$t("script.未分类"),id:2,value:t.classesId,icon:"unclassified",count:t.unclassifiedCount,"tooltips-disabled":!0},on:{"on-select":t.handleClassesSelect}}),t._v(" "),a("div",{staticClass:"line"}),t._v(" "),t._l(t.list,(function(e){return[e.relatedScriptNum>0?a("tab-item",{key:e.id,attrs:{id:e.id,count:e.relatedScriptNum,name:e.name,value:t.tagId,"can-edit":!0,"tag-list":t.list,description:e.description},on:{"on-select":t.handleSelect,"on-edit":t.handleEdit}}):t._e()]}))],2)};i._withStripped=!0;var s=a(52460),r=s.Z,n=(a(59233),(0,a(35471).Z)(r,i,[],!1,null,"824b094c",null));n.options.__file="src/views/script-manage/list/components/tag-panel/index.vue";var l=n.exports},14564:function(t,e,a){"use strict";a.r(e),a.d(e,{__esModule:function(){return s.X},default:function(){return l}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"script-list-tag-edit",class:{active:t.value===t.id,display:!t.canEdit,edit:t.canEdit,"edit-error":!!t.error},on:{click:function(t){t.stopPropagation()}}},[a("Icon",{staticClass:"tag-flag",attrs:{type:t.icon}}),t._v(" "),t.isEditable?[a("bk-input",{ref:"input",attrs:{placeholder:t.$t("template.请输入标签名..."),value:t.displayName},on:{change:t.handleChange,blur:t.handleBlur,keyup:t.handleEnter}}),t._v(" "),t.error?a("div",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:t.errorTipsConfig,expression:"errorTipsConfig"}],staticClass:"input-edit-info"},[a("Icon",{attrs:{type:"info"}})],1):t._e()]:[a("div",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:{allowHtml:!0,width:240,distance:15,trigger:"mouseenter",theme:"light",content:"#"+t.sefId,placement:"right-start",boundary:"window",disabled:t.tooltipsDisabled},expression:"{\n                allowHtml: true,\n                width: 240,\n                distance: 15,\n                trigger: 'mouseenter',\n                theme: 'light',\n                content: `#${sefId}`,\n                placement: 'right-start',\n                boundary: 'window',\n                disabled: tooltipsDisabled,\n            }"}],staticClass:"tag-name",on:{click:t.handleSelect}},[a("div",{staticClass:"name-text"},[t._v(t._s(t.displayName))])]),t._v(" "),a("div",{staticClass:"tag-num-box"},[a("span",{staticClass:"tag-num"},[t._v(t._s(t.count))])]),t._v(" "),t.canEdit?a("auth-component",{attrs:{auth:"tag/edit","resource-id":t.id}},[a("div",{staticClass:"edit-action",on:{click:t.handleEdit}},[a("Icon",{attrs:{type:"edit-2"}})],1),t._v(" "),a("div",{staticClass:"edit-action",attrs:{slot:"forbid"},slot:"forbid"},[a("Icon",{attrs:{type:"edit-2"}})],1)]):t._e()],t._v(" "),a("div",{staticStyle:{display:"none"}},[a("table",{staticStyle:{"font-size":"12px","line-height":"24px",color:"#63656e"},attrs:{id:t.sefId}},[a("tr",[a("td",{staticStyle:{color:"#979ba5","text-align":"right","white-space":"nowrap","vertical-align":"top"}},[t._v("标签名称：")]),t._v(" "),a("td",{staticStyle:{"word-break":"break-all","vertical-align":"top"}},[t._v(t._s(t.displayName))])]),t._v(" "),a("tr",[a("td",{staticStyle:{color:"#979ba5","text-align":"right","white-space":"nowrap","vertical-align":"top"}},[t._v("标签描述：")]),t._v(" "),a("td",{staticStyle:{"word-break":"break-all","vertical-align":"top"}},[t._v(t._s(t.description||"--"))])])])])],2)};i._withStripped=!0;var s=a(52351),r=s.Z,n=(a(66493),(0,a(35471).Z)(r,i,[],!1,null,null,null));n.options.__file="src/views/script-manage/list/components/tag-panel/tab-item.vue";var l=n.exports},95608:function(t,e,a){"use strict";a.r(e),a.d(e,{__esModule:function(){return s.X},default:function(){return l}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("layout",{scopedSlots:t._u([{key:"tag",fn:function(){return[a("tag-panel",{ref:"tagPanelRef",on:{"on-change":t.handleTagPlanChange}})]},proxy:!0}])},[t._v(" "),a("list-action-layout",{scopedSlots:t._u([{key:"right",fn:function(){return[a("jb-search-select",{ref:"search",staticStyle:{width:"420px"},attrs:{data:t.searchSelect,placeholder:t.$t("script.搜索脚本名称，类型，场景标签，更新人...")},on:{"on-change":t.handleSearch}})]},proxy:!0}])},[a("auth-button",{staticClass:"w120",attrs:{theme:"primary",auth:"script/create"},on:{click:t.handleCreate}},[t._v("\n            "+t._s(t.$t("script.新建"))+"\n        ")]),t._v(" "),a("bk-button",{on:{click:t.handleBatchEditTag}},[t._v("\n            "+t._s(t.$t("script.编辑标签"))+"\n        ")])],1),t._v(" "),a("render-list",{ref:"list",attrs:{"data-source":t.getScriptList,size:t.tableSize,selectable:"","search-control":function(){return t.$refs.search}},on:{"on-selection-change":t.handleSelection}},[t.allRenderColumnMap.id?a("bk-table-column",{key:"id",attrs:{label:"ID",prop:"id",width:"300",align:"left"}}):t._e(),t._v(" "),a("bk-table-column",{key:"name",attrs:{label:t.$t("script.脚本名称.colHead"),prop:"name","min-width":300,sortable:"",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("auth-component",{attrs:{permission:i.canView,auth:"script/view","resource-id":i.id}},[a("jb-edit-input",{key:i.id,attrs:{field:"scriptName",rules:t.rules.name,value:i.name,"remote-hander":function(e){return t.handleUpdateScript(i.id,e)}},scopedSlots:t._u([{key:"default",fn:function(e){var s=e.value;return[a("span",{staticStyle:{color:"#3a84ff",cursor:"pointer"},on:{click:function(e){return t.handleVersion(i)}}},[t._v("\n                            "+t._s(s)+"\n                        ")])]}}],null,!0)}),t._v(" "),a("span",{attrs:{slot:"forbid"},slot:"forbid"},[t._v(t._s(i.name))])],1)]}}])}),t._v(" "),t.allRenderColumnMap.type?a("bk-table-column",{key:"type",attrs:{label:t.$t("script.脚本语言"),sortable:"",prop:"type",width:"120",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",[t._v(t._s(i.typeName))])]}}],null,!1,3662136475)}):t._e(),t._v(" "),a("bk-table-column",{key:"tags",attrs:{label:t.$t("script.场景标签.colHead"),sortable:"",prop:"tags",width:"200",align:"left","class-name":"edit-tag-column"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("auth-component",{attrs:{permission:i.canManage,auth:"script/edit","resource-id":i.id}},[a("jb-edit-tag",{key:i.id,attrs:{field:"scriptTags",value:i.tags,shortcurt:"","remote-hander":function(e){return t.handleUpdateScript(i.id,e)}}}),t._v(" "),a("div",{attrs:{slot:"forbid"},slot:"forbid"},[t._v(t._s(i.tagsText))])],1)]}}])}),t._v(" "),t.allRenderColumnMap.related?a("bk-table-column",{key:"related",attrs:{label:t.$t("script.被引用.colHead"),prop:"related",width:"120","render-header":t.renderHeader,align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("bk-button",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.right.allowHtml",value:"\n                                <div>"+t.$t("script.作业模板引用")+": "+i.relatedTaskTemplateNum+"</div>\n                                <div>"+t.$t("script.执行方案引用")+": "+i.relatedTaskPlanNum+"</div>",expression:"`\n                                <div>${$t('script.作业模板引用')}: ${row.relatedTaskTemplateNum}</div>\n                                <div>${$t('script.执行方案引用')}: ${row.relatedTaskPlanNum}</div>`",modifiers:{right:!0,allowHtml:!0}}],staticClass:"mr20",attrs:{text:""},on:{click:function(e){return t.handleShowRelated(i)}}},[a("span",[t._v(t._s(i.relatedTaskTemplateNum))]),t._v(" "),a("span",[t._v(" / ")]),t._v(" "),a("span",[t._v(t._s(i.relatedTaskPlanNum))])])]}}],null,!1,3433943686)}):t._e(),t._v(" "),t.allRenderColumnMap.version?a("bk-table-column",{key:"version",attrs:{label:t.$t("script.线上版本"),"show-overflow-tooltip":"",prop:"version",width:"140",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("span",[t._v(" "+t._s(i.version||"--")+" ")])]}}],null,!1,1631662558)}):t._e(),t._v(" "),t.allRenderColumnMap.creator?a("bk-table-column",{key:"creator",attrs:{label:t.$t("script.创建人.colHead"),sortable:"","show-overflow-tooltip":"",prop:"creator",width:"140",align:"left"}}):t._e(),t._v(" "),t.allRenderColumnMap.createTime?a("bk-table-column",{key:"createTime",attrs:{label:t.$t("script.创建时间"),prop:"createTime",width:"180",align:"left"}}):t._e(),t._v(" "),t.allRenderColumnMap.lastModifyUser?a("bk-table-column",{key:"lastModifyUser",attrs:{label:t.$t("script.更新人.colHead"),width:"160",prop:"lastModifyUser",align:"left"}}):t._e(),t._v(" "),t.allRenderColumnMap.lastModifyTime?a("bk-table-column",{key:"lastModifyTime",attrs:{label:t.$t("script.更新时间"),width:"180",prop:"lastModifyTime",align:"left"}}):t._e(),t._v(" "),a("bk-table-column",{key:"action",attrs:{label:t.$t("script.操作"),resizable:!1,fixed:"right",width:"170",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("auth-button",{staticClass:"mr10",attrs:{text:"",permission:i.canView,auth:"script/view","resource-id":i.id},on:{click:function(e){return t.handleVersion(i)}}},[t._v("\n                    "+t._s(t.$t("script.版本管理"))+"\n                ")]),t._v(" "),a("span",{staticClass:"mr10",attrs:{"tippy-tips":i.isExecuteDisable?t.$t("script.该脚本没有 “线上版本” 可执行，请前往版本管理内设置。"):""}},[a("auth-button",{attrs:{text:"",permission:i.canView,auth:"script/execute","resource-id":i.id,disabled:i.isExecuteDisable},on:{click:function(e){return t.handleExec(i)}}},[t._v("\n                        "+t._s(t.$t("script.去执行"))+"\n                    ")])],1),t._v(" "),a("jb-popover-confirm",{attrs:{title:t.$t("script.确定删除该脚本？"),content:t.$t("script.注意！脚本内的所有版本也将被清除"),"confirm-handler":function(){return t.handleDelete(i)}}},[a("auth-button",{attrs:{permission:i.canManage,auth:"script/delete","resource-id":i.id,text:""}},[t._v("\n                        "+t._s(t.$t("script.删除"))+"\n                    ")])],1)]}}])}),t._v(" "),a("bk-table-column",{attrs:{type:"setting"}},[a("bk-table-setting-content",{attrs:{fields:t.tableColumn,selected:t.selectedTableColumn,size:t.tableSize},on:{"setting-change":t.handleSettingChange}})],1)],1),t._v(" "),a("jb-dialog",{attrs:{title:t.$t("script.编辑标签"),"header-position":"left","ok-text":t.$t("script.确定"),width:480},model:{value:t.isShowBatchEditTag,callback:function(e){t.isShowBatchEditTag=e},expression:"isShowBatchEditTag"}},[t.isShowBatchEditTag?a("batch-edit-tag",{attrs:{"script-list":t.listSelect},on:{"on-change":t.handleBatchEditChange}}):t._e()],1),t._v(" "),a("jb-sideslider",{attrs:{"is-show":t.showRelated,"show-footer":!1,"quick-close":"",title:t.$t("script.被引用.label"),width:695},on:{"update:isShow":function(e){t.showRelated=e},"update:is-show":function(e){t.showRelated=e}}},[a("script-related-info",{attrs:{from:"scriptList",info:t.relatedScriptInfo}})],1)],1)};i._withStripped=!0;var s=a(69937),r=s.Z,n=(0,a(35471).Z)(r,i,[],!1,null,null,null);n.options.__file="src/views/script-manage/list/index.vue";var l=n.exports},60844:function(t,e,a){var i=a(19759);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,a(13570).Z)("38ca70ca",i,!1,{})},25334:function(t,e,a){var i=a(4331);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,a(13570).Z)("3c8a1adb",i,!1,{})},59233:function(t,e,a){var i=a(61640);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,a(13570).Z)("db80f542",i,!1,{})},66493:function(t,e,a){var i=a(25218);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,a(13570).Z)("2fdd50b4",i,!1,{})}}]);