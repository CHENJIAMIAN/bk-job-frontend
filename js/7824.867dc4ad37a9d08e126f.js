(self.webpackChunkjob=self.webpackChunkjob||[]).push([[7824],{95386:function(e,t,a){"use strict";a(35927),a(43364);var i=a(22696);Object.defineProperty(t,"X",{value:!0}),t.Z=void 0,a(23232),a(80433),a(63762),a(2156),a(56259),a(95179),a(45974),a(87033),a(7170),a(9042),a(90004),a(71959),a(92974),a(57024),a(35948);var s=i(a(33610)),n=i(a(97122)),l=i(a(36410)),r=a(30651),o=i(a(60299)),c=i(a(22910)),d=a(41980);function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var h={components:{OperationTag:i(a(60174)).default},props:{templateList:{type:Array,required:!0}},emit:["on-change"],setup(e,t){var a=(0,r.reactive)({isLoading:!0,isShowCreate:!1,search:"",newTagList:[{},{},{}],wholeTagList:[{},{},{}],renderList:[{},{},{}],templateNums:e.templateList.length,operationList:[{},{},{}],tagRelateNumMap:{},tagCheckInfoMap:{}}),i=(0,r.ref)(null),s={},u={},h={},m={},f=(0,r.getCurrentInstance)().proxy,v=(0,r.computed)((function(){var e=[...a.newTagList,...a.wholeTagList];if(!a.search)return e;var t=new RegExp((0,d.encodeRegexp)(a.search),"i"),i=e.filter((function(e){return t.test(e.name)}));return Object.freeze(i)}));return(0,r.onBeforeMount)((function(){a.isLoading=!0,Promise.all([o.default.fetchWholeList().then((function(e){a.wholeTagList=Object.freeze(e.reduce((function(e,t){return s[t.id]?e.unshift(t):e.push(t),e}),[]))})),c.default.fetchBasic({ids:e.templateList.map((function(e){return e.id})).join(",")}).then((function(e){e.forEach((function(e){e.tags.forEach((function(e){var t=e.id;s[t]?s[t]+=1:s[t]=1,m[t]||(m[t]={indeterminate:!0},h[t]=!0),s[t]===a.templateNums&&(delete h[t],u[t]=t,m[t]={checked:!0})}))})),a.tagRelateNumMap=Object.freeze(s),a.operationList=Object.values(u),a.tagCheckInfoMap=Object.freeze(m)}))]).then((function(){a.isLoading=!1}))})),p(p({},(0,r.toRefs)(a)),{},{scrollRef:i,renderList:v,handleSearch:function(e){a.search=(0,l.default)(e)},handleNew:function(){a.isShowCreate=!0},handleTagCheckChange:function(e,t){var i=Object.assign({},a.tagCheckInfoMap);i[t]&&i[t].checked?i[t]={checked:!1}:i[t]={checked:!0},window.changeAlert=!0,a.tagCheckInfoMap=Object.freeze(i)},handleTagNew:function(e){i.value&&i.value.scrollTo(0,0),e.isNew=!0,a.newTagList.unshift(e),window.changeAlert=!0},handleClearSearch:function(){a.search=""},submit:function(){var i=a.operationList.reduce((function(e,t){return e[t]=!0,e}),{}),s=[...a.operationList];(0,n.default)(s,(function(e){return u[e]}));var l=[];return Object.keys(u).forEach((function(e){i[e]||l.push(Number(e))})),Object.keys(h).forEach((function(e){a.tagCheckInfoMap[e].indeterminate||a.tagCheckInfoMap[e].checked||l.push(Number(e))})),c.default.batchUpdateTag({addTagIdList:s,deleteTagIdList:l,idList:e.templateList.map((function(e){return e.id}))}).then((function(){f.messageSuccess("编辑标签成功"),t.emit("on-change")}))}})}};t.Z=h},30021:function(e,t,a){"use strict";Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var i=a(41980),s="task_tag_panel_toggle",n={data(){var e=localStorage.getItem(s);return{isOpen:e=!e||JSON.parse(e),styles:{}}},mounted(){var e=(0,i.getOffset)(this.$refs.handler).top;this.styles={height:"calc(100vh  - ".concat(e,"px)")}},methods:{handleToggle(){this.isOpen=!this.isOpen,localStorage.setItem(s,JSON.stringify(this.isOpen))}}};t.Z=n},55276:function(e,t,a){"use strict";var i=a(22696);Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var s=i(a(56318));a(57024),a(87033),a(35948),a(94522),a(23232),a(80433),a(9042),a(85604);var n=i(a(22910)),l=i(a(60299)),r={name:"RenderTagTabItem",components:{TabItem:i(a(90010)).default},props:{active:{type:[String,Number],default:""}},data:()=>({isLoading:!1,classesId:1,tagId:0,list:[{},{},{}],countMap:{},isNumberLoading:!1}),computed:{totalCount(){return this.countMap.total||0},unclassifiedCount(){return this.countMap.unclassified||0},needUpdateCount(){return this.countMap.needUpdate||0}},created(){this.init()},mounted(){this.parseDefaultValueFromURL()},methods:{fetchTagList:()=>l.default.fetchWholeList(),fetchTagTemplateNum:()=>n.default.fetchTagCount(),init(){var e=this;this.isLoading=!0,Promise.all([this.fetchTagList(),this.fetchTagTemplateNum()]).then((function(t){var a=(0,s.default)(t,2),i=a[0],n=a[1];e.countMap=Object.freeze(n);var l=[];i.forEach((function(e){e.relatedTaskTemplateNum=n.tagCount[e.id]||0,l.push(e)})),e.list=Object.freeze(l),e.$emit("on-init",l)})).finally((function(){e.isLoading=!1}))},parseDefaultValueFromURL(){var e=1;if(this.$route.query.type)return e=~~this.$route.query.type||1,void this.handleClassesSelect(e);if(this.$route.query.panelTag){var t=parseInt(this.$route.query.panelTag,10);t>0&&(this.classesId=0,this.handleSelect(t))}},handleClassesSelect(e){this.classesId!==e&&(this.classesId=e,this.tagId=0,this.$emit("on-change",{type:this.classesId,panelTag:""}))},handleSelect(e){e!==this.tagId&&(this.tagId=e,this.classesId=0,this.$emit("on-change",{type:"",panelTag:this.tagId}))},handleEdit(e){var t=this;l.default.updateTag(e).then((function(){t.messageSuccess("标签名更新成功"),t.fetchTagList()}))}}};t.Z=r},88996:function(e,t,a){"use strict";var i=a(22696);Object.defineProperty(t,"X",{value:!0}),t.Z=void 0,a(57024),a(45974),a(87033),a(70969),a(58794);var s=i(a(93435)),n=i(a(18306)),l=a(61681),r={name:"",props:{icon:{type:String,default:"tag"},loading:{type:Boolean,default:!0},count:{type:Number,default:0},name:{type:String,default:""},description:String,value:{type:Number},tooltipsDisabled:{type:Boolean,default:!1},id:{type:Number},canEdit:{type:Boolean,default:!1},tagList:{type:Array,default:function(){return[]}}},data(){return{displayName:this.name,isEditable:!1,error:""}},computed:{checkRenameList(){var e=this;return this.tagList.filter((function(t){return t.name!==e.name}))},errorTipsConfig(){return{placement:"top-left",content:{1:"标签名不可为空",2:"标签名已存在，请重新输入",3:l.tagNameRule.message}[this.error],width:3===this.error?200:""}}},created(){this.sefId="tag_".concat((0,n.default)(1,1e3),"_").concat(Date.now())},mounted(){var e=this;document.body.addEventListener("click",this.hideEdit),this.$once("hook:beforeDestroy",(function(){document.body.removeEventListener("click",e.hideEdit)}))},methods:{handleSelect(){this.$emit("on-select",this.id,this.name)},triggerChange(){var e=this;this.displayName!==this.name?""!==this.displayName?(0,s.default)(this.checkRenameList,(function(t){return t.name===e.displayName}))?this.error=2:l.tagNameRule.validator(this.displayName)?(this.error="",this.isEditable=!1,this.$emit("on-edit",{id:this.id,name:this.displayName})):this.error=3:this.error=1:this.isEditable=!1},handleEdit(){var e=this;document.body.click(),this.isEditable=!0,this.$nextTick((function(){e.$refs.input.focus()}))},handleChange(e){this.displayName=e.trim()},handleBlur(){this.triggerChange()},handleEnter(e,t){this.isEditable&&"Enter"===t.key&&13===t.keyCode&&this.triggerChange()},hideEdit(){this.isEditable&&(this.error||(this.isEditable=!1))}}};t.Z=r},98412:function(e,t,a){"use strict";a(45974),a(9042),a(43364);var i=a(22696);Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var s=i(a(33610));a(71959),a(87033),a(63762),a(7170),a(35927),a(6919);var n=i(a(60299)),l=i(a(22910)),r=i(a(28975)),o=i(a(49135)),c=i(a(46117)),d=a(46790),u=i(a(53823)),p=i(a(80712)),h=i(a(27452)),m=i(a(47009)),f=i(a(2645)),v=i(a(93962)),g=i(a(93738)),b=i(a(49466)),_=i(a(5071));function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){(0,s.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var C="task_list_columns",w={name:"TaskManageList",components:{JbEditTag:u.default,ListActionLayout:p.default,RenderList:h.default,ListOperationExtend:m.default,JbSearchSelect:f.default,JbPopoverConfirm:v.default,Layout:g.default,TagPanel:b.default,BatchEditTag:_.default},data:()=>({isShowBatchEdit:!1,currentUser:{},searchValue:[],listSelect:[],backupInfo:{importJob:[],exportJob:[]},selectedTableColumn:[],tableSize:"small"}),computed:{isSkeletonLoading(){return this.$refs.list.isLoading},isExportJobDisable(){if(this.backupInfo.exportJob.length>0)return!1;for(var e=0;e<this.listSelect.length;e++){if(!this.listSelect[e].canView)return!0}return this.listSelect.length<1},isBatchEditTagDisabled(){for(var e=0;e<this.listSelect.length;e++){if(!this.listSelect[e].canEdit)return!0}return this.listSelect.length<1},allRenderColumnMap(){return this.selectedTableColumn.reduce((function(e,t){return e[t.id]=!0,e}),{})}},created(){this.searchParams={},this.searchClass={},this.listDataSource=l.default.taskList,this.searchData=[{name:"ID",id:"templateId",description:"将覆盖其它条件",validate:(e,t)=>!!(e||[]).every((function(e){return/^(\d*)$/.test(e.name)}))||"ID只支持数字"},{name:"作业模板名称",id:"name",default:!0},{name:"场景标签",id:"tags",remoteMethod:n.default.fetchTagOfSearch,remoteExecuteImmediate:!0},{name:"更新人",id:"lastModifyUser",remoteMethod:c.default.fetchUsersOfSearch,inputInclude:!0},{name:"创建人",id:"creator",remoteMethod:c.default.fetchUsersOfSearch,inputInclude:!0}],this.tableColumn=[{id:"id",label:"ID"},{id:"name",label:"作业模板名称",disabled:!0},{id:"tags",label:"场景标签"},{id:"statusText",label:"状态"},{id:"creator",label:"创建人"},{id:"createTime",label:"创建时间"},{id:"lastModifyUser",label:"更新人"},{id:"lastModifyTime",label:"更新时间"}];var e=d.listColumnsCache.getItem(C);e?(this.selectedTableColumn=Object.freeze(e.columns),this.tableSize=e.size):this.selectedTableColumn=Object.freeze([{id:"name"},{id:"tags"},{id:"lastModifyUser"},{id:"lastModifyTime"}])},mounted(){this.fetchUserInfo(),this.fetchBackup()},methods:{fetchData(){var e=k({},this.searchParams);this.searchClass.type&&(e.type=this.searchClass.type),this.searchClass.panelTag&&(e.panelTag=this.searchClass.panelTag),this.$refs.list.$emit("onFetch",e)},fetchUserInfo(){var e=this;o.default.fetchUserInfo().then((function(t){e.currentUser=t}))},fetchBackup(){var e=this;r.default.fetchInfo().then((function(t){e.backupInfo=Object.freeze(t)}))},handleSettingChange(e){var t=e.fields,a=e.size;this.selectedTableColumn=Object.freeze(t),this.tableSize=a,d.listColumnsCache.setItem(C,{columns:t,size:a})},handleTagPlanChange(e){this.searchClass=e,this.fetchData()},handleSearch(e){this.searchParams=e,this.fetchData()},handleCreate(){this.$router.push({name:"templateCreate",query:{from:"list"}})},handleImport(){this.$router.push({name:"taskImport"})},handleExport(){var e=this,t=function(){e.$router.push({name:"taskExport"}),d.taskExport.setItem("ids",e.listSelect.map((function(e){return e.id})))};this.backupInfo.exportJob.length>0&&this.listSelect.length>0?this.$bkInfo({title:"上一次任务还未完成",subTitle:"您上一次的任务还在后台运行中，请先等待完成后再发起新的任务。",okText:"查看",cancelText:"返回",confirmFn:t}):t()},handleBatchEditTag(){this.isShowBatchEdit=!0},handleBatchEditChange(){this.fetchData(),this.$refs.tagPanelRef.init()},handleMyTask(){var e=this.currentUser.username,t={name:"创建人",id:"creator",values:[{id:e,name:e}]};this.searchParams=k(k({},this.searchParams),{},{creator:e}),this.searchValue=[t],this.fetchData()},handleUpdateTask(e,t){var a=this,i=e.id,s=e.name,n=e.description;return l.default.taskUpdateBasic({id:i,name:s,description:n,tags:t.tags}).then((function(){a.$refs.tagPanelRef.init()}))},handleSelection(e){this.listSelect=Object.freeze(e)},handleEdit(e){this.$router.push({name:"templateEdit",params:{id:e},query:{from:"list"}})},handleClone(e){this.$router.push({name:"templateClone",params:{id:e},query:{from:"list"}})},handleDelete(e){var t=this;return l.default.taskDelete({id:e}).then((function(){return t.fetchData(),t.messageSuccess("删除模板成功"),t.$refs.tagPanelRef.init(),!0}))},handleCollection(e){var t=this;(e.favored?l.default.taskDeleteFavorite:l.default.taskUpdateFavorite)({id:e.id}).then((function(){e.toggleFavored(),t.messageSuccess(e.favored?"收藏成功":"取消收藏成功")}))}}};t.Z=w},17252:function(){},96737:function(){},3691:function(){},32547:function(){},27502:function(){},5071:function(e,t,a){"use strict";a.r(t),a.d(t,{__esModule:function(){return s.X},default:function(){return r}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading }"}],staticClass:"task-manage-batch-edit-tag"},[a("div",{staticStyle:{"margin-bottom":"8px"}},[e._v("\n        "+e._s("范围")+"："+e._s("共")),a("span",{staticClass:"strong number"},[e._v(e._s(e.templateNums))]),e._v(e._s("个作业")+"\n    ")]),e._v(" "),a("jb-form",{attrs:{"form-type":"vertical"}},[a("jb-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:"标签",required:""}},[a("div",{staticClass:"tag-panel"},[a("bk-input",{staticClass:"tag-search",attrs:{spellcheck:!1,"left-icon":"bk-icon icon-search",value:e.search},on:{change:e.handleSearch}}),e._v(" "),a("div",{staticClass:"wrapper",staticStyle:{height:"210px"}},[e.renderList.length>0?a("scroll-faker",{ref:"scrollRef"},[a("bk-checkbox-group",{staticClass:"tag-list",model:{value:e.operationList,callback:function(t){e.operationList=t},expression:"operationList"}},e._l(e.renderList,(function(t){return a("bk-checkbox",e._b({key:t.id,staticClass:"tag-item",attrs:{value:t.id},on:{change:function(a){return e.handleTagCheckChange(a,t.id)}}},"bk-checkbox",e.tagCheckInfoMap[t.id],!1),[e._v("\n                                "+e._s(t.name)+"\n                                "),e.tagCheckInfoMap[t.id]?[e.tagCheckInfoMap[t.id].checked?a("span",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.right",value:"勾选范围里，全部作业使用",expression:"'勾选范围里，全部作业使用'",modifiers:{right:!0}}],staticClass:"relate-all"},[e._v("\n                                        All\n                                    ")]):e._e(),e._v(" "),e.tagCheckInfoMap[t.id].indeterminate?a("span",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.right",value:"勾选范围里，有 "+e.tagRelateNumMap[t.id]+" 个作业使用",expression:"`${'勾选范围里，有'} ${tagRelateNumMap[tagItem.id]} ${'个作业使用'}`",modifiers:{right:!0}}],staticClass:"relate-nums"},[e._v("\n                                        "+e._s(e.tagRelateNumMap[t.id])+"/"+e._s(e.templateNums)+"\n                                    ")]):e._e()]:e._e(),e._v(" "),t.isNew?a("span",{staticClass:"new-tag-flag"},[e._v("\n                                    new\n                                ")]):e._e()],2)})),1)],1):e.search?a("Empty",{staticStyle:{"margin-top":"20px"},attrs:{type:"search"}},[a("span",[e._v(e._s("搜索结果为空")+"，")]),e._v(" "),a("bk-button",{attrs:{text:""},on:{click:e.handleClearSearch}},[e._v(e._s("清空搜索"))])],1):e._e()],1),e._v(" "),a("auth-component",{attrs:{auth:"tag/create"}},[a("div",{staticClass:"tag-create",on:{click:e.handleNew}},[a("bk-icon",{staticStyle:{"margin-right":"8px","font-size":"16px"},attrs:{type:"plus-circle"}}),e._v(" "),a("span",[e._v(e._s("新建标签"))])],1),e._v(" "),a("div",{staticClass:"tag-create",attrs:{slot:"forbid"},slot:"forbid"},[a("bk-icon",{staticStyle:{"margin-right":"8px","font-size":"16px"},attrs:{type:"plus-circle"}}),e._v(" "),a("span",[e._v(e._s("新建标签"))])],1)])],1)])],1),e._v(" "),a("lower-component",{attrs:{level:"custom",custom:e.isShowCreate}},[a("operation-tag",{on:{"on-change":e.handleTagNew},model:{value:e.isShowCreate,callback:function(t){e.isShowCreate=t},expression:"isShowCreate"}})],1)],1)};i._withStripped=!0;var s=a(95386),n=s.Z,l=(a(58236),(0,a(35471).Z)(n,i,[],!1,null,null,null));l.options.__file="src/views/task-manage/list/components/batch-edit-tag.vue";var r=l.exports},93738:function(e,t,a){"use strict";a.r(t),a.d(t,{__esModule:function(){return s.X},default:function(){return r}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{ref:"handler",staticClass:"task-layout"},[a("div",{class:{"layout-left":!0,expended:e.isOpen}},[a("scroll-faker",{style:e.styles},[a("div",[e._t("tag")],2)])],1),e._v(" "),a("div",{staticClass:"layout-right"},[a("div",{staticClass:"toggle-button",on:{click:e.handleToggle}},[a("Icon",{staticClass:"toggle-arrow",class:{open:e.isOpen},attrs:{type:"down-small"}})],1),e._v(" "),e._t("default")],2)])};i._withStripped=!0;var s=a(30021),n=s.Z,l=(a(2166),(0,a(35471).Z)(n,i,[],!1,null,null,null));l.options.__file="src/views/task-manage/list/components/layout.vue";var r=l.exports},49466:function(e,t,a){"use strict";a.r(t),a.d(t,{__esModule:function(){return s.X},default:function(){return r}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading }"}],staticClass:"template-list-tag-panel"},[a("tab-item",{attrs:{name:"全部作业",id:1,value:e.classesId,icon:"business-manage",count:e.totalCount,"tooltips-disabled":!0},on:{"on-select":e.handleClassesSelect}}),e._v(" "),a("tab-item",{attrs:{name:"未分类",id:2,value:e.classesId,icon:"unclassified",count:e.unclassifiedCount,"tooltips-disabled":!0},on:{"on-select":e.handleClassesSelect}}),e._v(" "),a("tab-item",{attrs:{name:"待更新",id:3,value:e.classesId,icon:"update",count:e.needUpdateCount,"tooltips-disabled":!0},on:{"on-select":e.handleClassesSelect}}),e._v(" "),a("div",{staticClass:"line"}),e._v(" "),e._l(e.list,(function(t){return[t.relatedTaskTemplateNum>0?a("tab-item",{key:t.id,attrs:{id:t.id,count:t.relatedTaskTemplateNum,name:t.name,description:t.description,value:e.tagId,"can-edit":!0,"tag-list":e.list},on:{"on-select":e.handleSelect,"on-edit":e.handleEdit}}):e._e()]}))],2)};i._withStripped=!0;var s=a(55276),n=s.Z,l=(a(75432),(0,a(35471).Z)(n,i,[],!1,null,"56307de0",null));l.options.__file="src/views/task-manage/list/components/tag-panel/index.vue";var r=l.exports},90010:function(e,t,a){"use strict";a.r(t),a.d(t,{__esModule:function(){return s.X},default:function(){return r}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"task-list-tag-edit",class:{active:e.value===e.id,display:!e.canEdit,edit:e.canEdit,"edit-error":!!e.error},on:{click:function(e){e.stopPropagation()}}},[a("Icon",{staticClass:"tag-flag",attrs:{type:e.icon}}),e._v(" "),e.isEditable?[a("bk-input",{ref:"input",attrs:{placeholder:"请输入标签名...",value:e.displayName},on:{change:e.handleChange,blur:e.handleBlur,keyup:e.handleEnter}}),e._v(" "),e.error?a("div",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:e.errorTipsConfig,expression:"errorTipsConfig"}],staticClass:"input-edit-info"},[a("Icon",{attrs:{type:"info"}})],1):e._e()]:[a("div",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:{allowHtml:!0,width:240,distance:15,trigger:"mouseenter",theme:"light",content:"#"+e.sefId,placement:"right-start",boundary:"window",disabled:e.tooltipsDisabled},expression:"{\n                allowHtml: true,\n                width: 240,\n                distance: 15,\n                trigger: 'mouseenter',\n                theme: 'light',\n                content: `#${sefId}`,\n                placement: 'right-start',\n                boundary: 'window',\n                disabled: tooltipsDisabled,\n            }"}],staticClass:"tag-name",on:{click:e.handleSelect}},[a("div",{directives:[{name:"bk-overflow-tips",rawName:"v-bk-overflow-tips"}],staticClass:"name-text"},[e._v("\n                "+e._s(e.displayName)+"\n            ")])]),e._v(" "),a("div",{staticClass:"tag-num-box"},[a("span",{staticClass:"tag-num"},[e._v(e._s(e.count))])]),e._v(" "),e.canEdit?a("auth-component",{attrs:{auth:"tag/edit","resource-id":e.id}},[a("div",{staticClass:"edit-action",on:{click:e.handleEdit}},[a("Icon",{attrs:{type:"edit-2"}})],1),e._v(" "),a("div",{staticClass:"edit-action",attrs:{slot:"forbid"},slot:"forbid"},[a("Icon",{attrs:{type:"edit-2"}})],1)]):e._e()],e._v(" "),a("div",{staticStyle:{display:"none"}},[a("table",{staticStyle:{"font-size":"12px","line-height":"24px",color:"#63656e"},attrs:{id:e.sefId}},[a("tr",[a("td",{staticStyle:{color:"#979ba5","text-align":"right","white-space":"nowrap","vertical-align":"top"}},[e._v("标签名称：")]),e._v(" "),a("td",{staticStyle:{"word-break":"break-all","vertical-align":"top"}},[e._v(e._s(e.displayName))])]),e._v(" "),a("tr",[a("td",{staticStyle:{color:"#979ba5","text-align":"right","white-space":"nowrap","vertical-align":"top"}},[e._v("标签描述：")]),e._v(" "),a("td",{staticStyle:{"word-break":"break-all","vertical-align":"top"}},[e._v(e._s(e.description||"--"))])])])])],2)};i._withStripped=!0;var s=a(88996),n=s.Z,l=(a(21287),(0,a(35471).Z)(n,i,[],!1,null,null,null));l.options.__file="src/views/task-manage/list/components/tag-panel/tab-item.vue";var r=l.exports},87824:function(e,t,a){"use strict";a.r(t),a.d(t,{__esModule:function(){return s.X},default:function(){return r}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Layout",{staticClass:"template-list-page",scopedSlots:e._u([{key:"tag",fn:function(){return[a("tag-panel",{ref:"tagPanelRef",on:{"on-change":e.handleTagPlanChange}})]},proxy:!0}])},[e._v(" "),a("list-action-layout",{scopedSlots:e._u([{key:"right",fn:function(){return[a("jb-search-select",{ref:"search",staticStyle:{width:"420px"},attrs:{"append-value":e.searchValue,data:e.searchData,placeholder:"输入 作业模板名、标签名 或 更新人 进行搜索..."},on:{"on-change":e.handleSearch}}),e._v(" "),a("bk-button",{on:{click:e.handleMyTask}},[e._v(e._s("我的作业"))])]},proxy:!0}])},[a("auth-button",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"templateCreate"},expression:"{ type: 'button', value: 'templateCreate' }"}],staticClass:"w120 mr10",attrs:{theme:"primary",auth:"job_template/create"},on:{click:e.handleCreate}},[e._v("\n            "+e._s("新建")+"\n        ")]),e._v(" "),a("bk-badge",{staticClass:"mr10",attrs:{theme:"#3a84ff",visible:e.backupInfo.importJob.length>0,val:e.backupInfo.importJob.length}},[a("span",{attrs:{"tippy-tips":e.backupInfo.importJob.length>0?"有一项导入任务正在进行中":""}},[a("auth-button",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"templateImport"},expression:"{ type: 'button', value: 'templateImport' }"}],attrs:{auth:"job_template/create"},on:{click:e.handleImport}},[e._v("\n                    "+e._s("导入")+"\n                ")])],1)]),e._v(" "),a("bk-badge",{staticClass:"mr10",attrs:{theme:"#3a84ff",visible:e.backupInfo.exportJob.length>0,val:e.backupInfo.exportJob.length}},[a("span",{attrs:{"tippy-tips":e.backupInfo.exportJob.length>0?"有一项导出任务正在进行中":""}},[a("bk-button",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"templateExport"},expression:"{ type: 'button', value: 'templateExport' }"}],on:{click:e.handleExport}},[e._v("\n                    "+e._s("导出")+"\n                ")])],1)]),e._v(" "),a("bk-button",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"templateTagEdit"},expression:"{ type: 'button', value: 'templateTagEdit' }"}],on:{click:e.handleBatchEditTag}},[e._v("\n            "+e._s("编辑标签")+"\n        ")])],1),e._v(" "),a("div",{staticClass:"task-list-wraper"},[a("render-list",{directives:[{name:"test",rawName:"v-test",value:{type:"list",value:"template"},expression:"{ type: 'list', value: 'template' }"}],ref:"list",attrs:{"data-source":e.listDataSource,selectable:"",size:e.tableSize,"search-control":function(){return e.$refs.search}},on:{"on-selection-change":e.handleSelection}},[e.allRenderColumnMap.id?a("bk-table-column",{key:"id",attrs:{label:"ID",width:"120",prop:"id",align:"left"}}):e._e(),e._v(" "),e.allRenderColumnMap.name?a("bk-table-column",{key:"name",attrs:{"class-name":"task-name-column",label:"作业模板名称",prop:"name","min-width":"300",align:"left"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("div",{staticClass:"task-name-box"},[a("Icon",{staticClass:"task-collection",class:i.favored?"favored":"unfavored",attrs:{type:"collection"},on:{click:function(t){return e.handleCollection(i)}}}),e._v(" "),a("auth-router-link",{directives:[{name:"bk-overflow-tips",rawName:"v-bk-overflow-tips"}],staticClass:"task-name-text",attrs:{permission:i.canView,auth:"job_template/view","resource-id":i.id,to:{name:"templateDetail",params:{id:4}}}},[e._v("\n                            {'row.name' || row.name }}\n                        ")]),e._v(" "),a("auth-router-link",{attrs:{permission:i.canView,auth:"job_template/view","resource-id":i.id,to:{name:"templateDetail",params:{id:4},query:{mode:"scriptUpdate"}}}},[e._v("\n                            123123\n                            "),a("span",{domProps:{innerHTML:e._s(i.scriptStatusHtml)}})])],1)]}}],null,!1,3498184813)}):e._e(),e._v(" "),e.allRenderColumnMap.tags?a("bk-table-column",{key:"tags",attrs:{label:"场景标签",prop:"tags",width:"200",align:"left","class-name":"edit-tag-column"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("auth-component",{attrs:{permission:i.canEdit,auth:"job_template/edit","resource-id":i.id}},[a("jb-edit-tag",{key:i.id,attrs:{field:"tags",value:i.tags,shortcurt:"","remote-hander":function(t){return e.handleUpdateTask(i,t)}}}),e._v(" "),a("div",{attrs:{slot:"forbid"},slot:"forbid"},[e._v(e._s(i.tagText))])],1)]}}],null,!1,1512189156)}):e._e(),e._v(" "),e.allRenderColumnMap.statusText?a("bk-table-column",{key:"statusText",attrs:{label:"状态",width:"100",prop:"statusText",align:"left"}}):e._e(),e._v(" "),e.allRenderColumnMap.creator?a("bk-table-column",{key:"creator",attrs:{label:"创建人",width:"120",prop:"creator",align:"left"}}):e._e(),e._v(" "),e.allRenderColumnMap.createTime?a("bk-table-column",{key:"createTime",attrs:{label:"创建时间",prop:"createTime",width:"180",align:"left"}}):e._e(),e._v(" "),e.allRenderColumnMap.lastModifyUser?a("bk-table-column",{key:"lastModifyUser",attrs:{label:"更新人",width:"160",prop:"lastModifyUser",align:"left"}}):e._e(),e._v(" "),e.allRenderColumnMap.lastModifyTime?a("bk-table-column",{key:"lastModifyTime",attrs:{label:"更新时间",width:"180",prop:"lastModifyTime",align:"left"}}):e._e(),e._v(" "),a("bk-table-column",{key:"action",attrs:{resizable:!1,fixed:"right",label:"操作",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[a("router-link",{directives:[{name:"test",rawName:"v-test",value:{type:"link",value:"planDetail"},expression:"{ type: 'link', value: 'planDetail' }"}],staticClass:"mr10",attrs:{to:{name:"viewPlan",params:{templateid:4}}}},[e._v("\n                        "+e._s("执行方案")+"\n                    ")]),e._v(" "),a("router-link",{directives:[{name:"test",rawName:"v-test",value:{type:"link",value:"debugTemplate"},expression:"{ type: 'link', value: 'debugTemplate' }"}],staticClass:"mr10",attrs:{to:{name:"debugPlan",params:{id:4},query:{from:"taskList"}}}},[e._v("\n                        "+e._s("调试")+"\n                    ")]),e._v(" "),a("list-operation-extend",[a("auth-component",{attrs:{permission:i.canEdit,auth:"job_template/edit","resource-id":i.id}},[a("div",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"editTemplate"},expression:"{ type: 'button', value: 'editTemplate' }"}],staticClass:"action-item",on:{click:function(t){return e.handleEdit(i.id)}}},[e._v("\n                                "+e._s("编辑")+"\n                            ")]),e._v(" "),a("div",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"editTemplate"},expression:"{ type: 'button', value: 'editTemplate' }"}],staticClass:"action-item",attrs:{slot:"forbid"},slot:"forbid"},[e._v("\n                                "+e._s("编辑")+"\n                            ")])]),e._v(" "),a("auth-component",{attrs:{permission:i.canCreate&&i.canView,auth:"job_template/clone","resource-id":i.id}},[a("div",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"cloneTemplate"},expression:"{ type: 'button', value: 'cloneTemplate' }"}],staticClass:"action-item",on:{click:function(t){return e.handleClone(i.id)}}},[e._v("\n                                "+e._s("克隆")+"\n                            ")]),e._v(" "),a("div",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"cloneTemplate"},expression:"{ type: 'button', value: 'cloneTemplate' }"}],staticClass:"action-item",attrs:{slot:"forbid"},slot:"forbid"},[e._v("\n                                "+e._s("克隆")+"\n                            ")])]),e._v(" "),a("jb-popover-confirm",{attrs:{title:"确定删除该作业？",content:"注意！模板下关联的所有执行方案也将被清除","confirm-handler":function(){return e.handleDelete(i.id)}}},[a("auth-component",{attrs:{permission:i.canDelete,auth:"job_template/delete","resource-id":i.id}},[a("div",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"deleteTemplate"},expression:"{ type: 'button', value: 'deleteTemplate' }"}],staticClass:"action-item"},[e._v("\n                                    "+e._s("删除")+"\n                                ")]),e._v(" "),a("div",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"deleteTemplate"},expression:"{ type: 'button', value: 'deleteTemplate' }"}],staticClass:"action-item",attrs:{slot:"forbid"},slot:"forbid"},[e._v("\n                                    "+e._s("删除")+"\n                                ")])])],1)],1)]}}])}),e._v(" "),a("bk-table-column",{attrs:{type:"setting"}},[a("bk-table-setting-content",{attrs:{fields:e.tableColumn,selected:e.selectedTableColumn,size:e.tableSize},on:{"setting-change":e.handleSettingChange}})],1)],1)],1),e._v(" "),a("jb-dialog",{attrs:{title:"编辑标签","header-position":"left","ok-text":"确定",width:480},model:{value:e.isShowBatchEdit,callback:function(t){e.isShowBatchEdit=t},expression:"isShowBatchEdit"}},[e.isShowBatchEdit?a("batch-edit-tag",{attrs:{"template-list":e.listSelect},on:{"on-change":e.handleBatchEditChange}}):e._e()],1)],1)};i._withStripped=!0;var s=a(98412),n=s.Z,l=(a(19637),(0,a(35471).Z)(n,i,[],!1,null,null,null));l.options.__file="src/views/task-manage/list/index.vue";var r=l.exports},58236:function(e,t,a){var i=a(17252);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,a(13570).Z)("4d2f5a15",i,!1,{})},2166:function(e,t,a){var i=a(96737);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,a(13570).Z)("6c57af55",i,!1,{})},75432:function(e,t,a){var i=a(3691);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,a(13570).Z)("39f101fb",i,!1,{})},21287:function(e,t,a){var i=a(32547);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,a(13570).Z)("934d9fc0",i,!1,{})},19637:function(e,t,a){var i=a(27502);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.id,i,""]]),i.locals&&(e.exports=i.locals);(0,a(13570).Z)("b2b4f382",i,!1,{})}}]);