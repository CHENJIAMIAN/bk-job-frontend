(self.webpackChunkjob=self.webpackChunkjob||[]).push([[7180],{24262:function(e,t,a){"use strict";var n=a(70534);Object.defineProperty(t,"X",{value:!0}),t.Z=void 0,a(41336),a(91981),a(63898);var i=n(a(99509)),s=n(a(6525)),r=n(a(42300)),l=n(a(7861)),o={components:{RenderStrategy:s.default,InternalVariable:r.default,JbUserSelector:l.default},props:{data:{type:Object,default:function(){return{}}}},data:()=>({isShowPreviewSend:!1,isShowVariable:!1,isLoading:!1,reciverList:[{},{},{}],formData:{code:"",content:"",lastModifier:"",lastModifyTime:"",messageTypeCode:"",messageTypeLabel:"",name:"",title:""}}),watch:{data(e){e&&(this.formData=e)}},created(){this.formData=this.data||{},this.rules={content:[{required:!0,message:"模板内容必填",trigger:"blur"}]},"mail"===this.formData.code&&(this.rules.title=[{required:!0,message:"邮件主题必填",trigger:"blur"}])},methods:{toggleShowVariable(e){this.isShowVariable=e},handleChange(e){this.$emit("on-change",e)},handleApprovalUserChange(e,t){this.reciverList=e},handleSend(){var e=this,t=this.formData,a={channelCode:t.code,messageTypeCode:t.messageTypeCode,content:t.content,title:t.title,receiverStr:this.reciverList.join(",")};this.isLoading=!0,i.default.sendNotifyPreview(a).then((function(t){e.messageSuccess("发送成功")})).finally((function(){e.isLoading=!1}))}}};t.Z=o},43272:function(e,t,a){"use strict";Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var n=a(18289),i={props:{handleClose:{type:Function}},data:()=>({variableType:"general"}),computed:{renderList(){return n.InternalVariables[this.variableType]}},methods:{handleTabChange(e){this.variableType=e}}};t.Z=i},17815:function(e,t,a){"use strict";Object.defineProperty(t,"X",{value:!0}),t.Z=void 0,a(41336);var n={props:{channleList:{type:Array,default:function(){return[]}},channelCode:{type:Array,default:function(){return[]}},handleToggleChannel:{type:Function},handleEditTemplate:{type:Function}},computed:{templateList(){return this.channleList.length&&(this.channleList[0].templateInfoList||[])}},methods:{getConfigStatus:(e,t)=>e.some((function(e){return e.code===t&&e.isConfiged}))}};t.Z=n},14586:function(e,t,a){"use strict";var n=a(70534);Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var i=a(11986),s=n(a(7211)),r=n(a(63660)),l=n(a(6594)),o=n(a(6341)),c=n(a(74277)),u={name:"",components:{NotifyManage:s.default,StorageStrategy:r.default,AccountRule:l.default,PlatformInfo:o.default,FileUpload:c.default},data:()=>({page:"notify"}),computed:{isSkeletonLoading(){return this.$refs.page.isLoading},pageCom(){return{notify:s.default,strategy:r.default,account:l.default,platform:o.default,fileUpload:c.default}[this.page]}},methods:{handleTabChange(e){var t=this;return(0,i.leaveConfirm)().then((function(){t.page=e}))}}};t.Z=u},74123:function(e,t,a){"use strict";var n=a(70534);Object.defineProperty(t,"X",{value:!0}),t.Z=void 0,a(41336),a(91981),a(63898),a(79951),a(45680),a(77702);var i=n(a(25190)),s=n(a(99509)),r={name:"",components:{SmartAction:n(a(72563)).default},data:()=>({isLoading:!1,isSubmitting:!1,currentRules:[{},{},{},{}]}),created(){this.fetchData(),this.defaultRules=[],this.selfLastRules=[]},methods:{fetchData(){var e=this;this.isLoading=!0,s.default.fetchAllNameRule().then((function(t){var a=t.currentRules,n=t.defaultRules;e.currentRules=a,e.selfLastRules=(0,i.default)(a),e.defaultRules=n})).finally((function(){e.isLoading=!1}))},handleChange(e,t,a){window.changeAlert=!0,this.currentRules[a][e]=t,this.currentRules=[...this.currentRules]},handleReset(e){var t=(0,i.default)(this.defaultRules[e]);this.currentRules.splice(e,1,t)},handleSave(){var e=this;this.isSubmitting=!0,s.default.updateNameRules({rules:this.currentRules}).then((function(){window.changeAlert=!1,e.messageSuccess("账号命名规则保存成功")})).finally((function(){e.isSubmitting=!1}))},handleResetAll(){this.currentRules=(0,i.default)(this.selfLastRules)}}};t.Z=r},89922:function(e,t,a){"use strict";a(87147),a(13118),a(20767);var n=a(70534);Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var i=n(a(68203));a(41336),a(59241),a(32106),a(70616),a(91981),a(63898);var s=n(a(99509));function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var o={data:()=>({isLoading:!0,isSubmiting:!1,info:{amount:0,unit:"",restrictMode:-1,suffixList:[{},{},{}]},suffixError:""}),created(){this.fetchJobConfig()},methods:{fetchJobConfig(){var e=this;this.isLoading=!0,s.default.fetchFileUpload().then((function(t){e.info=t,(!t.suffixList||t.suffixList.length<1)&&(e.info=l(l({},e.info),{},{restrictMode:-1,suffixList:[{},{},{}]}))})).finally((function(){e.isLoading=!1}))},handleRestSuffixError(){this.suffixError=""},handleSubmit(){var e=this,t=l({},this.info);this.suffixError="",-1===t.restrictMode?t.suffixList=[]:this.suffixError=function(e){if(e.length<1)return"不允许为空";var t=[],a=[],n=[],i=[];e.forEach((function(e){if(e.length>25)n.push(e);else{var s=e.toLowerCase();/^\.[a-z]+(.[a-z]+)*$/.test(s)?(i[s]?a.push(i[s]):i[s]=[],i[s].push(e)):t.push(s)}}));var s="";return n.length>0&&(s+="".concat(n.join(","),";")),t.length>0&&(s+="".concat(t.join(","),";")),a.length>0&&(s+=a.reduce((function(e,t){return e.push(t.join(",")),e}),[]).join("；")),s?".开头，后面跟上不超过24个英文字符，中间不允许出现空格：".concat(s):""}(t.suffixList),this.suffixError||(this.isSubmiting=!0,s.default.saveFileUpload(t).then((function(){e.messageSuccess("保存成功")})).finally((function(){e.isSubmiting=!1})))}}};t.Z=o},66900:function(e,t,a){"use strict";var n=a(70534);Object.defineProperty(t,"X",{value:!0}),t.Z=void 0,a(41336),a(91981),a(63898),a(70616),a(79951),a(45680),a(14309),a(68591),a(77702);var i=n(a(25190)),s=n(a(99509)),r=n(a(52056)),l=n(a(98656)),o=n(a(6e3)),c={name:"NotifyManage",components:{JbUserSelector:n(a(7861)).default,NotifyChannel:r.default,JbSideslider:l.default,editOfTemplate:o.default},data:()=>({isLoading:!0,isSubmiting:!1,isSaveLoading:!1,showTemplateEdit:!1,formData:{channelCode:[],users:[]},templateDetail:{},currentTemplate:{},currentDefaultTemplate:{},channleList:[{},{},{}],channelCode:[],users:[]}),created(){this.backlistConfig={width:202,placement:"top",content:"「通讯黑名单」的人员将不会接收到任何来自作业平台的消息"},this.fetchAllChannelConfig(),this.fetchAllUserBlacklist(),this.channelCodeMemo=[],this.usersMemo=[]},methods:{fetchAllChannelConfig(){var e=this;s.default.fetchAllNotifyChannelConfig({},{permission:"page"}).then((function(t){e.channleList=t,e.formData.channelCode=t.reduce((function(e,t){return t.isActive&&e.push(t.code),e}),[]),e.channelCodeMemo=[...e.channelCode]})).finally((function(){e.isLoading=!1}))},fetchAllUserBlacklist(){var e=this;s.default.fetchAllUserBlacklist({},{permission:"page"}).then((function(t){e.formData.users=t.map((function(e){return e.username})),e.usersMemo=[...e.users]}))},handleBlackListChange(e,t){this.formData.users=e},handleToggleChannel(e){var t=this.formData.channelCode.indexOf(e);t>-1?this.formData.channelCode.splice(t,1):this.formData.channelCode.push(e)},handleEditTemplate(e,t){var a=this;s.default.fetchChannelTemplate({channelCode:e,messageTypeCode:t}).then((function(e){var t=e.currentTemplate,n=e.defaultTemplate;a.templateDetail=(0,i.default)(t||n),a.currentTemplate=(0,i.default)(t||n),a.currentDefaultTemplate=(0,i.default)(n)})).finally((function(){a.showTemplateEdit=!0}))},handleSave(){var e=this;this.isSubmiting=!0,Promise.all([s.default.updateNotifyChannel({channelCodeStr:this.formData.channelCode.join(",")}).catch((function(){e.messageError("保存通知渠道失败")})),s.default.updateUserBlacklist({usersStr:this.formData.users.join(",")}).catch((function(){e.messageError("保存黑名单失败")}))]).then((function(){window.changeAlert=!1,e.messageSuccess("保存成功")})).finally((function(){e.isSubmiting=!1}))},handleReset(){this.formData.channelCode=[...this.channelCodeMemo],this.formData.users=[...this.usersMemo]},handleNotifyContent(e,t){this.templateDetail[t]=e},handleTriggerSave(){var e=this;this.$refs.editTemplate.$refs.templateForm.validate().then((function(){var t=e.templateDetail,a={channelCode:t.code,messageTypeCode:t.messageTypeCode,content:t.content,title:t.title};s.default.updateNotifyTemplate(a).then((function(t){e.showTemplateEdit=!1,e.messageSuccess("保存成功")})).finally((function(){e.isSaveLoading=!1}))}))},handleTriggerReset(){this.templateDetail=(0,i.default)(this.currentTemplate)},handleTriggerInit(){this.templateDetail=(0,i.default)(this.currentDefaultTemplate)}}};t.Z=c},18170:function(e,t,a){"use strict";a(87147),a(13118),a(59241),a(20767);var n=a(70534);Object.defineProperty(t,"X",{value:!0}),t.Z=void 0,a(41336),a(91981),a(63898);var i=n(a(68203)),s=n(a(25190)),r=n(a(99509)),l=n(a(72563)),o=n(a(76960));function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function u(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var d={name:"",components:{SmartAction:l.default,JbInput:o.default},data:()=>({isLoading:!1,isSubmitting:!1,formData:{titleHead:"",titleSeparator:"",footerLink:"",footerCopyRight:""},currentTitleFooter:{},defaultTitleFooter:{}}),created(){this.fetchTitleAndFooter(),this.rules={titleHead:[{required:!0,message:"平台名称必填",trigger:"blur"}],titleSeparator:[{required:!0,message:"分隔符必填",trigger:"blur"}]}},methods:{fetchTitleAndFooter(){var e=this;this.isLoading=!0,r.default.fetchTitleAndFooterConfig().then((function(t){e.defaultTitleFooter=(0,s.default)(t.defaultTitleFooter),e.currentTitleFooter=(0,s.default)(t.currentTitleFooter),e.formData=u(u({},e.formData),t.currentTitleFooter)})).finally((function(){e.isLoading=!1}))},handleRestore(){this.formData=(0,s.default)(this.defaultTitleFooter)},handleReset(){this.formData=(0,s.default)(this.currentTitleFooter)},handleSave(){var e=this;this.$refs.platformForm.validate().then((function(t){e.isSubmitting=!0,r.default.updateTitleAndFooterConfig(e.formData).then((function(){window.changeAlert=!1,e.messageSuccess("保存成功")})).finally((function(){e.isSubmitting=!1}))}))}}};t.Z=d},32489:function(e,t,a){"use strict";a(87147),a(13118),a(59241),a(20767);var n=a(70534);Object.defineProperty(t,"X",{value:!0}),t.Z=void 0;var i=n(a(68203));a(41336),a(91981),a(63898);var s=n(a(99509));function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var l={name:"",data:()=>({isLoading:!1,isSubmiting:!1,formData:{days:0}}),created(){this.fetchData(),this.memoDay=0,this.rules={days:[{validator:function(e){return e>=1},message:"保留天数必须大于0",trigger:"blur"}]}},methods:{fetchData(){var e=this;this.isLoading=!0,s.default.fetchHistroyExpire().then((function(t){e.formData.days=t,e.memoDay=t})).finally((function(){e.isLoading=!1}))},handleSave(){var e=this;this.$refs.form.validate().then((function(){e.isSubmiting=!0,s.default.updateHistroyExpire(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e.formData)).then((function(){e.messageSuccess("设置执行保留时间成功")})).finally((function(){e.isSubmiting=!1}))}))},handleReset(){this.formData.days=this.memoDay}}};t.Z=l},99509:function(e,t,a){"use strict";var n=a(70534);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a(14309),a(13118),a(41336);var i=n(a(84135)),s=n(a(43100)),r={fetchAllNameRule:(e,t)=>i.default.getAllNameRule(e,t).then((function(e){var t=e.data,a=t.currentRules,n=t.defaultRules;return a.length<1&&(a=n),{currentRules:a=a.map((function(e){return new s.default(e)})),defaultRules:n=n.map((function(e){return new s.default(e)}))}})),updateNameRules:(e,t)=>i.default.updateNameRules(e,t).then((function(e){return e.data})),fetchHistroyExpire:(e,t)=>i.default.getHistroyExpire(e,t).then((function(e){return e.data})),updateHistroyExpire(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.default.updateHistroyExpire(e).then((function(e){return e.data}))},fetchAllUserBlacklist:(e,t)=>i.default.getAllUserBlacklist(e,t).then((function(e){return e.data})),updateUserBlacklist:(e,t)=>i.default.updateUserBlacklist(e,t),fetchAllNotifyChannel:(e,t)=>i.default.getAllNotifyChannel(e,t).then((function(e){return e.data})),fetchActiveNotifyChannel:(e,t)=>i.default.getAllNotifyChannel(e,t).then((function(e){return e.data.filter((function(e){return e.isActive}))})),updateNotifyChannel(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.default.updateNotifyChannel(e)},fetchUserList:(e,t)=>i.default.getUserByName(e,t).then((function(e){return e.data})),fetchTitleAndFooterConfig:(e,t)=>i.default.getTitleAndFooterWithDefault(e,t).then((function(e){return e.data})),updateTitleAndFooterConfig(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.default.updateTitleAndFooterConfig(e)},fetchAllNotifyChannelConfig:(e,t)=>i.default.getAllNotifyChannelConfig(e,t).then((function(e){return e.data})),fetchChannelTemplate:(e,t)=>i.default.getChannelTemplate(e,t).then((function(e){return e.data})),updateNotifyTemplate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.default.updateNotifyTemplate(e).then((function(e){return e.data}))},sendNotifyPreview(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.default.sendNotifyPreview(e).then((function(e){return e.data}))},fetchFileUpload:e=>i.default.getFileUpload(e).then((function(e){return e.data})),saveFileUpload:e=>i.default.saveFileUpload(e).then((function(e){return e.data}))};t.default=r},84135:function(e,t,a){"use strict";var n=a(70534);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(a(37346));var s=new class{constructor(){this.module="/job-manage/web/globalSettings"}getAllNameRule(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.default.get("".concat(this.module,"/account/nameRules"),{payload:t})}updateNameRules(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.default.post("".concat(this.module,"/account/setNameRules"),{params:e})}getHistroyExpire(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.default.get("".concat(this.module,"/history/expireTime"),{payload:t})}updateHistroyExpire(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.default.post("".concat(this.module,"/history/expireTime"),{params:e})}getAllNotifyChannel(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.default.get("".concat(this.module,"/notify/listChannels"),{payload:t})}updateNotifyChannel(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.default.post("".concat(this.module,"/notify/setAvailableChannels"),{params:e})}getAllUserBlacklist(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.default.get("".concat(this.module,"/notify/users/blacklist"),{payload:t})}updateUserBlacklist(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.default.post("".concat(this.module,"/notify/users/blacklist"),{params:e,payload:t})}getUserByName(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.default.get("".concat(this.module,"/users/list"),{params:e})}updateTitleAndFooterConfig(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.default.post("".concat(this.module,"/titleFooter"),{params:e})}getTitleAndFooterWithDefault(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.default.get("".concat(this.module,"/titleFooterWithDefault"),{payload:t})}getAllNotifyChannelConfig(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.default.get("".concat(this.module,"/notify/channelTemplate/configStatus"),{payload:t})}getChannelTemplate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i.default.get("".concat(this.module,"/notify/channelTemplate/detail"),{params:e,payload:t})}updateNotifyTemplate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.default.post("".concat(this.module,"/notify/channelTemplate"),{params:e})}sendNotifyPreview(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.default.post("".concat(this.module,"/notify/channelTemplate/send"),{params:e})}getFileUpload(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.default.get("".concat(this.module,"/file/upload"),{params:e})}saveFileUpload(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.default.post("".concat(this.module,"/file/upload"),{params:e})}};t.default=s},18289:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InternalVariables=void 0;t.InternalVariables={general:[{name:"{{ task.id }}",meaning:"任务的ID",examples:"127"},{name:"{{ task.name }}",meaning:"任务的名称",examples:"获取所有主机的设备型号"},{name:"{{ task.bk_biz_id }}",meaning:"任务所属业务的 ID",examples:"100147"},{name:"{{ task.bk_biz_name }}",meaning:"任务所属业务的名称",examples:"王者荣耀"},{name:"{{ task.operator }}",meaning:"任务的操作人",examples:"admin"},{name:"{{ task.start_time }}",meaning:"任务开始时间",examples:"2020-05-10 20:32:18 (+0800)"},{name:"{{ task.type }}",meaning:"任务的类型",examples:"快速执行脚本 / 作业任务 / 定时任务 / ..."},{name:"{{ task.url }}",meaning:"任务的详情链接",examples:"https://cloud-job.blueking.com/127/crons/..."}],job:[{name:"{{ task.step.name }}",meaning:"任务当前步骤的名称",examples:"这是检查配置文件语法的步骤"},{name:"{{ task.step.type }}",meaning:"任务当前步骤的类型",examples:"脚本执行 or 文件分发 or 人工确认"},{name:"{{ task.step.total_seq_cnt }}",meaning:"任务的步骤总数",examples:"12"},{name:"{{ task.step.current_seq_id }}",meaning:"任务当前步骤的序号",examples:"7"},{name:"{{ task.step.duration }}",meaning:"任务当前步骤执行耗时",examples:"12.375"},{name:"{{ task.total_duration }}",meaning:"任务执行总耗时",examples:"65.831"},{name:"{{ task.step.failed_cnt }}",meaning:"任务当前步骤执行失败数",examples:"83"},{name:"{{ task.step.success_cnt }}",meaning:"任务当前步骤执行成功数",examples:"146"},{name:"{{ task.step.confirm_info }}",meaning:"任务的人工确认描述",examples:"请确认以上执行步骤是否执行正常"},{name:"{{ task.step.confirmer }}",meaning:"任务的确认步骤的干系人",examples:"admin"}],cron:[{name:"{{ task.cron.plan_name }}",meaning:"定时关联的执行方案名",examples:"这是一个测试的作业执行方案"},{name:"{{ task.cron.plan_id }}",meaning:"定时关联的执行方案ID",examples:"10000058"},{name:"{{ task.cron.repeat_freq }}",meaning:"定时任务的执行策略",examples:"单次执行 or 周期执行"},{name:"{{ task.cron.time_set }}",meaning:"定时任务的执行时间",examples:"* * * * * or 2020-05-12 23:31:00"},{name:"{{ task.cron.notify_time }}",meaning:"定时任务提前通知时间",examples:"30"}]}},56528:function(){},10908:function(){},21697:function(){},84632:function(){},27987:function(){},36464:function(){},22662:function(){},8519:function(){},52313:function(){},6e3:function(e,t,a){"use strict";a.r(t),a.d(t,{__esModule:function(){return i.X},default:function(){return l}});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"detail-layout-wrapper"},[a("div",{staticClass:"channel-detail-layout"},[a("div",{staticClass:"layout-left"},[a("div",{staticClass:"detail-item"},[a("label",[e._v(e._s("渠道类型："))]),e._v(" "),a("span",[e._v(e._s(e.formData.name))])]),e._v(" "),a("div",{staticClass:"detail-item"},[a("label",[e._v(e._s("消息类型："))]),e._v(" "),a("span",[e._v(e._s(e.formData.messageTypeLabel))])])]),e._v(" "),a("div",{staticClass:"layout-right"},[a("div",{staticClass:"detail-item"},[a("label",[e._v(e._s("最近修改人："))]),e._v(" "),a("span",[e._v(e._s(e.formData.lastModifier))])]),e._v(" "),a("div",{staticClass:"detail-item"},[a("label",[e._v(e._s("最近修改时间："))]),e._v(" "),a("span",[e._v(e._s(e.formData.lastModifyTime))])])])])]),e._v(" "),a("jb-form",{ref:"templateForm",staticClass:"notify-template-form",attrs:{model:e.formData,"form-type":"vertical",rules:e.rules}},["mail"===e.formData.code?a("jb-form-item",{attrs:{label:"邮件主题",required:"",property:"title"}},[a("bk-input",{on:{change:function(t){return e.handleChange(t,"title")}},model:{value:e.formData.title,callback:function(t){e.$set(e.formData,"title",t)},expression:"formData.title"}})],1):e._e(),e._v(" "),a("jb-form-item",{attrs:{label:"模板内容",required:"",property:"content"}},[a("bk-button",{attrs:{text:""},on:{click:function(t){return e.toggleShowVariable(!0)}}},[e._v(e._s("内置变量"))]),e._v(" "),a("bk-input",{attrs:{type:"textarea"},on:{change:function(t){return e.handleChange(t,"content")}},model:{value:e.formData.content,callback:function(t){e.$set(e.formData,"content",t)},expression:"formData.content"}})],1)],1),e._v(" "),a("div",{staticClass:"message-preview"},[a("bk-button",{attrs:{text:""},on:{click:function(t){e.isShowPreviewSend=!e.isShowPreviewSend}}},[e._v(e._s("消息预览"))]),e._v(" "),e.isShowPreviewSend?a("render-strategy",{attrs:{left:"20"}},[a("div",{staticClass:"send-message-content"},[a("jb-user-selector",{staticClass:"input",attrs:{placeholder:"请输入接收消息预览的用户名（请确保接受人对应的账号配置正常）",user:e.reciverList,"show-role":!1},on:{"on-change":e.handleApprovalUserChange}}),e._v(" "),a("bk-button",{attrs:{theme:"primary",loading:e.isLoading},on:{click:e.handleSend}},[e._v("\n                    "+e._s("发送")+"\n                ")])],1)]):e._e()],1),e._v(" "),a("jb-dialog",{staticClass:"internal-variable-dialog",attrs:{width:960,"show-footer":!1},model:{value:e.isShowVariable,callback:function(t){e.isShowVariable=t},expression:"isShowVariable"}},[a("internalVariable",{attrs:{"handle-close":e.toggleShowVariable}})],1)],1)};n._withStripped=!0;var i=a(24262),s=i.Z,r=(a(6587),(0,a(51900).Z)(s,n,[],!1,null,null,null));r.options.__file="src/views/global-setting/index/components/edit-of-template.vue";var l=r.exports},42300:function(e,t,a){"use strict";a.r(t),a.d(t,{__esModule:function(){return i.X},default:function(){return l}});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"internal-variable-wrapper"},[a("Icon",{staticClass:"close-dialog",attrs:{type:"close"},on:{click:function(t){return t.stopPropagation(),e.handleClose(!1)}}}),e._v(" "),a("header",[e._v(e._s("内置变量列表"))]),e._v(" "),a("bk-tab",{staticClass:"variable-tab",attrs:{active:e.variableType,type:"unborder-card","before-toggle":e.handleTabChange}},[a("bk-tab-panel",{attrs:{name:"general",label:"通用变量"}}),e._v(" "),a("bk-tab-panel",{attrs:{name:"job",label:"作业变量"}}),e._v(" "),a("bk-tab-panel",{attrs:{name:"cron",label:"定时任务变量"}})],1),e._v(" "),a("bk-table",{staticClass:"variable-table",attrs:{data:e.renderList}},[a("bk-table-column",{attrs:{label:"变量名称",prop:"name"}}),e._v(" "),a("bk-table-column",{attrs:{label:"含义",prop:"meaning"}}),e._v(" "),a("bk-table-column",{attrs:{label:"示例",width:320,prop:"examples"}})],1)],1)};n._withStripped=!0;var i=a(43272),s=i.Z,r=(a(63931),(0,a(51900).Z)(s,n,[],!1,null,null,null));r.options.__file="src/views/global-setting/index/components/internal-variable.vue";var l=r.exports},52056:function(e,t,a){"use strict";a.r(t),a.d(t,{__esModule:function(){return i.X},default:function(){return l}});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("table",{staticClass:"notify-channel-table"},[a("thead",[a("tr",[a("th",[a("div",{staticClass:"split-header"},[a("span",{staticClass:"split-item channel"},[e._v(e._s("渠道"))]),e._v(" "),a("span",{staticClass:"split-item template"},[e._v(e._s("模板"))])])]),e._v(" "),e._l(e.channleList,(function(t,n){return a("th",{key:n,class:["channel-item",{"un-selected":!e.channelCode.includes(t.code)}],on:{click:function(a){return a.stopPropagation(),e.handleToggleChannel(t.code)}}},[a("div",{staticClass:"channel-wraper"},[a("img",{staticClass:"channel-icon",attrs:{src:t.icon,alt:""}}),e._v(" "),a("p",{staticClass:"channel-name"},[e._v(e._s(t.name))])]),e._v(" "),a("bk-checkbox",{staticClass:"channel-check",attrs:{checked:e.channelCode.includes(t.code)}})],1)}))],2)]),e._v(" "),a("tbody",e._l(e.templateList,(function(t,n){return a("tr",{key:n},[a("td",[e._v(e._s(t.name))]),e._v(" "),e._l(e.channleList,(function(n,i){return a("td",{key:i,class:{"un-selected":!e.channelCode.includes(n.code)}},[a("div",{staticClass:"setting-detail"},[e.getConfigStatus(n.templateInfoList,t.code)?a("Icon",{staticClass:"setting-flag",attrs:{type:"check"}}):a("span",{staticClass:"un-set-up"},[e._v(e._s("未设置"))]),e._v(" "),a("span",{staticClass:"edit-btn",on:{click:function(a){return a.stopPropagation(),e.handleEditTemplate(n.code,t.code)}}},[a("Icon",{staticClass:"edit-icon",attrs:{type:"edit-2"}}),e._v(e._s("编辑模板")+"\n                    ")],1)],1)])}))],2)})),0)])};n._withStripped=!0;var i=a(17815),s=i.Z,r=(a(99019),(0,a(51900).Z)(s,n,[],!1,null,"695f4f8d",null));r.options.__file="src/views/global-setting/index/components/notify-channel-table.vue";var l=r.exports},27180:function(e,t,a){"use strict";a.r(t),a.d(t,{__esModule:function(){return i.X},default:function(){return l}});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-global-set-up"},[a("bk-tab",{staticClass:"page-tab",attrs:{active:e.page,"before-toggle":e.handleTabChange}},[a("bk-tab-panel",{attrs:{name:"notify",label:"通知设置"}}),e._v(" "),a("bk-tab-panel",{attrs:{name:"account",label:"账号命名规则"}}),e._v(" "),a("bk-tab-panel",{attrs:{name:"platform",label:"平台信息"}}),e._v(" "),a("bk-tab-panel",{attrs:{name:"fileUpload",label:"文件上传设置"}})],1),e._v(" "),a("div",{staticClass:"set-up-wraper"},[a("transition",{attrs:{name:"slide"}},[a(e.pageCom,{ref:"page",tag:"component",staticClass:"set-up-content"})],1)],1)],1)};n._withStripped=!0;var i=a(14586),s=i.Z,r=(a(36942),(0,a(51900).Z)(s,n,[],!1,null,null,null));r.options.__file="src/views/global-setting/index/index.vue";var l=r.exports},6594:function(e,t,a){"use strict";a.r(t),a.d(t,{__esModule:function(){return i.X},default:function(){return l}});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading }"}],staticClass:"page-account-rule"},[a("smart-action",{attrs:{"offset-target":"expression-input"},scopedSlots:e._u([{key:"action",fn:function(){return[a("bk-button",{staticClass:"w120 mr10",attrs:{theme:"primary",loading:e.isSubmitting},on:{click:e.handleSave}},[e._v(e._s("保存"))]),e._v(" "),a("bk-button",{on:{click:e.handleResetAll}},[e._v(e._s("重置"))])]},proxy:!0}])},[a("div",{staticClass:"wraper"},e._l(e.currentRules,(function(t,n){return a("div",{key:n,staticClass:"account-block"},[a("div",{staticClass:"name"},[e._v(e._s(t.osTypeText))]),e._v(" "),a("div",{staticClass:"expression-input"},[a("bk-input",{attrs:{value:t.expression,placeholder:"请输入命名规则"},on:{change:function(t){return e.handleChange("expression",t,n)}}})],1),e._v(" "),a("div",{staticClass:"rule"},[a("bk-input",{attrs:{value:t.description,placeholder:"请输入命名规则提醒文案"},on:{change:function(t){return e.handleChange("description",t,n)}}})],1),e._v(" "),a("bk-button",{staticClass:"reset",attrs:{text:""},on:{click:function(t){return e.handleReset(n)}}},[e._v(e._s("恢复默认"))])],1)})),0)])],1)};n._withStripped=!0;var i=a(74123),s=i.Z,r=(a(21295),(0,a(51900).Z)(s,n,[],!1,null,null,null));r.options.__file="src/views/global-setting/index/pages/account-rule.vue";var l=r.exports},74277:function(e,t,a){"use strict";a.r(t),a.d(t,{__esModule:function(){return i.X},default:function(){return l}});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading }"}],staticClass:"file-upload-manage-page"},[a("smart-action",{attrs:{"offset-target":"input-wraper"},scopedSlots:e._u([{key:"action",fn:function(){return[a("bk-button",{staticClass:"w120",attrs:{theme:"primary",loading:e.isSubmiting},on:{click:e.handleSubmit}},[e._v("\n                "+e._s("保存")+"\n            ")])]},proxy:!0}])},[a("jb-form",{staticStyle:{width:"480px","margin-bottom":"20px"}},[a("div",{staticClass:"block-title"},[e._v("\n                "+e._s("本地文件上传大小限制")+":\n            ")]),e._v(" "),a("jb-form-item",[a("div",{staticClass:"input-wraper"},[a("bk-input",{model:{value:e.info.amount,callback:function(t){e.$set(e.info,"amount",t)},expression:"info.amount"}}),e._v(" "),a("bk-select",{staticClass:"unit-item",attrs:{clearable:!1},model:{value:e.info.unit,callback:function(t){e.$set(e.info,"unit",t)},expression:"info.unit"}},[a("bk-option",{attrs:{id:"GB",name:"GB"}}),e._v(" "),a("bk-option",{attrs:{id:"MB",name:"MB"}})],1)],1)]),e._v(" "),a("div",{staticClass:"block-title"},[e._v("\n                "+e._s("本地文件上传后缀限制")+":\n            ")]),e._v(" "),a("jb-form-item",{staticStyle:{"margin-bottom":"10px"}},[a("bk-radio-group",{staticClass:"restrict-mode-radio",on:{change:e.handleRestSuffixError},model:{value:e.info.restrictMode,callback:function(t){e.$set(e.info,"restrictMode",t)},expression:"info.restrictMode"}},[a("bk-radio-button",{attrs:{value:-1}},[e._v("\n                        "+e._s("不限制")+"\n                    ")]),e._v(" "),a("bk-radio-button",{attrs:{value:1}},[e._v("\n                        "+e._s("设置允许范围")+"\n                    ")]),e._v(" "),a("bk-radio-button",{attrs:{value:0}},[e._v("\n                        "+e._s("设置禁止范围")+"\n                    ")])],1)],1),e._v(" "),e.info.restrictMode>-1?a("div",[a("jb-form-item",[a("bk-tag-input",{key:e.info.restrictMode,attrs:{"allow-create":"","has-delete-icon":""},on:{change:e.handleRestSuffixError},model:{value:e.info.suffixList,callback:function(t){e.$set(e.info,"suffixList",t)},expression:"info.suffixList"}})],1),e._v(" "),a("div",{staticClass:"form-item-error",domProps:{innerHTML:e._s(e.suffixError)}})],1):e._e()],1)],1)],1)};n._withStripped=!0;var i=a(89922),s=i.Z,r=(a(78590),(0,a(51900).Z)(s,n,[],!1,null,null,null));r.options.__file="src/views/global-setting/index/pages/file-upload.vue";var l=r.exports},7211:function(e,t,a){"use strict";a.r(t),a.d(t,{__esModule:function(){return i.X},default:function(){return l}});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading }"}],staticClass:"notify-set-manange"},[e.isLoading?e._e():a("jb-form",{staticClass:"wraper",attrs:{model:e.formData}},[a("div",{staticClass:"block-title"},[e._v(e._s("用户可选择的通知渠道")+"：")]),e._v(" "),a("notify-channel",{attrs:{"channle-list":e.channleList,"channel-code":e.formData.channelCode,"handle-toggle-channel":e.handleToggleChannel,"handle-edit-template":e.handleEditTemplate}}),e._v(" "),a("div",{staticClass:"backlist block-title"},[a("span",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:e.backlistConfig,expression:"backlistConfig"}]},[e._v(e._s("通讯黑名单")+":")])]),e._v(" "),a("div",[a("jb-user-selector",{attrs:{placeholder:"请输入",user:e.formData.users,"show-role":!1},on:{"on-change":e.handleBlackListChange}})],1),e._v(" "),a("div",{staticClass:"action-box"},[a("bk-button",{staticClass:"w120 mr10",attrs:{theme:"primary",loading:e.isSubmiting},on:{click:e.handleSave}},[e._v("\n                "+e._s("保存")+"\n            ")]),e._v(" "),a("bk-button",{on:{click:e.handleReset}},[e._v(e._s("重置"))])],1)],1),e._v(" "),a("jb-sideslider",{attrs:{"is-show":e.showTemplateEdit,title:"消息模板编辑",width:680},on:{"update:isShow":function(t){e.showTemplateEdit=t},"update:is-show":function(t){e.showTemplateEdit=t}},scopedSlots:e._u([{key:"footer",fn:function(){return[a("bk-button",{staticClass:"slider-action",attrs:{theme:"primary",loading:e.isSaveLoading},on:{click:e.handleTriggerSave}},[e._v("\n                "+e._s("保存")+"\n            ")]),e._v(" "),a("bk-button",{staticClass:"slider-action",on:{click:e.handleTriggerReset}},[e._v(e._s("重置"))]),e._v(" "),a("bk-button",{staticClass:"slider-action",on:{click:e.handleTriggerInit}},[e._v(e._s("初始化"))])]},proxy:!0}])},[a("edit-of-template",{ref:"editTemplate",attrs:{data:e.templateDetail},on:{"on-change":e.handleNotifyContent}})],1)],1)};n._withStripped=!0;var i=a(66900),s=i.Z,r=(a(8993),(0,a(51900).Z)(s,n,[],!1,null,null,null));r.options.__file="src/views/global-setting/index/pages/notify-manage.vue";var l=r.exports},6341:function(e,t,a){"use strict";a.r(t),a.d(t,{__esModule:function(){return i.X},default:function(){return l}});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading }"}],staticClass:"page-platform-info"},[a("smart-action",{attrs:{"offset-target":"bk-form-content"},scopedSlots:e._u([{key:"action",fn:function(){return[a("bk-button",{staticClass:"w120 mr10",attrs:{theme:"primary",loading:e.isSubmitting},on:{click:e.handleSave}},[e._v(e._s("保存"))]),e._v(" "),a("bk-button",{on:{click:e.handleReset}},[e._v(e._s("重置"))])]},proxy:!0}])},[a("div",{staticClass:"wraper"},[a("jb-form",{ref:"platformForm",attrs:{model:e.formData,rules:e.rules}},[a("bk-popover",{attrs:{placement:"top",width:320,theme:"light",distance:-10}},[a("div",{staticClass:"backlist block-title"},[a("span",[e._v(e._s("网页 Title 设置:"))])]),e._v(" "),a("div",{staticClass:"title-example-popover",attrs:{slot:"content"},slot:"content"},[a("img",{staticClass:"example-image",attrs:{src:"/static/images/title-example.png"}})])]),e._v(" "),a("hgroup",[a("jb-form-item",{attrs:{label:"平台名称",required:"",property:"titleHead"}},[a("jb-input",{staticStyle:{width:"240px"},model:{value:e.formData.titleHead,callback:function(t){e.$set(e.formData,"titleHead",t)},expression:"formData.titleHead"}})],1),e._v(" "),a("jb-form-item",{staticClass:"title-separator-item",attrs:{label:"分隔符",required:"",property:"titleSeparator"}},[a("jb-input",{staticStyle:{width:"240px"},model:{value:e.formData.titleSeparator,callback:function(t){e.$set(e.formData,"titleSeparator",t)},expression:"formData.titleSeparator"}})],1),e._v(" "),a("bk-button",{staticClass:"reset",attrs:{text:"",size:"small"},on:{click:e.handleRestore}},[e._v("\n                        "+e._s("恢复默认")+"\n                    ")])],1),e._v(" "),a("div",{staticClass:"block-title"},[a("span",[e._v(e._s("页脚信息设置")+":")])]),e._v(" "),a("jb-form-item",{attrs:{label:"联系方式"}},[a("jb-input",{staticStyle:{width:"680px"},model:{value:e.formData.footerLink,callback:function(t){e.$set(e.formData,"footerLink",t)},expression:"formData.footerLink"}})],1),e._v(" "),a("jb-form-item",{attrs:{label:"版权信息"}},[a("jb-input",{model:{value:e.formData.footerCopyRight,callback:function(t){e.$set(e.formData,"footerCopyRight",t)},expression:"formData.footerCopyRight"}})],1)],1)],1)])],1)};n._withStripped=!0;var i=a(18170),s=i.Z,r=(a(71875),(0,a(51900).Z)(s,n,[],!1,null,null,null));r.options.__file="src/views/global-setting/index/pages/platform-info.vue";var l=r.exports},63660:function(e,t,a){"use strict";a.r(t),a.d(t,{__esModule:function(){return i.X},default:function(){return l}});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading }"}],staticClass:"page-storage-strategy"},[a("div",{staticClass:"wraper"},[a("div",{staticClass:"execute-block"},[a("div",{staticClass:"block-title"},[e._v(e._s("执行历史保留")+"：")]),e._v(" "),a("jb-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,"form-type":"vertical"}},[a("jb-form-item",{attrs:{property:"days"}},[a("bk-input",{attrs:{type:"number",min:1},model:{value:e.formData.days,callback:function(t){e.$set(e.formData,"days",t)},expression:"formData.days"}},[a("template",{slot:"append"},[a("div",{staticClass:"group-text"},[e._v(e._s("天"))])])],2)],1)],1)],1),e._v(" "),a("div",{staticClass:"action-box"},[a("bk-button",{staticClass:"w120 mr10",attrs:{theme:"primary",loading:e.isSubmiting},on:{click:e.handleSave}},[e._v("\n                "+e._s("保存")+"\n            ")]),e._v(" "),a("bk-button",{on:{click:e.handleReset}},[e._v(e._s("重置"))])],1)])])};n._withStripped=!0;var i=a(32489),s=i.Z,r=(a(2264),(0,a(51900).Z)(s,n,[],!1,null,null,null));r.options.__file="src/views/global-setting/index/pages/storage-strategy.vue";var l=r.exports},6587:function(e,t,a){var n=a(56528);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(18086).Z)("2e974519",n,!1,{})},63931:function(e,t,a){var n=a(10908);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(18086).Z)("6738be46",n,!1,{})},99019:function(e,t,a){var n=a(21697);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(18086).Z)("f69519f4",n,!1,{})},36942:function(e,t,a){var n=a(84632);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(18086).Z)("b10f8792",n,!1,{})},21295:function(e,t,a){var n=a(27987);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(18086).Z)("2b8610b5",n,!1,{})},78590:function(e,t,a){var n=a(36464);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(18086).Z)("9b15d51a",n,!1,{})},8993:function(e,t,a){var n=a(22662);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(18086).Z)("6bd5b5e1",n,!1,{})},71875:function(e,t,a){var n=a(8519);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(18086).Z)("1366cc42",n,!1,{})},2264:function(e,t,a){var n=a(52313);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,a(18086).Z)("471120d5",n,!1,{})}}]);