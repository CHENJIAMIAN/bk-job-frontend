{"version":3,"file":"js/6401.c9394f82ab863e7b101d.js","mappings":"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","sources":["webpack://job/src/views/task-manage/debug-plan/index.vue","webpack://job/./src/views/task-manage/debug-plan/index.vue?abc0","webpack://job/./src/views/task-manage/debug-plan/index.vue?2d5b","webpack://job/./src/views/task-manage/debug-plan/index.vue?2a54","webpack://job/./src/views/task-manage/debug-plan/index.vue?3c4d"],"sourcesContent":["<template>\r\n    <div>\r\n        <smart-action class=\"edit-execute-plan\" offset-target=\"detail-content\">\r\n            <detail-layout mode=\"see\">\r\n                <detail-item :label=\"'全局变量：'\" class=\"gloval-var-item\">\r\n                    <render-global-var\r\n                        :list=\"variableList\"\r\n                        :select-value=\"selectedVariable\"\r\n                        mode=\"editOfPlan\" />\r\n                </detail-item>\r\n                <detail-item label=\"\" class=\"task-step-item\">\r\n                    <div class=\"task-step-selection\">\r\n                        <!-- eslint-disable-next-line max-len -->\r\n                        <div>{{ '选择要调试的步骤' }}（ {{ formData.enableSteps.length }} / {{ taskStepList.length }} ）</div>\r\n                        <div class=\"step-check\">\r\n                            <bk-button\r\n                                v-if=\"hasSelectAll\"\r\n                                text\r\n                                @click=\"handleDeselectAll\">\r\n                                {{ '取消全选' }}\r\n                            </bk-button>\r\n                            <bk-button\r\n                                v-else\r\n                                text\r\n                                @click=\"handleSelectAll\">\r\n                                {{ '全选' }}\r\n                            </bk-button>\r\n                        </div>\r\n                    </div>\r\n                    <render-task-step\r\n                        :list=\"taskStepList\"\r\n                        :select-value=\"formData.enableSteps\"\r\n                        mode=\"select\"\r\n                        @on-select=\"handleSelectStep\" />\r\n                </detail-item>\r\n            </detail-layout>\r\n            <template #action>\r\n                <div class=\"action-wraper\">\r\n                    <bk-button\r\n                        theme=\"primary\"\r\n                        class=\"w120 mr10\"\r\n                        \r\n                        @click=\"handleSubmitExec\">\r\n                        {{ '去执行' }}\r\n                    </bk-button>\r\n                    <bk-button @click=\"handleCancle\">{{ '取消' }}</bk-button>\r\n                    <bk-button\r\n                        \r\n                        class=\"plan-save\"\r\n                        @click=\"handleSavePlan\">\r\n                        {{ '另存为' }}\r\n                    </bk-button>\r\n                </div>\r\n            </template>\r\n        </smart-action>\r\n        <back-top />\r\n        <jb-dialog\r\n            v-model=\"isShowSave\"\r\n            class=\"save-debug-plan-dialog\"\r\n            :title=\"'另存为执行方案'\"\r\n            header-position=\"left\"\r\n            render-directive=\"if\"\r\n            :mask-close=\"false\"\r\n            :esc-close=\"false\"\r\n            :width=\"480\">\r\n            <jb-form ref=\"editPlanForm\" :model=\"planFormData\" form-type=\"vertical\" :rules=\"rules\">\r\n                <jb-form-item :label=\"'执行方案名称'\" required property=\"name\">\r\n                    <bk-input\r\n                        v-model=\"planFormData.name\"\r\n                        :native-attributes=\"{ autofocus: 'autofocus' }\"\r\n                        :placeholder=\"'请输入执行方案名称'\"\r\n                        @keydown=\"handleEnter\" />\r\n                </jb-form-item>\r\n            </jb-form>\r\n            <div slot=\"footer\" class=\"setting-password-footer\">\r\n                <bk-button\r\n                    theme=\"primary\"\r\n                    class=\"mr10\"\r\n                    :loading=\"isPlanCreating\"\r\n                    @click=\"handleSubmitCreatePlan\">\r\n                    {{ '确定' }}\r\n                </bk-button>\r\n                <bk-button @click=\"handleCloseSave\">{{ '取消' }}</bk-button>\r\n            </div>\r\n        </jb-dialog>\r\n    </div>\r\n</template>\r\n<script>\r\n       import TaskExecuteService from '@service/task-execute';\r\n    import ExecPlanService from '@service/task-plan';\r\n    import BackTop from '@components/back-top';\r\n    import DetailLayout from '@components/detail-layout';\r\n    import DetailItem from '@components/detail-layout/item';\r\n    import {\r\n        planNameRule,\r\n    } from '@utils/validator';\r\n    import {\r\n        findUsedVariable,\r\n    } from '@utils/assist';\r\n    import RenderGlobalVar from '../common/render-global-var';\r\n    import RenderTaskStep from '../common/render-task-step';\r\n\r\n    const getDefaultData = () => ({\r\n        id: 0,\r\n        name: '',\r\n        enableSteps: [],\r\n        templateId: 0,\r\n        variables: [],\r\n    });\r\n\r\n    export default {\r\n        name: '',\r\n        components: {\r\n            BackTop,\r\n            DetailLayout,\r\n            DetailItem,\r\n            RenderGlobalVar,\r\n            RenderTaskStep,\r\n        },\r\n        data () {\r\n            return {\r\n                formData: getDefaultData(),\r\n                planFormData: {\r\n                    name: '',\r\n                },\r\n                variableList: [{},{},{}],\r\n                taskStepList: [{},{},{}],\r\n                isLoading: true,\r\n                isShowSave: false,\r\n                isPlanCreating: false,\r\n            };\r\n        },\r\n        computed: {\r\n            isSkeletonLoading () {\r\n                return this.isLoading;\r\n            },\r\n            selectedVariable () {\r\n                const selectedSteps = this.taskStepList.filter(step => this.formData.enableSteps.includes(step.id));\r\n                return findUsedVariable(selectedSteps);\r\n            },\r\n            hasSelectAll () {\r\n                return this.formData.enableSteps.length >= this.taskStepList.length;\r\n            },\r\n            enableStepsNotEmpty () {\r\n                return this.formData.enableSteps.length > 0;\r\n            },\r\n        },\r\n        created () {\r\n            this.formData.templateId = Number(this.$route.params.id);\r\n\r\n            this.fetchData();\r\n\r\n            this.rules = {\r\n                name: [\r\n                    {\r\n                        required: true,\r\n                        message: '方案名称必填',\r\n                        trigger: 'blur',\r\n                    },\r\n                    {\r\n                        validator: planNameRule.validator,\r\n                        message: planNameRule.message,\r\n                        trigger: 'blur',\r\n                    },\r\n                    {\r\n                        validator: this.checkName,\r\n                        message: '方案名称已存在，请重新输入',\r\n                        trigger: 'blur',\r\n                    },\r\n                ],\r\n            };\r\n        },\r\n        methods: {\r\n            /**\r\n             * @desc 获取调试数据\r\n             */\r\n            fetchData () {\r\n                ExecPlanService.fetchDebugInfo({\r\n                    templateId: this.formData.templateId,\r\n                }).then((data) => {\r\n                    this.variableList = Object.freeze(data.variableList);\r\n                    this.taskStepList = Object.freeze(data.stepList);\r\n\r\n                    this.formData.name = data.name;\r\n                    this.formData.id = data.id;\r\n                    this.formData.enableSteps = data.stepList.map(item => item.id);\r\n                    this.formData.variables = data.variableList;\r\n                })\r\n                    .catch((error) => {\r\n                        if ([\r\n                            1243027,\r\n                            400,\r\n                        ].includes(error.code)) {\r\n                            setTimeout(() => {\r\n                                this.$router.push({\r\n                                    name: 'taskList',\r\n                                });\r\n                            }, 3000);\r\n                        }\r\n                    })\r\n                    .finally(() => {\r\n                        this.isLoading = false;\r\n                    });\r\n            },\r\n            /**\r\n             * @desc 执行调试任务\r\n             */\r\n            taskExecution () {\r\n                this.isExecuting = true;\r\n                TaskExecuteService.taskExecution({\r\n                    taskId: this.formData.id,\r\n                    taskVariables: [],\r\n                }).then(({ taskInstanceId }) => {\r\n                    this.$bkMessage({\r\n                        theme: 'success',\r\n                        message: '操作成功',\r\n                    });\r\n                    this.$router.push({\r\n                        name: 'historyTask',\r\n                        params: {\r\n                            id: taskInstanceId,\r\n                        },\r\n                    });\r\n                })\r\n                    .finally(() => {\r\n                        this.isExecuting = false;\r\n                    });\r\n            },\r\n            /**\r\n             * @desc 检测任务名是否重名\r\n             * @param {String} name 任务名\r\n             */\r\n            checkName (name) {\r\n                return ExecPlanService.planCheckName({\r\n                    templateId: this.formData.templateId,\r\n                    planId: this.formData.id,\r\n                    name,\r\n                });\r\n            },\r\n            /**\r\n             * @desc 选择模板步骤\r\n             * @param {String} payload 模板步骤\r\n             */\r\n            handleSelectStep (payload) {\r\n                const index = this.formData.enableSteps.findIndex(item => item === payload.id);\r\n                if (index > -1) {\r\n                    this.formData.enableSteps.splice(index, 1);\r\n                } else {\r\n                    this.formData.enableSteps.push(payload.id);\r\n                }\r\n            },\r\n            /**\r\n             * @desc 选择模板的所有步骤\r\n             */\r\n            handleSelectAll () {\r\n                this.formData.enableSteps = this.taskStepList.map(item => item.id);\r\n            },\r\n            /**\r\n             * @desc 情况模板步骤选择\r\n             */\r\n            handleDeselectAll () {\r\n                this.formData.enableSteps = [];\r\n            },\r\n            /**\r\n             * @desc 开始执行\r\n             *\r\n             * 1，任务没有全局变量时直接执行任务\r\n             * 2，任务没有选举变量时需要先设置变量\r\n             */\r\n            handleSubmitExec () {\r\n                this.isExecuting = true;\r\n                ExecPlanService.planUpdate(this.formData)\r\n                    .then(() => {\r\n                        if (this.variableList.length < 1) {\r\n                            this.$bkInfo({\r\n                                title: '确认执行？',\r\n                                subTitle: '未设置全局变量，点击确认将直接执行。',\r\n                                confirmFn: () => {\r\n                                    this.taskExecution();\r\n                                },\r\n                            });\r\n                        } else {\r\n                            this.$router.push({\r\n                                name: 'settingVariable',\r\n                                params: {\r\n                                    id: this.formData.id,\r\n                                    templateId: this.formData.templateId,\r\n                                    debug: 1,\r\n                                },\r\n                                query: {\r\n                                    from: 'debugPlan',\r\n                                },\r\n                            });\r\n                        }\r\n                    })\r\n                    .finally(() => {\r\n                        this.isExecuting = false;\r\n                    });\r\n            },\r\n            /**\r\n             * @desc 显示另存为确认框\r\n             */\r\n            handleSavePlan () {\r\n                this.isShowSave = true;\r\n            },\r\n            /**\r\n             * @desc 取消另存为操作\r\n             */\r\n            handleCloseSave () {\r\n                this.isShowSave = false;\r\n                this.planFormData.name = '';\r\n            },\r\n            /**\r\n             * @desc enter触发提交\r\n             */\r\n            handleEnter (value, event) {\r\n                if (event.isComposing) {\r\n                    // 跳过输入发复合时间\r\n                    return;\r\n                }\r\n                if (event.keyCode !== 13) {\r\n                    // 非enter键\r\n                    return;\r\n                }\r\n                this.handleSubmitCreatePlan();\r\n            },\r\n            /**\r\n             * @desc 另存为执行方案\r\n             */\r\n            handleSubmitCreatePlan () {\r\n                this.isPlanCreating = true;\r\n                this.$refs.editPlanForm.validate()\r\n                    .then(() => {\r\n                        const findTemplateStepIds = () => {\r\n                            const enableStepsMap = this.formData.enableSteps.reduce((result, item) => {\r\n                                result[item] = true;\r\n                                return result;\r\n                            }, {});\r\n                            return this.taskStepList.reduce((result, item) => {\r\n                                if (enableStepsMap[item.id]) {\r\n                                    result.push(item.templateStepId);\r\n                                }\r\n                                return result;\r\n                            }, []);\r\n                        };\r\n                        return ExecPlanService.planUpdate({\r\n                            id: 0,\r\n                            name: this.planFormData.name,\r\n                            templateId: this.formData.templateId,\r\n                            enableSteps: findTemplateStepIds(),\r\n                            variables: this.formData.variables,\r\n                        }).then((newPlanId) => {\r\n                            window.changeAlert = false;\r\n                            this.isShowSave = false;\r\n                            this.planFormData.name = '';\r\n\r\n                            let confirmInfo = null;\r\n                            const handleGoDebug = () => {\r\n                                confirmInfo.close();\r\n                            };\r\n                            const handleGoPlanDetail = () => {\r\n                                confirmInfo.close();\r\n                                this.$router.push({\r\n                                    name: 'viewPlan',\r\n                                    params: {\r\n                                        templateId: this.formData.templateId,\r\n                                    },\r\n                                    query: {\r\n                                        viewPlanId: newPlanId,\r\n                                        from: 'debugPlan',\r\n                                    },\r\n                                });\r\n                            };\r\n                            const subHeader = () => {\r\n                                /* eslint-disable no-unused-vars */\r\n                                const h = this.$createElement;\r\n                                return (\r\n                                <div>\r\n                                    <bk-button style={{ marginRight: '10px' }} text onClick={handleGoDebug}>\r\n                                        {'返回继续调试'}\r\n                                    </bk-button>\r\n                                    <bk-button text onClick={handleGoPlanDetail}>\r\n                                        {'立即前往查看'}\r\n                                    </bk-button>\r\n                                </div>\r\n                                );\r\n                            };\r\n                            confirmInfo = this.$bkInfo({\r\n                                type: 'success',\r\n                                title: '另存执行方案成功',\r\n                                showFooter: false,\r\n                                subHeader: subHeader(),\r\n                            });\r\n                        });\r\n                    })\r\n                    .finally(() => {\r\n                        this.isPlanCreating = false;\r\n                    });\r\n            },\r\n            /**\r\n             * @desc 取消调试\r\n             */\r\n            handleCancle () {\r\n                this.routerBack();\r\n            },\r\n            /**\r\n             * @desc 路由回退\r\n             */\r\n            routerBack () {\r\n                const { from } = this.$route.query;\r\n                if (from === 'taskList') {\r\n                    this.$router.push({\r\n                        name: 'taskList',\r\n                    });\r\n                    return;\r\n                }\r\n                this.$router.push({\r\n                    name: 'templateDetail',\r\n                    params: {\r\n                        id: this.formData.templateId,\r\n                    },\r\n                });\r\n            },\r\n        },\r\n    };\r\n</script>\r\n<style lang='postcss'>\r\n    @import \"@/css/mixins/media\";\r\n\r\n    .edit-execute-plan {\r\n        padding-bottom: 20px;\r\n\r\n        .gloval-var-item {\r\n            margin-top: 20px;\r\n        }\r\n\r\n        .task-step-item {\r\n            margin-top: 20px;\r\n            margin-bottom: 20px;\r\n        }\r\n\r\n        .task-step-selection {\r\n            display: flex;\r\n            width: 500px;\r\n            margin-bottom: 14px;\r\n            font-size: 16px;\r\n            line-height: 21px;\r\n            color: #313238;\r\n\r\n            .step-check {\r\n                margin-left: auto;\r\n            }\r\n        }\r\n\r\n        .task-step-selection,\r\n        .action-wraper {\r\n            @media (--small-viewports) {\r\n                width: 500px;\r\n            }\r\n\r\n            @media (--medium-viewports) {\r\n                width: 560px;\r\n            }\r\n\r\n            @media (--large-viewports) {\r\n                width: 620px;\r\n            }\r\n\r\n            @media (--huge-viewports) {\r\n                width: 680px;\r\n            }\r\n        }\r\n\r\n        .action-wraper {\r\n            display: flex;\r\n\r\n            .plan-save {\r\n                margin-left: auto;\r\n            }\r\n        }\r\n    }\r\n\r\n    .save-debug-plan-dialog {\r\n        .bk-dialog-header {\r\n            padding-bottom: 0 !important;\r\n        }\r\n\r\n        .bk-form-item:last-child {\r\n            margin-bottom: 0 !important;\r\n        }\r\n    }\r\n</style>\r\n","var render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"div\",\n    [\n      _c(\n        \"smart-action\",\n        {\n          staticClass: \"edit-execute-plan\",\n          attrs: { \"offset-target\": \"detail-content\" },\n          scopedSlots: _vm._u([\n            {\n              key: \"action\",\n              fn: function () {\n                return [\n                  _c(\n                    \"div\",\n                    { staticClass: \"action-wraper\" },\n                    [\n                      _c(\n                        \"bk-button\",\n                        {\n                          staticClass: \"w120 mr10\",\n                          attrs: { theme: \"primary\" },\n                          on: { click: _vm.handleSubmitExec },\n                        },\n                        [\n                          _vm._v(\n                            \"\\n                    \" +\n                              _vm._s(\"去执行\") +\n                              \"\\n                \"\n                          ),\n                        ]\n                      ),\n                      _vm._v(\" \"),\n                      _c(\"bk-button\", { on: { click: _vm.handleCancle } }, [\n                        _vm._v(_vm._s(\"取消\")),\n                      ]),\n                      _vm._v(\" \"),\n                      _c(\n                        \"bk-button\",\n                        {\n                          staticClass: \"plan-save\",\n                          on: { click: _vm.handleSavePlan },\n                        },\n                        [\n                          _vm._v(\n                            \"\\n                    \" +\n                              _vm._s(\"另存为\") +\n                              \"\\n                \"\n                          ),\n                        ]\n                      ),\n                    ],\n                    1\n                  ),\n                ]\n              },\n              proxy: true,\n            },\n          ]),\n        },\n        [\n          _c(\n            \"detail-layout\",\n            { attrs: { mode: \"see\" } },\n            [\n              _c(\n                \"detail-item\",\n                {\n                  staticClass: \"gloval-var-item\",\n                  attrs: { label: \"全局变量：\" },\n                },\n                [\n                  _c(\"render-global-var\", {\n                    attrs: {\n                      list: _vm.variableList,\n                      \"select-value\": _vm.selectedVariable,\n                      mode: \"editOfPlan\",\n                    },\n                  }),\n                ],\n                1\n              ),\n              _vm._v(\" \"),\n              _c(\n                \"detail-item\",\n                { staticClass: \"task-step-item\", attrs: { label: \"\" } },\n                [\n                  _c(\"div\", { staticClass: \"task-step-selection\" }, [\n                    _c(\"div\", [\n                      _vm._v(\n                        _vm._s(\"选择要调试的步骤\") +\n                          \"（ \" +\n                          _vm._s(_vm.formData.enableSteps.length) +\n                          \" / \" +\n                          _vm._s(_vm.taskStepList.length) +\n                          \" ）\"\n                      ),\n                    ]),\n                    _vm._v(\" \"),\n                    _c(\n                      \"div\",\n                      { staticClass: \"step-check\" },\n                      [\n                        _vm.hasSelectAll\n                          ? _c(\n                              \"bk-button\",\n                              {\n                                attrs: { text: \"\" },\n                                on: { click: _vm.handleDeselectAll },\n                              },\n                              [\n                                _vm._v(\n                                  \"\\n                            \" +\n                                    _vm._s(\"取消全选\") +\n                                    \"\\n                        \"\n                                ),\n                              ]\n                            )\n                          : _c(\n                              \"bk-button\",\n                              {\n                                attrs: { text: \"\" },\n                                on: { click: _vm.handleSelectAll },\n                              },\n                              [\n                                _vm._v(\n                                  \"\\n                            \" +\n                                    _vm._s(\"全选\") +\n                                    \"\\n                        \"\n                                ),\n                              ]\n                            ),\n                      ],\n                      1\n                    ),\n                  ]),\n                  _vm._v(\" \"),\n                  _c(\"render-task-step\", {\n                    attrs: {\n                      list: _vm.taskStepList,\n                      \"select-value\": _vm.formData.enableSteps,\n                      mode: \"select\",\n                    },\n                    on: { \"on-select\": _vm.handleSelectStep },\n                  }),\n                ],\n                1\n              ),\n            ],\n            1\n          ),\n        ],\n        1\n      ),\n      _vm._v(\" \"),\n      _c(\"back-top\"),\n      _vm._v(\" \"),\n      _c(\n        \"jb-dialog\",\n        {\n          staticClass: \"save-debug-plan-dialog\",\n          attrs: {\n            title: \"另存为执行方案\",\n            \"header-position\": \"left\",\n            \"render-directive\": \"if\",\n            \"mask-close\": false,\n            \"esc-close\": false,\n            width: 480,\n          },\n          model: {\n            value: _vm.isShowSave,\n            callback: function ($$v) {\n              _vm.isShowSave = $$v\n            },\n            expression: \"isShowSave\",\n          },\n        },\n        [\n          _c(\n            \"jb-form\",\n            {\n              ref: \"editPlanForm\",\n              attrs: {\n                model: _vm.planFormData,\n                \"form-type\": \"vertical\",\n                rules: _vm.rules,\n              },\n            },\n            [\n              _c(\n                \"jb-form-item\",\n                {\n                  attrs: {\n                    label: \"执行方案名称\",\n                    required: \"\",\n                    property: \"name\",\n                  },\n                },\n                [\n                  _c(\"bk-input\", {\n                    attrs: {\n                      \"native-attributes\": { autofocus: \"autofocus\" },\n                      placeholder: \"请输入执行方案名称\",\n                    },\n                    on: { keydown: _vm.handleEnter },\n                    model: {\n                      value: _vm.planFormData.name,\n                      callback: function ($$v) {\n                        _vm.$set(_vm.planFormData, \"name\", $$v)\n                      },\n                      expression: \"planFormData.name\",\n                    },\n                  }),\n                ],\n                1\n              ),\n            ],\n            1\n          ),\n          _vm._v(\" \"),\n          _c(\n            \"div\",\n            {\n              staticClass: \"setting-password-footer\",\n              attrs: { slot: \"footer\" },\n              slot: \"footer\",\n            },\n            [\n              _c(\n                \"bk-button\",\n                {\n                  staticClass: \"mr10\",\n                  attrs: { theme: \"primary\", loading: _vm.isPlanCreating },\n                  on: { click: _vm.handleSubmitCreatePlan },\n                },\n                [\n                  _vm._v(\n                    \"\\n                \" + _vm._s(\"确定\") + \"\\n            \"\n                  ),\n                ]\n              ),\n              _vm._v(\" \"),\n              _c(\"bk-button\", { on: { click: _vm.handleCloseSave } }, [\n                _vm._v(_vm._s(\"取消\")),\n              ]),\n            ],\n            1\n          ),\n        ],\n        1\n      ),\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../node_modules/_babel-loader@8.2.5@babel-loader/lib/index.js??clonedRuleSet-1[0].rules[0].use[0]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/_babel-loader@8.2.5@babel-loader/lib/index.js??clonedRuleSet-1[0].rules[0].use[0]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=795d833c&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=postcss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"D:\\\\Desktop\\\\bk-job-frontend\\\\node_modules\\\\_vue-hot-reload-api@2.3.4@vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!api.isRecorded('795d833c')) {\n      api.createRecord('795d833c', component.options)\n    } else {\n      api.reload('795d833c', component.options)\n    }\n    module.hot.accept(\"./index.vue?vue&type=template&id=795d833c&\", function () {\n      api.rerender('795d833c', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"src/views/task-manage/debug-plan/index.vue\"\nexport default component.exports","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../../node_modules/_mini-css-extract-plugin@2.6.0@mini-css-extract-plugin/dist/loader.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../node_modules/_css-loader@6.7.1@css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/_postcss-loader@6.2.1@postcss-loader/dist/cjs.js!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=postcss&\");\nif(content.__esModule) content = content.default;\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../../../node_modules/_vue-style-loader@4.1.3@vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"52399944\", content, false, {});\n// Hot Module Replacement\nif(module.hot) {\n // When the styles change, update the <style> tags\n if(!content.locals) {\n   module.hot.accept(\"!!../../../../node_modules/_mini-css-extract-plugin@2.6.0@mini-css-extract-plugin/dist/loader.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../node_modules/_css-loader@6.7.1@css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/_postcss-loader@6.2.1@postcss-loader/dist/cjs.js!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=postcss&\", function() {\n     var newContent = require(\"!!../../../../node_modules/_mini-css-extract-plugin@2.6.0@mini-css-extract-plugin/dist/loader.js??clonedRuleSet-3[0].rules[0].use[1]!../../../../node_modules/_css-loader@6.7.1@css-loader/dist/cjs.js??clonedRuleSet-3[0].rules[0].use[2]!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/_postcss-loader@6.2.1@postcss-loader/dist/cjs.js!../../../../node_modules/_vue-loader@15.9.8@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&lang=postcss&\");\n     if(newContent.__esModule) newContent = newContent.default;\n     if(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n     update(newContent);\n   });\n }\n // When the module is disposed, remove the <style> tags\n module.hot.dispose(function() { update(); });\n}"],"names":["name","components","BackTop","DetailLayout","DetailItem","RenderGlobalVar","RenderTaskStep","data","id","enableSteps","templateId","variables","planFormData","variableList","taskStepList","isLoading","isShowSave","isPlanCreating","computed","required","message","trigger","validator","methods","ExecPlanService","then","catch","includes","error","setTimeout","finally","TaskExecuteService","taskId","taskVariables","theme","params","checkName","planId","handleSelectStep","title","subTitle","confirmFn","debug","query","from","handleEnter","result","window","confirmInfo","viewPlanId","type","showFooter","marginRight","handleGoDebug","handleGoPlanDetail","subHeader","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","scopedSlots","_u","key","fn","on","click","handleSubmitExec","_v","_s","handleCancle","handleSavePlan","proxy","mode","label","list","selectedVariable","formData","length","hasSelectAll","text","handleDeselectAll","handleSelectAll","width","model","value","callback","$$v","expression","ref","rules","property","autofocus","placeholder","keydown","$set","slot","loading","handleSubmitCreatePlan","handleCloseSave","_withStripped","component","options","__file","content","__esModule","default","module","locals","exports","add"],"sourceRoot":""}