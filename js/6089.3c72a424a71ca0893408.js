(self.webpackChunkjob=self.webpackChunkjob||[]).push([[6089],{85050:function(e,a,t){"use strict";var n=t(22696);Object.defineProperty(a,"X",{value:!0}),a.Z=void 0,t(87033),t(35948),t(94522),t(7170),t(23232),t(80433);var s=n(t(67713)),i=n(t(39986)),r=n(t(52189)),l=n(t(81920)),o={name:"",components:{GlobalVariableLayout:r.default,GlobalVariable:l.default},data:()=>({taskName:"123",taskVariables:[],isLoading:!0,isSubmiting:!1,templateId:0,taskId:0}),computed:{isSkeletonLoading(){return this.isLoading}},created(){this.taskInstanceId=this.$route.params.taskInstanceId,this.fetchData()},methods:{fetchData(){var e=this;s.default.fetchTaskInstance({id:this.taskInstanceId}).then((function(a){e.taskName=a.taskInstance.name,e.taskVariables=Object.freeze(a.variables.map((function(e){var a=e.id,t=e.name,n=e.type,s=e.value,r=e.targetValue,l=e.changeable;return{id:a,name:t,type:n,defaultValue:s,defaultTargetValue:new i.default(r||{}),changeable:l}})))})).finally((function(){e.isLoading=!1}))},handleGoExec(){var e=this;this.$refs.variable&&Promise.all(this.$refs.variable.map((function(e){return e.validate()}))).then((function(a){e.isSubmiting=!0,s.default.redoTask({taskInstanceId:e.taskInstanceId,taskVariables:a.map((function(e){return{id:e.id,name:e.name,type:e.type,value:e.value,targetValue:e.targetValue}}))}).then((function(a){var t=a.taskInstanceId;e.$bkMessage({theme:"success",message:"操作成功"}),window.changeAlert=!1,e.$router.push({name:"historyTask",params:{id:t}})})).catch((function(){e.isSubmiting=!1}))}))},handleCancle(){this.routerBack()},routerBack(){this.$router.push({name:"historyList"})}}};a.Z=o},33401:function(){},24013:function(e,a,t){"use strict";t.r(a),t.d(a,{__esModule:function(){return s.X},default:function(){return l}});var n=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:e.isLoading},expression:"{ isLoading }"}],staticClass:"setting-variable"},[t("h2",{staticClass:"title"},[e._v(e._s("全局变量"))]),e._v(" "),t("smart-action",{attrs:{"offset-target":"variable-value"},scopedSlots:e._u([{key:"action",fn:function(){return[t("bk-button",{staticClass:"w120 mr10",attrs:{theme:"primary",loading:e.isSubmiting},on:{click:e.handleGoExec}},[e._v("\n                "+e._s("执行")+"\n            ")]),e._v(" "),t("bk-button",{on:{click:e.handleCancle}},[e._v(e._s("取消"))])]},proxy:!0}])},[t("global-variable-layout",e._l(e.taskVariables,(function(e){return t("global-variable",{key:e.id,ref:"variable",refInFor:!0,attrs:{type:e.type,data:e}})})),1)],1),e._v(" "),e.taskName?t("element-teleport",[t("div",{staticStyle:{"font-size":"12px",color:"#63656e"}},[e._v("（"+e._s(e.taskName)+"）")])]):e._e()],1)};n._withStripped=!0;var s=t(85050),i=s.Z,r=(t(78842),(0,t(35471).Z)(i,n,[],!1,null,null,null));r.options.__file="src/views/executive-history/redo-task/index.vue";var l=r.exports},78842:function(e,a,t){var n=t(33401);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);(0,t(13570).Z)("7d9258cb",n,!1,{})}}]);