(self.webpackChunkjob=self.webpackChunkjob||[]).push([[7824],{95386:function(t,e,a){"use strict";a(35927),a(43364);var i=a(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,a(23232),a(80433),a(63762),a(2156),a(56259),a(95179),a(45974),a(87033),a(7170),a(9042),a(90004),a(71959),a(92974),a(57024),a(35948);var s=i(a(33610)),n=i(a(97122)),l=i(a(36410)),r=a(30651),o=i(a(60299)),c=i(a(22910)),d=i(a(15399)),u=a(41980);function p(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function h(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?p(Object(a),!0).forEach((function(e){(0,s.default)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var m={components:{OperationTag:i(a(60174)).default},props:{templateList:{type:Array,required:!0}},emit:["on-change"],setup(t,e){var a=(0,r.reactive)({isLoading:!0,isShowCreate:!1,search:"",newTagList:[{},{},{}],wholeTagList:[{},{},{}],renderList:[{},{},{}],templateNums:t.templateList.length,operationList:[{},{},{}],tagRelateNumMap:{},tagCheckInfoMap:{}}),i=(0,r.ref)(null),s={},p={},m={},f={},v=(0,r.getCurrentInstance)().proxy,g=(0,r.computed)((function(){var t=[...a.newTagList,...a.wholeTagList];if(!a.search)return t;var e=new RegExp((0,u.encodeRegexp)(a.search),"i"),i=t.filter((function(t){return e.test(t.name)}));return Object.freeze(i)}));return(0,r.onBeforeMount)((function(){a.isLoading=!0,Promise.all([o.default.fetchWholeList().then((function(t){a.wholeTagList=Object.freeze(t.reduce((function(t,e){return s[e.id]?t.unshift(e):t.push(e),t}),[]))})),c.default.fetchBasic({ids:t.templateList.map((function(t){return t.id})).join(",")}).then((function(t){t.forEach((function(t){t.tags.forEach((function(t){var e=t.id;s[e]?s[e]+=1:s[e]=1,f[e]||(f[e]={indeterminate:!0},m[e]=!0),s[e]===a.templateNums&&(delete m[e],p[e]=e,f[e]={checked:!0})}))})),a.tagRelateNumMap=Object.freeze(s),a.operationList=Object.values(p),a.tagCheckInfoMap=Object.freeze(f)}))]).then((function(){a.isLoading=!1}))})),h(h({},(0,r.toRefs)(a)),{},{scrollRef:i,renderList:g,handleSearch:function(t){a.search=(0,l.default)(t)},handleNew:function(){a.isShowCreate=!0},handleTagCheckChange:function(t,e){var i=Object.assign({},a.tagCheckInfoMap);i[e]&&i[e].checked?i[e]={checked:!1}:i[e]={checked:!0},window.changeAlert=!0,a.tagCheckInfoMap=Object.freeze(i)},handleTagNew:function(t){i.value&&i.value.scrollTo(0,0),t.isNew=!0,a.newTagList.unshift(t),window.changeAlert=!0},handleClearSearch:function(){a.search=""},submit:function(){var i=a.operationList.reduce((function(t,e){return t[e]=!0,t}),{}),s=[...a.operationList];(0,n.default)(s,(function(t){return p[t]}));var l=[];return Object.keys(p).forEach((function(t){i[t]||l.push(Number(t))})),Object.keys(m).forEach((function(t){a.tagCheckInfoMap[t].indeterminate||a.tagCheckInfoMap[t].checked||l.push(Number(t))})),c.default.batchUpdateTag({addTagIdList:s,deleteTagIdList:l,idList:t.templateList.map((function(t){return t.id}))}).then((function(){v.messageSuccess(d.default.t("template.编辑标签成功")),e.emit("on-change")}))}})}};e.Z=m},30021:function(t,e,a){"use strict";Object.defineProperty(e,"X",{value:!0}),e.Z=void 0;var i=a(41980),s="task_tag_panel_toggle",n={data(){var t=localStorage.getItem(s);return{isOpen:t=!t||JSON.parse(t),styles:{}}},mounted(){var t=(0,i.getOffset)(this.$refs.handler).top;this.styles={height:"calc(100vh  - ".concat(t,"px)")}},methods:{handleToggle(){this.isOpen=!this.isOpen,localStorage.setItem(s,JSON.stringify(this.isOpen))}}};e.Z=n},55276:function(t,e,a){"use strict";var i=a(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0;var s=i(a(56318));a(57024),a(87033),a(35948),a(94522),a(23232),a(80433),a(9042),a(85604);var n=i(a(15399)),l=i(a(22910)),r=i(a(60299)),o={name:"RenderTagTabItem",components:{TabItem:i(a(90010)).default},props:{active:{type:[String,Number],default:""}},data:()=>({isLoading:!1,classesId:1,tagId:0,list:[{},{},{}],countMap:{},isNumberLoading:!1}),computed:{totalCount(){return this.countMap.total||0},unclassifiedCount(){return this.countMap.unclassified||0},needUpdateCount(){return this.countMap.needUpdate||0}},created(){this.init()},mounted(){this.parseDefaultValueFromURL()},methods:{fetchTagList:()=>r.default.fetchWholeList(),fetchTagTemplateNum:()=>l.default.fetchTagCount(),init(){var t=this;this.isLoading=!0,Promise.all([this.fetchTagList(),this.fetchTagTemplateNum()]).then((function(e){var a=(0,s.default)(e,2),i=a[0],n=a[1];t.countMap=Object.freeze(n);var l=[];i.forEach((function(t){t.relatedTaskTemplateNum=n.tagCount[t.id]||0,l.push(t)})),t.list=Object.freeze(l),t.$emit("on-init",l)})).finally((function(){t.isLoading=!1}))},parseDefaultValueFromURL(){var t=1;if(this.$route.query.type)return t=~~this.$route.query.type||1,void this.handleClassesSelect(t);if(this.$route.query.panelTag){var e=parseInt(this.$route.query.panelTag,10);e>0&&(this.classesId=0,this.handleSelect(e))}},handleClassesSelect(t){this.classesId!==t&&(this.classesId=t,this.tagId=0,this.$emit("on-change",{type:this.classesId,panelTag:""}))},handleSelect(t){t!==this.tagId&&(this.tagId=t,this.classesId=0,this.$emit("on-change",{type:"",panelTag:this.tagId}))},handleEdit(t){var e=this;r.default.updateTag(t).then((function(){e.messageSuccess(n.default.t("template.标签名更新成功")),e.fetchTagList()}))}}};e.Z=o},88996:function(t,e,a){"use strict";var i=a(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,a(57024),a(45974),a(87033),a(70969),a(58794);var s=i(a(93435)),n=i(a(18306)),l=i(a(15399)),r=a(61681),o={name:"",props:{icon:{type:String,default:"tag"},loading:{type:Boolean,default:!0},count:{type:Number,default:0},name:{type:String,default:""},description:String,value:{type:Number},tooltipsDisabled:{type:Boolean,default:!1},id:{type:Number},canEdit:{type:Boolean,default:!1},tagList:{type:Array,default:function(){return[]}}},data(){return{displayName:this.name,isEditable:!1,error:""}},computed:{checkRenameList(){var t=this;return this.tagList.filter((function(e){return e.name!==t.name}))},errorTipsConfig(){return{placement:"top-left",content:{1:l.default.t("template.标签名不可为空"),2:l.default.t("template.标签名已存在，请重新输入"),3:r.tagNameRule.message}[this.error],width:3===this.error?200:""}}},created(){this.sefId="tag_".concat((0,n.default)(1,1e3),"_").concat(Date.now())},mounted(){var t=this;document.body.addEventListener("click",this.hideEdit),this.$once("hook:beforeDestroy",(function(){document.body.removeEventListener("click",t.hideEdit)}))},methods:{handleSelect(){this.$emit("on-select",this.id,this.name)},triggerChange(){var t=this;this.displayName!==this.name?""!==this.displayName?(0,s.default)(this.checkRenameList,(function(e){return e.name===t.displayName}))?this.error=2:r.tagNameRule.validator(this.displayName)?(this.error="",this.isEditable=!1,this.$emit("on-edit",{id:this.id,name:this.displayName})):this.error=3:this.error=1:this.isEditable=!1},handleEdit(){var t=this;document.body.click(),this.isEditable=!0,this.$nextTick((function(){t.$refs.input.focus()}))},handleChange(t){this.displayName=t.trim()},handleBlur(){this.triggerChange()},handleEnter(t,e){this.isEditable&&"Enter"===e.key&&13===e.keyCode&&this.triggerChange()},hideEdit(){this.isEditable&&(this.error||(this.isEditable=!1))}}};e.Z=o},98412:function(t,e,a){"use strict";a(45974),a(9042),a(43364);var i=a(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0;var s=i(a(33610));a(71959),a(87033),a(63762),a(7170),a(35927),a(6919);var n=i(a(15399)),l=i(a(60299)),r=i(a(22910)),o=i(a(28975)),c=i(a(49135)),d=i(a(46117)),u=a(46790),p=i(a(53823)),h=i(a(80712)),m=i(a(27452)),f=i(a(47009)),v=i(a(2645)),g=i(a(93962)),b=i(a(93738)),_=i(a(49466)),y=i(a(5071));function k(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,i)}return a}function C(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?k(Object(a),!0).forEach((function(e){(0,s.default)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var w="task_list_columns",T={name:"TaskManageList",components:{JbEditTag:p.default,ListActionLayout:h.default,RenderList:m.default,ListOperationExtend:f.default,JbSearchSelect:v.default,JbPopoverConfirm:g.default,Layout:b.default,TagPanel:_.default,BatchEditTag:y.default},data:()=>({isShowBatchEdit:!1,currentUser:{},searchValue:[],listSelect:[],backupInfo:{importJob:[],exportJob:[]},selectedTableColumn:[],tableSize:"small"}),computed:{isSkeletonLoading(){return this.$refs.list.isLoading},isExportJobDisable(){if(this.backupInfo.exportJob.length>0)return!1;for(var t=0;t<this.listSelect.length;t++){if(!this.listSelect[t].canView)return!0}return this.listSelect.length<1},isBatchEditTagDisabled(){for(var t=0;t<this.listSelect.length;t++){if(!this.listSelect[t].canEdit)return!0}return this.listSelect.length<1},allRenderColumnMap(){return this.selectedTableColumn.reduce((function(t,e){return t[e.id]=!0,t}),{})}},created(){this.searchParams={},this.searchClass={},this.listDataSource=r.default.taskList,this.searchData=[{name:"ID",id:"templateId",description:n.default.t("template.将覆盖其它条件"),validate:(t,e)=>!!(t||[]).every((function(t){return/^(\d*)$/.test(t.name)}))||n.default.t("template.ID只支持数字")},{name:n.default.t("template.作业模板名称"),id:"name",default:!0},{name:n.default.t("template.场景标签.colHead"),id:"tags",remoteMethod:l.default.fetchTagOfSearch,remoteExecuteImmediate:!0},{name:n.default.t("template.更新人.colHead"),id:"lastModifyUser",remoteMethod:d.default.fetchUsersOfSearch,inputInclude:!0},{name:n.default.t("template.创建人"),id:"creator",remoteMethod:d.default.fetchUsersOfSearch,inputInclude:!0}],this.tableColumn=[{id:"id",label:"ID"},{id:"name",label:n.default.t("template.作业模板名称"),disabled:!0},{id:"tags",label:n.default.t("template.场景标签.colHead")},{id:"statusText",label:n.default.t("template.状态")},{id:"creator",label:n.default.t("template.创建人")},{id:"createTime",label:n.default.t("template.创建时间")},{id:"lastModifyUser",label:n.default.t("template.更新人.colHead")},{id:"lastModifyTime",label:n.default.t("template.更新时间")}];var t=u.listColumnsCache.getItem(w);t?(this.selectedTableColumn=Object.freeze(t.columns),this.tableSize=t.size):this.selectedTableColumn=Object.freeze([{id:"name"},{id:"tags"},{id:"lastModifyUser"},{id:"lastModifyTime"}])},mounted(){this.fetchUserInfo(),this.fetchBackup()},methods:{fetchData(){var t=C({},this.searchParams);this.searchClass.type&&(t.type=this.searchClass.type),this.searchClass.panelTag&&(t.panelTag=this.searchClass.panelTag),this.$refs.list.$emit("onFetch",t)},fetchUserInfo(){var t=this;c.default.fetchUserInfo().then((function(e){t.currentUser=e}))},fetchBackup(){var t=this;o.default.fetchInfo().then((function(e){t.backupInfo=Object.freeze(e)}))},handleSettingChange(t){var e=t.fields,a=t.size;this.selectedTableColumn=Object.freeze(e),this.tableSize=a,u.listColumnsCache.setItem(w,{columns:e,size:a})},handleTagPlanChange(t){this.searchClass=t,this.fetchData()},handleSearch(t){this.searchParams=t,this.fetchData()},handleCreate(){this.$router.push({name:"templateCreate",query:{from:"list"}})},handleImport(){this.$router.push({name:"taskImport"})},handleExport(){var t=this,e=function(){t.$router.push({name:"taskExport"}),u.taskExport.setItem("ids",t.listSelect.map((function(t){return t.id})))};this.backupInfo.exportJob.length>0&&this.listSelect.length>0?this.$bkInfo({title:n.default.t("template.上一次任务还未完成"),subTitle:n.default.t("template.您上一次的任务还在后台运行中，请先等待完成后再发起新的任务。"),okText:n.default.t("template.查看"),cancelText:n.default.t("template.返回"),confirmFn:e}):e()},handleBatchEditTag(){this.isShowBatchEdit=!0},handleBatchEditChange(){this.fetchData(),this.$refs.tagPanelRef.init()},handleMyTask(){var t=this.currentUser.username,e={name:n.default.t("template.创建人"),id:"creator",values:[{id:t,name:t}]};this.searchParams=C(C({},this.searchParams),{},{creator:t}),this.searchValue=[e],this.fetchData()},handleUpdateTask(t,e){var a=this,i=t.id,s=t.name,n=t.description;return r.default.taskUpdateBasic({id:i,name:s,description:n,tags:e.tags}).then((function(){a.$refs.tagPanelRef.init()}))},handleSelection(t){this.listSelect=Object.freeze(t)},handleEdit(t){this.$router.push({name:"templateEdit",params:{id:t},query:{from:"list"}})},handleClone(t){this.$router.push({name:"templateClone",params:{id:t},query:{from:"list"}})},handleDelete(t){var e=this;return r.default.taskDelete({id:t}).then((function(){return e.fetchData(),e.messageSuccess(n.default.t("template.删除模板成功")),e.$refs.tagPanelRef.init(),!0}))},handleCollection(t){var e=this;(t.favored?r.default.taskDeleteFavorite:r.default.taskUpdateFavorite)({id:t.id}).then((function(){t.toggleFavored(),e.messageSuccess(t.favored?n.default.t("template.收藏成功"):n.default.t("template.取消收藏成功"))}))}}};e.Z=T},17252:function(){},96737:function(){},3691:function(){},32547:function(){},27502:function(){},5071:function(t,e,a){"use strict";a.r(e),a.d(e,{__esModule:function(){return s.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.isLoading},expression:"{ isLoading }"}],staticClass:"task-manage-batch-edit-tag"},[a("div",{staticStyle:{"margin-bottom":"8px"}},[t._v("\n        "+t._s(t.$t("template.范围"))+"："+t._s(t.$t("template.共"))),a("span",{staticClass:"strong number"},[t._v(t._s(t.templateNums))]),t._v(t._s(t.$t("template.个作业"))+"\n    ")]),t._v(" "),a("jb-form",{attrs:{"form-type":"vertical"}},[a("jb-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{label:t.$t("template.标签"),required:""}},[a("div",{staticClass:"tag-panel"},[a("bk-input",{staticClass:"tag-search",attrs:{spellcheck:!1,"left-icon":"bk-icon icon-search",value:t.search},on:{change:t.handleSearch}}),t._v(" "),a("div",{staticClass:"wrapper",staticStyle:{height:"210px"}},[t.renderList.length>0?a("scroll-faker",{ref:"scrollRef"},[a("bk-checkbox-group",{staticClass:"tag-list",model:{value:t.operationList,callback:function(e){t.operationList=e},expression:"operationList"}},t._l(t.renderList,(function(e){return a("bk-checkbox",t._b({key:e.id,staticClass:"tag-item",attrs:{value:e.id},on:{change:function(a){return t.handleTagCheckChange(a,e.id)}}},"bk-checkbox",t.tagCheckInfoMap[e.id],!1),[t._v("\n                                "+t._s(e.name)+"\n                                "),t.tagCheckInfoMap[e.id]?[t.tagCheckInfoMap[e.id].checked?a("span",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.right",value:t.$t("template.勾选范围里，全部作业使用"),expression:"$t('template.勾选范围里，全部作业使用')",modifiers:{right:!0}}],staticClass:"relate-all"},[t._v("\n                                        All\n                                    ")]):t._e(),t._v(" "),t.tagCheckInfoMap[e.id].indeterminate?a("span",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.right",value:t.$t("template.勾选范围里，有")+" "+t.tagRelateNumMap[e.id]+" "+t.$t("template.个作业使用"),expression:"`${$t('template.勾选范围里，有')} ${tagRelateNumMap[tagItem.id]} ${$t('template.个作业使用')}`",modifiers:{right:!0}}],staticClass:"relate-nums"},[t._v("\n                                        "+t._s(t.tagRelateNumMap[e.id])+"/"+t._s(t.templateNums)+"\n                                    ")]):t._e()]:t._e(),t._v(" "),e.isNew?a("span",{staticClass:"new-tag-flag"},[t._v("\n                                    new\n                                ")]):t._e()],2)})),1)],1):t.search?a("Empty",{staticStyle:{"margin-top":"20px"},attrs:{type:"search"}},[a("span",[t._v(t._s(t.$t("template.搜索结果为空"))+"，")]),t._v(" "),a("bk-button",{attrs:{text:""},on:{click:t.handleClearSearch}},[t._v(t._s(t.$t("template.清空搜索")))])],1):t._e()],1),t._v(" "),a("auth-component",{attrs:{auth:"tag/create"}},[a("div",{staticClass:"tag-create",on:{click:t.handleNew}},[a("bk-icon",{staticStyle:{"margin-right":"8px","font-size":"16px"},attrs:{type:"plus-circle"}}),t._v(" "),a("span",[t._v(t._s(t.$t("template.新建标签")))])],1),t._v(" "),a("div",{staticClass:"tag-create",attrs:{slot:"forbid"},slot:"forbid"},[a("bk-icon",{staticStyle:{"margin-right":"8px","font-size":"16px"},attrs:{type:"plus-circle"}}),t._v(" "),a("span",[t._v(t._s(t.$t("template.新建标签")))])],1)])],1)])],1),t._v(" "),a("lower-component",{attrs:{level:"custom",custom:t.isShowCreate}},[a("operation-tag",{on:{"on-change":t.handleTagNew},model:{value:t.isShowCreate,callback:function(e){t.isShowCreate=e},expression:"isShowCreate"}})],1)],1)};i._withStripped=!0;var s=a(95386),n=s.Z,l=(a(58236),(0,a(35471).Z)(n,i,[],!1,null,null,null));l.options.__file="src/views/task-manage/list/components/batch-edit-tag.vue";var r=l.exports},93738:function(t,e,a){"use strict";a.r(e),a.d(e,{__esModule:function(){return s.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"handler",staticClass:"task-layout"},[a("div",{class:{"layout-left":!0,expended:t.isOpen}},[a("scroll-faker",{style:t.styles},[a("div",[t._t("tag")],2)])],1),t._v(" "),a("div",{staticClass:"layout-right"},[a("div",{staticClass:"toggle-button",on:{click:t.handleToggle}},[a("Icon",{staticClass:"toggle-arrow",class:{open:t.isOpen},attrs:{type:"down-small"}})],1),t._v(" "),t._t("default")],2)])};i._withStripped=!0;var s=a(30021),n=s.Z,l=(a(2166),(0,a(35471).Z)(n,i,[],!1,null,null,null));l.options.__file="src/views/task-manage/list/components/layout.vue";var r=l.exports},49466:function(t,e,a){"use strict";a.r(e),a.d(e,{__esModule:function(){return s.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.isLoading},expression:"{ isLoading }"}],staticClass:"template-list-tag-panel"},[a("tab-item",{attrs:{name:t.$t("template.全部作业"),id:1,value:t.classesId,icon:"business-manage",count:t.totalCount,"tooltips-disabled":!0},on:{"on-select":t.handleClassesSelect}}),t._v(" "),a("tab-item",{attrs:{name:t.$t("template.未分类"),id:2,value:t.classesId,icon:"unclassified",count:t.unclassifiedCount,"tooltips-disabled":!0},on:{"on-select":t.handleClassesSelect}}),t._v(" "),a("tab-item",{attrs:{name:t.$t("template.待更新"),id:3,value:t.classesId,icon:"update",count:t.needUpdateCount,"tooltips-disabled":!0},on:{"on-select":t.handleClassesSelect}}),t._v(" "),a("div",{staticClass:"line"}),t._v(" "),t._l(t.list,(function(e){return[e.relatedTaskTemplateNum>0?a("tab-item",{key:e.id,attrs:{id:e.id,count:e.relatedTaskTemplateNum,name:e.name,description:e.description,value:t.tagId,"can-edit":!0,"tag-list":t.list},on:{"on-select":t.handleSelect,"on-edit":t.handleEdit}}):t._e()]}))],2)};i._withStripped=!0;var s=a(55276),n=s.Z,l=(a(75432),(0,a(35471).Z)(n,i,[],!1,null,"56307de0",null));l.options.__file="src/views/task-manage/list/components/tag-panel/index.vue";var r=l.exports},90010:function(t,e,a){"use strict";a.r(e),a.d(e,{__esModule:function(){return s.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"task-list-tag-edit",class:{active:t.value===t.id,display:!t.canEdit,edit:t.canEdit,"edit-error":!!t.error},on:{click:function(t){t.stopPropagation()}}},[a("Icon",{staticClass:"tag-flag",attrs:{type:t.icon}}),t._v(" "),t.isEditable?[a("bk-input",{ref:"input",attrs:{placeholder:t.$t("template.请输入标签名..."),value:t.displayName},on:{change:t.handleChange,blur:t.handleBlur,keyup:t.handleEnter}}),t._v(" "),t.error?a("div",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:t.errorTipsConfig,expression:"errorTipsConfig"}],staticClass:"input-edit-info"},[a("Icon",{attrs:{type:"info"}})],1):t._e()]:[a("div",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:{allowHtml:!0,width:240,distance:15,trigger:"mouseenter",theme:"light",content:"#"+t.sefId,placement:"right-start",boundary:"window",disabled:t.tooltipsDisabled},expression:"{\n                allowHtml: true,\n                width: 240,\n                distance: 15,\n                trigger: 'mouseenter',\n                theme: 'light',\n                content: `#${sefId}`,\n                placement: 'right-start',\n                boundary: 'window',\n                disabled: tooltipsDisabled,\n            }"}],staticClass:"tag-name",on:{click:t.handleSelect}},[a("div",{directives:[{name:"bk-overflow-tips",rawName:"v-bk-overflow-tips"}],staticClass:"name-text"},[t._v("\n                "+t._s(t.displayName)+"\n            ")])]),t._v(" "),a("div",{staticClass:"tag-num-box"},[a("span",{staticClass:"tag-num"},[t._v(t._s(t.count))])]),t._v(" "),t.canEdit?a("auth-component",{attrs:{auth:"tag/edit","resource-id":t.id}},[a("div",{staticClass:"edit-action",on:{click:t.handleEdit}},[a("Icon",{attrs:{type:"edit-2"}})],1),t._v(" "),a("div",{staticClass:"edit-action",attrs:{slot:"forbid"},slot:"forbid"},[a("Icon",{attrs:{type:"edit-2"}})],1)]):t._e()],t._v(" "),a("div",{staticStyle:{display:"none"}},[a("table",{staticStyle:{"font-size":"12px","line-height":"24px",color:"#63656e"},attrs:{id:t.sefId}},[a("tr",[a("td",{staticStyle:{color:"#979ba5","text-align":"right","white-space":"nowrap","vertical-align":"top"}},[t._v("标签名称：")]),t._v(" "),a("td",{staticStyle:{"word-break":"break-all","vertical-align":"top"}},[t._v(t._s(t.displayName))])]),t._v(" "),a("tr",[a("td",{staticStyle:{color:"#979ba5","text-align":"right","white-space":"nowrap","vertical-align":"top"}},[t._v("标签描述：")]),t._v(" "),a("td",{staticStyle:{"word-break":"break-all","vertical-align":"top"}},[t._v(t._s(t.description||"--"))])])])])],2)};i._withStripped=!0;var s=a(88996),n=s.Z,l=(a(21287),(0,a(35471).Z)(n,i,[],!1,null,null,null));l.options.__file="src/views/task-manage/list/components/tag-panel/tab-item.vue";var r=l.exports},87824:function(t,e,a){"use strict";a.r(e),a.d(e,{__esModule:function(){return s.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Layout",{staticClass:"template-list-page",scopedSlots:t._u([{key:"tag",fn:function(){return[a("tag-panel",{ref:"tagPanelRef",on:{"on-change":t.handleTagPlanChange}})]},proxy:!0}])},[t._v(" "),a("list-action-layout",{scopedSlots:t._u([{key:"right",fn:function(){return[a("jb-search-select",{ref:"search",staticStyle:{width:"420px"},attrs:{"append-value":t.searchValue,data:t.searchData,placeholder:t.$t("template.输入 作业模板名、标签名 或 更新人 进行搜索...")},on:{"on-change":t.handleSearch}}),t._v(" "),a("bk-button",{on:{click:t.handleMyTask}},[t._v(t._s(t.$t("template.我的作业")))])]},proxy:!0}])},[a("auth-button",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"templateCreate"},expression:"{ type: 'button', value: 'templateCreate' }"}],staticClass:"w120 mr10",attrs:{theme:"primary",auth:"job_template/create"},on:{click:t.handleCreate}},[t._v("\n            "+t._s(t.$t("template.新建"))+"\n        ")]),t._v(" "),a("bk-badge",{staticClass:"mr10",attrs:{theme:"#3a84ff",visible:t.backupInfo.importJob.length>0,val:t.backupInfo.importJob.length}},[a("span",{attrs:{"tippy-tips":t.backupInfo.importJob.length>0?t.$t("template.有一项导入任务正在进行中"):""}},[a("auth-button",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"templateImport"},expression:"{ type: 'button', value: 'templateImport' }"}],attrs:{auth:"job_template/create"},on:{click:t.handleImport}},[t._v("\n                    "+t._s(t.$t("template.导入"))+"\n                ")])],1)]),t._v(" "),a("bk-badge",{staticClass:"mr10",attrs:{theme:"#3a84ff",visible:t.backupInfo.exportJob.length>0,val:t.backupInfo.exportJob.length}},[a("span",{attrs:{"tippy-tips":t.backupInfo.exportJob.length>0?t.$t("template.有一项导出任务正在进行中"):""}},[a("bk-button",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"templateExport"},expression:"{ type: 'button', value: 'templateExport' }"}],on:{click:t.handleExport}},[t._v("\n                    "+t._s(t.$t("template.导出"))+"\n                ")])],1)]),t._v(" "),a("bk-button",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"templateTagEdit"},expression:"{ type: 'button', value: 'templateTagEdit' }"}],on:{click:t.handleBatchEditTag}},[t._v("\n            "+t._s(t.$t("template.编辑标签"))+"\n        ")])],1),t._v(" "),a("div",{staticClass:"task-list-wraper"},[a("render-list",{directives:[{name:"test",rawName:"v-test",value:{type:"list",value:"template"},expression:"{ type: 'list', value: 'template' }"}],ref:"list",attrs:{"data-source":t.listDataSource,selectable:"",size:t.tableSize,"search-control":function(){return t.$refs.search}},on:{"on-selection-change":t.handleSelection}},[t.allRenderColumnMap.id?a("bk-table-column",{key:"id",attrs:{label:"ID",width:"120",prop:"id",align:"left"}}):t._e(),t._v(" "),t.allRenderColumnMap.name?a("bk-table-column",{key:"name",attrs:{"class-name":"task-name-column",label:t.$t("template.作业模板名称"),prop:"name","min-width":"300",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("div",{staticClass:"task-name-box"},[a("Icon",{staticClass:"task-collection",class:i.favored?"favored":"unfavored",attrs:{type:"collection"},on:{click:function(e){return t.handleCollection(i)}}}),t._v(" "),a("auth-router-link",{directives:[{name:"bk-overflow-tips",rawName:"v-bk-overflow-tips"}],staticClass:"task-name-text",attrs:{permission:i.canView,auth:"job_template/view","resource-id":i.id,to:{name:"templateDetail",params:{id:4}}}},[t._v("\n                            {'row.name' || row.name }}\n                        ")]),t._v(" "),a("auth-router-link",{attrs:{permission:i.canView,auth:"job_template/view","resource-id":i.id,to:{name:"templateDetail",params:{id:4},query:{mode:"scriptUpdate"}}}},[t._v("\n                            123123\n                            "),a("span",{domProps:{innerHTML:t._s(i.scriptStatusHtml)}})])],1)]}}],null,!1,3498184813)}):t._e(),t._v(" "),t.allRenderColumnMap.tags?a("bk-table-column",{key:"tags",attrs:{label:t.$t("template.场景标签.colHead"),prop:"tags",width:"200",align:"left","class-name":"edit-tag-column"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("auth-component",{attrs:{permission:i.canEdit,auth:"job_template/edit","resource-id":i.id}},[a("jb-edit-tag",{key:i.id,attrs:{field:"tags",value:i.tags,shortcurt:"","remote-hander":function(e){return t.handleUpdateTask(i,e)}}}),t._v(" "),a("div",{attrs:{slot:"forbid"},slot:"forbid"},[t._v(t._s(i.tagText))])],1)]}}],null,!1,1512189156)}):t._e(),t._v(" "),t.allRenderColumnMap.statusText?a("bk-table-column",{key:"statusText",attrs:{label:t.$t("template.状态"),width:"100",prop:"statusText",align:"left"}}):t._e(),t._v(" "),t.allRenderColumnMap.creator?a("bk-table-column",{key:"creator",attrs:{label:t.$t("template.创建人"),width:"120",prop:"creator",align:"left"}}):t._e(),t._v(" "),t.allRenderColumnMap.createTime?a("bk-table-column",{key:"createTime",attrs:{label:t.$t("template.创建时间"),prop:"createTime",width:"180",align:"left"}}):t._e(),t._v(" "),t.allRenderColumnMap.lastModifyUser?a("bk-table-column",{key:"lastModifyUser",attrs:{label:t.$t("template.更新人.colHead"),width:"160",prop:"lastModifyUser",align:"left"}}):t._e(),t._v(" "),t.allRenderColumnMap.lastModifyTime?a("bk-table-column",{key:"lastModifyTime",attrs:{label:t.$t("template.更新时间"),width:"180",prop:"lastModifyTime",align:"left"}}):t._e(),t._v(" "),a("bk-table-column",{key:"action",attrs:{resizable:!1,fixed:"right",label:t.$t("template.操作"),width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[a("router-link",{directives:[{name:"test",rawName:"v-test",value:{type:"link",value:"planDetail"},expression:"{ type: 'link', value: 'planDetail' }"}],staticClass:"mr10",attrs:{to:{name:"viewPlan",params:{templateid:4}}}},[t._v("\n                        "+t._s(t.$t("template.执行方案.label"))+"\n                    ")]),t._v(" "),a("router-link",{directives:[{name:"test",rawName:"v-test",value:{type:"link",value:"debugTemplate"},expression:"{ type: 'link', value: 'debugTemplate' }"}],staticClass:"mr10",attrs:{to:{name:"debugPlan",params:{id:4},query:{from:"taskList"}}}},[t._v("\n                        "+t._s(t.$t("template.调试"))+"\n                    ")]),t._v(" "),a("list-operation-extend",[a("auth-component",{attrs:{permission:i.canEdit,auth:"job_template/edit","resource-id":i.id}},[a("div",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"editTemplate"},expression:"{ type: 'button', value: 'editTemplate' }"}],staticClass:"action-item",on:{click:function(e){return t.handleEdit(i.id)}}},[t._v("\n                                "+t._s(t.$t("template.编辑"))+"\n                            ")]),t._v(" "),a("div",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"editTemplate"},expression:"{ type: 'button', value: 'editTemplate' }"}],staticClass:"action-item",attrs:{slot:"forbid"},slot:"forbid"},[t._v("\n                                "+t._s(t.$t("template.编辑"))+"\n                            ")])]),t._v(" "),a("auth-component",{attrs:{permission:i.canCreate&&i.canView,auth:"job_template/clone","resource-id":i.id}},[a("div",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"cloneTemplate"},expression:"{ type: 'button', value: 'cloneTemplate' }"}],staticClass:"action-item",on:{click:function(e){return t.handleClone(i.id)}}},[t._v("\n                                "+t._s(t.$t("template.克隆"))+"\n                            ")]),t._v(" "),a("div",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"cloneTemplate"},expression:"{ type: 'button', value: 'cloneTemplate' }"}],staticClass:"action-item",attrs:{slot:"forbid"},slot:"forbid"},[t._v("\n                                "+t._s(t.$t("template.克隆"))+"\n                            ")])]),t._v(" "),a("jb-popover-confirm",{attrs:{title:t.$t("template.确定删除该作业？"),content:t.$t("template.注意！模板下关联的所有执行方案也将被清除"),"confirm-handler":function(){return t.handleDelete(i.id)}}},[a("auth-component",{attrs:{permission:i.canDelete,auth:"job_template/delete","resource-id":i.id}},[a("div",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"deleteTemplate"},expression:"{ type: 'button', value: 'deleteTemplate' }"}],staticClass:"action-item"},[t._v("\n                                    "+t._s(t.$t("template.删除"))+"\n                                ")]),t._v(" "),a("div",{directives:[{name:"test",rawName:"v-test",value:{type:"button",value:"deleteTemplate"},expression:"{ type: 'button', value: 'deleteTemplate' }"}],staticClass:"action-item",attrs:{slot:"forbid"},slot:"forbid"},[t._v("\n                                    "+t._s(t.$t("template.删除"))+"\n                                ")])])],1)],1)]}}])}),t._v(" "),a("bk-table-column",{attrs:{type:"setting"}},[a("bk-table-setting-content",{attrs:{fields:t.tableColumn,selected:t.selectedTableColumn,size:t.tableSize},on:{"setting-change":t.handleSettingChange}})],1)],1)],1),t._v(" "),a("jb-dialog",{attrs:{title:t.$t("template.编辑标签"),"header-position":"left","ok-text":t.$t("template.确定"),width:480},model:{value:t.isShowBatchEdit,callback:function(e){t.isShowBatchEdit=e},expression:"isShowBatchEdit"}},[t.isShowBatchEdit?a("batch-edit-tag",{attrs:{"template-list":t.listSelect},on:{"on-change":t.handleBatchEditChange}}):t._e()],1)],1)};i._withStripped=!0;var s=a(98412),n=s.Z,l=(a(19637),(0,a(35471).Z)(n,i,[],!1,null,null,null));l.options.__file="src/views/task-manage/list/index.vue";var r=l.exports},58236:function(t,e,a){var i=a(17252);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,a(13570).Z)("4d2f5a15",i,!1,{})},2166:function(t,e,a){var i=a(96737);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,a(13570).Z)("6c57af55",i,!1,{})},75432:function(t,e,a){var i=a(3691);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,a(13570).Z)("39f101fb",i,!1,{})},21287:function(t,e,a){var i=a(32547);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,a(13570).Z)("934d9fc0",i,!1,{})},19637:function(t,e,a){var i=a(27502);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,a(13570).Z)("b2b4f382",i,!1,{})}}]);