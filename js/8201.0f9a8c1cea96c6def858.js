(self.webpackChunkjob=self.webpackChunkjob||[]).push([[8201],{12939:function(t,e,s){"use strict";var i=s(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,s(57024),s(87033),s(35948),s(94522),s(23232),s(80433),s(7170);var a=i(s(67713)),n=i(s(72075)),o=i(s(42472)),r={name:"",components:{TaskStepView:i(s(86136)).default},props:{taskId:{type:Number,required:!0},id:{type:[Number,String]}},data:()=>({isLoading:!0,stepInfo:{},variableList:[]}),created(){var t=this;this.isLoading=!0,Promise.all([this.fetchStep(),this.fetchTaskVariables()]).finally((function(){t.isLoading=!1}))},methods:{fetchStep(){var t=this;return a.default.fetchStepInstance({id:this.id}).then((function(e){t.stepInfo=Object.freeze(new n.default(e))}))},fetchTaskVariables(){var t=this;return a.default.fetchStepInstanceParam({id:this.taskId}).then((function(e){t.variableList=Object.freeze(e.map((function(t){var e=t.id,s=t.name,i=t.type,a=t.value,n=t.targetValue;return new o.default({id:e,name:s,type:i,defaultValue:a,defaultTargetValue:n})})))}))}}};e.Z=r},46863:function(t,e,s){"use strict";var i=s(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,s(57024),s(7170),s(23232),s(87033),s(80433),s(46904),s(63762),s(2156),s(95179);var a=i(s(14103)),n=i(s(67713)),o={name:"",props:{stepInstanceId:{type:Number,required:!0},retryCount:{type:[Number,String],default:0}},data:()=>({isNeedRender:!1,executionList:[]}),computed:{retryCountText(){for(var t=0;t<this.executionList.length;t++)if(this.executionList[t].retryCount===this.retryCount)return this.executionList[t].text;return"LATEST"}},watch:{stepInstanceId:{handler(t){this.popperDestroy(),t&&this.fetchStepExecutionHistory()},immediate:!0}},beforeDestroy(){this.popperDestroy()},methods:{reLoading(){this.fetchStepExecutionHistory()},fetchStepExecutionHistory(){var t=this;n.default.fetchStepExecutionHistory({stepInstanceId:this.stepInstanceId}).then((function(e){var s=(0,a.default)(e.map((function(t){return t.retryCount}))),i=e.map((function(t){var e,i,a,n=t.retryCount;return{retryCount:n,createTime:t.createTime,text:n!==s?(e=n+1,i=e%10,a=e%100,"".concat(e,1===i&&11!==a?" st":2===i&&12!==a?" nd":3===i&&13!==a?" rd":" th")):"LATEST"}}));t.executionList=Object.freeze(i),t.isNeedRender=t.executionList.length>1,t.isNeedRender?t.$nextTick((function(){t.popperInstance||(t.popperInstance=t.$bkPopover(t.$el,{theme:"light step-execution-history-menu",arrow:!1,interactive:!0,placement:"bottom-start",content:t.$refs.content,animation:"slide-toggle",trigger:"click",width:"240px"}))})):t.popperDestroy()}))},popperDestroy(){this.popperInstance&&(this.popperInstance.destroy(),this.popperInstance=null)},handleSelectRetryCount(t){this.selectRetryCount=t,this.popperInstance&&this.popperInstance.hide(),this.$emit("on-change",t);var e=new URLSearchParams(window.location.search);e.set("retryCount",t),window.history.replaceState({},"","?".concat(e.toString()))}}};e.Z=o},22552:function(t,e,s){"use strict";s(35927),s(45974),s(9042),s(43364);var i=s(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,s(57024),s(70201),s(87033),s(35948),s(94522),s(71959);var a=i(s(33610)),n=i(s(45812)),o=i(s(67713)),r=s(41980),l=i(s(21844));function c(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}var u={name:"",components:{FileItem:i(s(65518)).default},mixins:[l.default],props:{name:String,stepInstanceId:{type:Number,required:!0},ip:{type:String},retryCount:{type:Number,required:!0},mode:{type:String,required:!0}},data:()=>({isLoading:!0,isAsyncContentLoading:!1,contentList:[],onePageNums:0,page:0,pageSize:10,openMemo:{},renderContentMap:{}}),computed:{renderNums(){return this.onePageNums+this.pageSize*this.page},renderList(){return this.contentList.slice(0,this.renderNums)}},watch:{name:{handler(){this.isLoading=!0,this.isMemoChange=!1,this.page=0,this.fetchData(),this.$refs.contentBox&&(this.$refs.contentBox.scrollTop=0)},immediate:!0}},created(){this.isMemoChange=!1,this.timer=null,this.includingLogContent=""},mounted(){var t=this;this.calcFirstPageNums(),window.addEventListener("resize",this.handleScroll),this.$once("hook:beforeDestroy",(function(){window.removeEventListener("resize",t.handleScroll)}))},methods:{fetchData(){var t=this;if(!this.ip)return this.isLoading=!1,void(this.contentList=[]);o.default.fetchFileLogOfIp({stepInstanceId:this.stepInstanceId,retryCount:this.retryCount,ip:this.ip,mode:this.mode}).then((function(e){var s=e.fileDistributionDetails,i=e.includingLogContent,a=e.finished;t.contentList=Object.freeze(s),t.includingLogContent=i,t.contentList.length>0&&!t.isMemoChange&&(t.openMemo={[t.contentList[0].taskId]:!0},t.isMemoChange=!0),t.fetchFileLogOfFile(),a||t.$pollingQueueRun(t.fetchData)})).finally((function(){t.isLoading=!1}))},fetchFileLogOfFile:(0,n.default)((function(){var t=this;this.includingLogContent||(this.isAsyncContentLoading=!0,o.default.fetchFileLogOfFile({stepInstanceId:this.stepInstanceId,retryCount:this.retryCount,taskIds:Object.keys(this.openMemo)}).then((function(e){t.renderContentMap=Object.freeze(e.reduce((function(t,e){return t[e.taskId]=e.logContent,t}),{}))})).finally((function(){t.isAsyncContentLoading=!1})))}),500),resize(){this.handleScroll()},calcFirstPageNums(){var t=window.innerHeight,e=(0,r.getOffset)(this.$refs.contentBox).top;this.onePageNums=Math.ceil((t-e)/34)+3},handleScroll:(0,n.default)((function(){var t=this;this.$refs.load&&(window.innerHeight+50>this.$refs.load.getBoundingClientRect().top&&!this.timer&&(this.timer=setTimeout((function(){t.page+=1,t.timer=0}),350)))}),80),handleToggle(t,e){var s=function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?c(Object(s),!0).forEach((function(e){(0,a.default)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):c(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},this.openMemo);s[t]=e,this.openMemo=Object.freeze(s),e&&this.fetchFileLogOfFile()}}};e.Z=u},27693:function(t,e,s){"use strict";Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,s(85604);var i={1:"waiting",2:"uploading",3:"downloading",4:"finished",5:"failed"},a={functional:!0,render(t,e){var s=e.props,a=e.listeners,n=e.parent,o=s.data,r=s.openMemo,l=s.renderContentMap,c=s.isContentLoading,u=Boolean(r[o.taskId]),d={"step-detail-file-log-block":!0,[i[o.status]]:!0,toggle:u},p=l[o.taskId]||o.logContent;c&&!p&&(d["content-loading"]=!0);var h,v;return t("div",{class:d},[t("div",{class:"log-header",on:{click:function(){a["on-toggle"](o.taskId,!u)}}},[t("i",{class:"job-icon job-icon-down-small log-toggle"}),t("span",[n.$t("history.文件名"),"：",o.fileName]),t("span",[n.$t("history.文件大小"),"：",o.fileSize]),t("span",[n.$t("history.状态.log"),"：",t("span",{class:"status"},[o.statusDesc])]),t("span",[n.$t("history.源服务器 IP"),"：",o.srcIp]),t("span",[n.$t("history.速率"),"：",o.speed]),t("span",[n.$t("history.进度"),"：",o.progress])]),u&&t("div",{class:"log-body"},[t("div",{class:"log-content"},[p]),t("div",{class:"log-process"},[(h="*******************************************************************************************",v=parseInt(o.progress,10)/100,h.slice(0,Math.floor(v*h.length)||1))])])])}};e.Z=a},63246:function(t,e,s){"use strict";var i=s(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,s(57024),s(85604);var a=i(s(15399)),n=i(s(67713)),o=i(s(4695)),r=i(s(96285)),l=i(s(1480)),c="step_execution_font_size",u="script_log_line_feed",d={name:"",inheritAttrs:!1,props:{name:String,host:{type:Object,required:!0},stepInstanceId:{type:Number},retryCount:{type:Number,required:!0},isTask:{type:Boolean,default:!1},isFile:{type:Boolean,default:!1}},data(){var t=parseInt(localStorage.getItem(c),10);return!t||t<12?t=12:t>14&&(t=14),{activePanel:"",isFullscreen:!1,isFontSet:!1,fontSize:t,isScriptLogLineFeed:Boolean(localStorage.getItem(u))}},computed:{renderCom(){return{scriptLog:o.default,download:r.default,upload:r.default,variable:l.default}[this.activePanel]},boxStyles(){return this.isFullscreen?{position:"fixed",top:0,right:0,bottom:0,left:0,zIndex:window.__bk_zIndex_manager.nextZIndex()}:{}},contentStyles(){return{fontSize:"".concat(this.fontSize,"px"),lineHeight:"".concat({12:20,13:21,14:22}[this.fontSize],"px")}}},watch:{isFile:{handler(t){this.activePanel=t?"download":"scriptLog"},immediate:!0}},beforeDestroy(){this.handleExitFullscreen()},mounted(){var t=this;window.addEventListener("keyup",this.handleExitByESC),this.$once("hook:beforeDestroy",(function(){window.removeEventListener("keyup",t.handleExitByESC)}))},methods:{handleTogglePanel(t){this.activePanel=t},handleDownload(){var t=this;n.default.fetchStepExecutionLogFile({id:this.stepInstanceId,ip:this.host.ip}).then((function(){t.$bkMessage({theme:"success",message:a.default.t("history.导出日志操作成功")})}))},handleShowSetFont(){this.isFontSet=!0},handleHideSetFont(){this.isFontSet=!1},handleFontChange(t){this.fontSize=t,localStorage.setItem(c,t)},handleFullscreen(){this.isFullscreen=!0,this.messageInfo(a.default.t("history.按 Esc 即可退出全屏模式")),this.infoBoxParentNode=this.$refs.infoBox.parentNode,document.body.appendChild(this.$refs.infoBox),this.$refs.view&&this.$refs.view.resize()},handleExitFullscreen(t){var e=this;this.isFullscreen=!1,this.infoBoxParentNode&&(this.infoBoxParentNode.appendChild(this.$refs.infoBox),this.infoBoxParentNode=null),setTimeout((function(){e.$refs.view&&e.$refs.view.resize()}))},handleExitByESC(t){27===t.keyCode&&this.handleExitFullscreen()},handleScriptLogLineFeedChange(t){this.isScriptLogLineFeed=t,t?localStorage.setItem(u,!0):localStorage.removeItem(u)}}};e.Z=d},18218:function(t,e,s){"use strict";var i=s(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,s(57024),s(87033),s(35948),s(94522);var a=i(s(36410)),n=i(s(77789));s(92127),s(76914),s(88817);var o=i(s(15399)),r=i(s(67713)),l={mixins:[i(s(21844)).default],props:{name:String,stepInstanceId:{type:Number,required:!0},ip:{type:String},retryCount:{type:Number,required:!0},logFilter:{type:String,default:""},fontSize:{type:Number,default:12},lineFeed:{type:Boolean,default:!0}},data:()=>({isLoading:!0,isRunning:!1,isWillAutoScroll:!0}),watch:{name:{handler(){this.isLoading=!0,this.autoScrollTimeout(),this.fetchLogContent()},immediate:!0},fontSize:{handler(t){this.editor.setFontSize(t)}},lineFeed:{handler(t){var e=this;setTimeout((function(){e.editor&&e.editor.setOptions({wrap:t?"free":"none"})}))},immediate:!0}},created(){this.backTopTips={content:o.default.t("history.回到顶部"),placements:["top"],theme:"light"},this.backBottomTips={content:o.default.t("history.前往底部"),placements:["top"],theme:"light"}},mounted(){this.initEditor()},methods:{fetchLogContent(){var t=this;if(!this.ip)return this.isLoading=!1,void(this.editor&&(this.editor.setValue(""),this.editor.clearSelection()));r.default.fetchLogContentOfIp({stepInstanceId:this.stepInstanceId,retryCount:this.retryCount,ip:this.ip}).then((function(e){var s=e.finished,i=e.logContent;t.isRunning=!s,t.$nextTick((function(){t.editor.setValue((0,a.default)(i||"","\n")),t.editor.clearSelection()})),s||t.$pollingQueueRun(t.fetchLogContent)})).finally((function(){t.isLoading=!1}))},initEditor(){var t=this,e=n.default.edit("executeScriptLog");e.getSession().setMode("ace/mode/text"),e.setTheme("ace/theme/monokai"),e.setOptions({fontSize:this.fontSize,wrapBehavioursEnabled:!0,copyWithEmptySelection:!0,useElasticTabstops:!0,printMarginColumn:!1,printMargin:80,showPrintMargin:!1,scrollPastEnd:.05,fixedWidthGutter:!0}),e.$blockScrolling=1/0,e.setReadOnly(!0);var s=e.getSession();s.$indentedSoftWrap=!1,s.on("changeScrollTop",(function(s){var i=e.renderer.layerConfig,a=i.height,n=i.maxHeight;t.isWillAutoScroll=a+s+30>=n})),this.editor=e,this.$once("hook:beforeDestroy",(function(){e.destroy(),e.container.remove()}))},resize(){var t=this;this.$nextTick((function(){t.editor.resize()}))},autoScrollTimeout(){var t=this;this.isWillAutoScroll&&!this.isLoading&&this.handleScrollBottom(),setTimeout((function(){t.autoScrollTimer=t.autoScrollTimeout()}),1e3)},handleScrollTop(){this.editor.scrollToLine(0)},handleScrollBottom(){this.isWillAutoScroll=!0,this.editor.scrollToLine(1/0)}}};e.Z=l},84622:function(t,e,s){"use strict";var i=s(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,s(57024),s(87033),s(35948),s(94522);var a=i(s(67713)),n={name:"",inheritAttrs:!1,props:{name:String,stepInstanceId:{type:Number,required:!0},ip:{type:String}},data:()=>({isLoading:!0,variableList:[]}),watch:{name:{handler(){this.isLoading=!0,this.fetchStepVariables()},immediate:!0}},methods:{fetchStepVariables(){var t=this;this.ip?a.default.fetchStepVariables({id:this.stepInstanceId,ip:this.ip}).then((function(e){t.variableList=Object.freeze(e)})).finally((function(){t.isLoading=!1})):this.isLoading=!1}}};e.Z=n},75925:function(t,e,s){"use strict";var i=s(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,s(57024),s(87033),s(35948),s(94522);var a=i(s(67713)),n=s(41980),o={name:"",filters:{formFileSize:t=>Number(t)<1?"--":(0,n.bytePretty)(t)},props:{isFile:Boolean,stepInstanceId:{type:Number,required:!0}},data:()=>({isPopoverShowFlag:!1,isLogDownloaded:!1,fileSize:0,packageStatus:1,process:0}),computed:{boxClass(){return{1:"normal",2:"packageing",3:"failed",4:"success"}[this.packageStatus]},isShowThumProcess(){return!this.isPopoverShowFlag&&!this.isLogDownloaded&&this.isPackageing}},created(){this.isPackageing=!1,this.repackage=!1,this.resetKey=1},mounted(){this.initPopover(),this.taskQueue=[]},beforeDestroy(){this.stopQueueRun()},methods:{fetchLogFilePackageResult(){var t=this;a.default.fetchLogFilePackageResult({stepInstanceId:this.stepInstanceId,repackage:this.repackage}).then((function(e){t.fileSize=e.fileSize||0,t.packageStatus=e.status,1===t.packageStatus||2===t.packageStatus?t.pushQueue(t.fetchLogFilePackageResult):(t.stopQueueRun(),4===t.packageStatus&&(t.endProgress(),t.handleDownload()))})).catch((function(){t.stopQueueRun()})).finally((function(){t.repackage=!1}))},initPopover(){var t=this;this.popperInstance=this.$bkPopover(this.$refs.download,{arrow:!0,placement:"bottom",interactive:!0,trigger:"click",theme:"light",animation:"slide-toggle",distance:30,content:this.$refs.progress,zIndex:window.__bk_zIndex_manager.nextZIndex(),onShow:function(){t.isPopoverShowFlag=!0},onHidden:function(){t.isPopoverShowFlag=!1}})},pushQueue(t){this.taskQueue||(this.taskQueue=[]),this.taskQueue.push(t)},startQueueRun(){var t=this,e=this.taskQueue.shift();e&&e(),this.timer=setTimeout((function(){t.startQueueRun()}),1e3)},stopQueueRun(){this.stopQueueRunning=!0,clearTimeout(this.timer)},startProgress(){var t=this;this.process>.85||(this.process+=.05,setTimeout((function(){t.startProgress()}),30))},endProgress(){this.process=1},handleShow(){this.isPackageing||(this.isPackageing=!0,this.handleGetLogFilePackageResult())},handleGetLogFilePackageResult(){var t=this;this.fileSize=0,this.packageStatus=1,this.process=0,this.resetKey+=1,this.isLogDownloaded=!1,this.startQueueRun(),this.startProgress(),setTimeout((function(){t.repackage=!0,t.fetchLogFilePackageResult()}),300)},handleDownload(){this.isLogDownloaded=!0,a.default.fetchStepExecutionLogFile({id:this.stepInstanceId})}}};e.Z=o},7435:function(t,e,s){"use strict";var i=s(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,s(5580),s(87033),s(23232),s(80433),s(70201);var a=i(s(45812)),n=i(s(15399)),o={name:"",props:{data:{type:Array,default:function(){return[]}}},data:()=>({isHide:!0,renderGroup:[],toggleGroup:[],chooseGroupName:""}),computed:{groupHolder(){var t=this;return this.toggleGroup.find((function(e){return e.groupName===t.chooseGroupName}))?this.chooseGroupName:n.default.t("history.更多分组")},showGroupToggle(){return this.toggleGroup.length>0},groupToggleClass(){var t=this;return this.toggleGroup.find((function(e){return e.groupName===t.chooseGroupName}))?"active":""}},watch:{data:{handler(t){var e=this;this.data.length<1||(this.chooseGroupName&&t.find((function(t){return t.groupName===e.chooseGroupName}))||this.handleGroupChange(t[0]),this.isHide=!0,this.renderGroup=Object.freeze(t),setTimeout((function(){e.initTab()}),20))},immediate:!0}},mounted(){var t=this,e=(0,a.default)((function(){t.renderGroup=t.data,t.isHide=!0,t.timer=setTimeout((function(){t.initTab()}))}),100);window.addEventListener("resize",e),this.$once("hook:beforeDestroy",(function(){window.removeEventListener("resize",e),clearTimeout(t.timer)}))},methods:{initTab(){var t=this.$refs.groupTab.getBoundingClientRect().width,e=[...this.$refs.groupTab.querySelectorAll(".tab-item")],s=0,i=0;for(i=0;i<e.length;i++){var a=e[i].getBoundingClientRect().width;if(!(s+a<t))break;s+=a}i===e.length-1||s+124>t&&(i-=1),this.renderGroup=Object.freeze(this.data.slice(0,i)),this.toggleGroup=Object.freeze(this.data.slice(i)),this.isHide=!1},handleGroupChange(t){this.chooseGroupName=t.groupName,this.$emit("on-change",{groupName:t.groupName,resultType:t.resultType||"",tag:t.tag})}}};e.Z=o},88841:function(t,e,s){"use strict";s(35927),s(45974),s(9042),s(43364);var i=s(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,s(57024),s(85604),s(71959),s(87033),s(7170),s(23232),s(80433);var a=i(s(33610)),n=i(s(45812)),o=i(s(15399)),r=s(41980),l=i(s(63715)),c=i(s(26379)),u=i(s(2823));function d(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}var p="STEP_EXECUTE_IP_COLUMN",h={name:"",components:{Empty:l.default,ListHead:c.default,ListBody:u.default},props:{name:{type:[String,Number],required:!0},data:{type:Array,default:function(){return[]}},listLoading:{type:Boolean,default:!1},paginationLoading:{type:Boolean,default:!1},total:{type:Number,default:0},searchValue:String},data(){var t=["displayIp","totalTime","cloudAreaName","exitCode"];return localStorage.getItem(p)&&(t=JSON.parse(localStorage.getItem(p))),{list:[],columnList:Object.freeze([{label:o.default.t("history.IP"),name:"displayIp",width:"140",checked:!0,disabled:!0},{label:o.default.t("history.耗时(s)"),name:"totalTime",orderField:"totalTime",order:"",width:"120",checked:!0},{label:o.default.t("history.云区域"),name:"cloudAreaName",orderField:"cloudAreaId",order:"",width:"",checked:!0},{label:o.default.t("history.返回码"),name:"exitCode",orderField:"exitCode",order:"",width:"114",checked:!0}]),page:1,pageSize:0,isSetting:!1,allShowColumn:t,tempAllShowColumn:t}},computed:{isIndeterminate(){return this.tempAllShowColumn.length!==this.columnList.length},isAllColumn(){return this.tempAllShowColumn.length===this.columnList.length},styles(){var t=217+94*(this.allShowColumn.length-1);return{width:"".concat(t,"px")}},hasMore(){return this.page*this.pageSize<this.total}},watch:{name(){this.page=1},data:{handler(t){this.list=Object.freeze(t)},immediate:!0}},mounted(){var t=this;this.calcPageSize(),window.addEventListener("resize",this.handleScroll),this.$once("hook:beforeDestroy",(function(){window.removeEventListener("resize",t.handleScroll)}))},methods:{calcPageSize(){var t=(0,r.getOffset)(this.$refs.list).top,e=window.innerHeight-t-20;this.pageSize=parseInt(e/40+6,10),this.$emit("on-pagination-change",this.pageSize)},handleScroll:(0,n.default)((function(){if(this.hasMore){var t=window.innerHeight;this.$refs.loading.getBoundingClientRect().top-80<t&&(this.page+=1,this.$emit("on-pagination-change",this.page*this.pageSize))}}),80),handleCopyIP(){this.$emit("on-copy")},handleShowSetting(){this.isSetting=!0},handleHideSetting(){this.isSetting=!1},handleToggleAll(){this.isAllColumn?this.tempAllShowColumn=this.columnList.reduce((function(t,e){return e.disabled&&t.push(e.name),t}),[]):this.tempAllShowColumn=this.columnList.map((function(t){return t.name}))},handleSubmitSetting(){this.allShowColumn=[...this.tempAllShowColumn],this.isSetting=!1,localStorage.setItem(p,JSON.stringify(this.allShowColumn))},handleSort(t){var e=t.orderField,s=1===t.order?0:1;t.order=s,this.columnList=Object.freeze(this.columnList.map((function(t){return t.order="",t.orderField===e&&(t.order=s),function(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?d(Object(s),!0).forEach((function(e){(0,a.default)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}({},t)}))),this.$emit("on-sort",{orderField:e,order:s}),this.$emit("on-pagination-change",this.pageSize)},handleSelect(t){this.$emit("on-change",t)},handleClearSearch(){this.$emit("on-clear-search")}}};e.Z=h},57011:function(t,e,s){"use strict";var i=s(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0;var a=i(s(24437)),n=i(s(77094)),o=i(s(93435)),r={name:"",props:{data:{type:Array,required:!0},columns:{type:Array,required:!0},showColumns:{type:Array,required:!0}},data:()=>({list:[],selectRow:""}),watch:{data:{handler(t){var e=this;if(t.length<1)return this.isFocused=!1,void this.handleSelect({});this.isFocused=!0,this.selectRow&&(0,o.default)(this.data,(function(t){return e.selectRow===t.key}))||this.handleSelect(this.data[0])},immediate:!0}},mounted(){var t=this,e=function(e){t.isFocused=!1;for(var s=e.target;s&&s.classList;){if(s.classList.contains("step-execute-host-list")){t.isFocused=!0;break}s=s.parentNode}};document.addEventListener("click",e),document.addEventListener("keydown",this.handleKeyDownSelect),this.$once("hook:beforeDestroy",(function(){document.removeEventListener("click",e),document.removeEventListener("keydown",t.handleKeyDownSelect)}))},methods:{triggerChange:(0,n.default)((function(t){this.$emit("on-row-select",t)}),150),handleKeyDownSelect(t){var e=this;if(this.isFocused){var s=(0,a.default)(this.data,(function(t){return t.key===e.selectRow})),i=null;"ArrowDown"===t.code&&s<this.data.length-1?i=this.data[s+1]:"ArrowUp"===t.code&&s>0&&(i=this.data[s-1]),i&&(this.selectRow=i.key,this.triggerChange(i))}},handleSelect(t){this.selectRow=t.key,this.triggerChange(t)}}};e.Z=r},60236:function(t,e){"use strict";Object.defineProperty(e,"X",{value:!0}),e.Z=void 0;var s={name:"",props:{columns:{type:Array,required:!0},showColumns:{type:Array,required:!0}},methods:{handleSort(t){"IP"!==t.label&&this.$emit("on-sort",t)},handleCopyIP(){this.$emit("on-copy")},handleShowSetting(){this.$emit("on-show-setting")}}};e.Z=s},63958:function(t,e,s){"use strict";s(35927),s(45974),s(9042),s(43364);var i=s(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,s(85604),s(87033),s(35948),s(94522),s(61026);var a=i(s(33610)),n=i(s(56318)),o=i(s(24437)),r=i(s(15399)),l=i(s(67713)),c=s(41980),u=s(46790),d=i(s(64031)),p=i(s(36329)),h=i(s(76376)),v=i(s(21844));function f(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function g(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?f(Object(s),!0).forEach((function(e){(0,a.default)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):f(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var m={name:"",components:{TaskStep:d.default,TaskStepStart:p.default,TaskStepEnd:h.default},mixins:[v.default],data:()=>({isLoading:!1,isShow:!1,taskExecutionDetail:{isFinished:!1,taskExecution:{},stepExecution:[]},scriptHistoryList:[],fileHistoryList:[],isShowHistory:!1,isFinished:!1,currentStepInstanceId:""}),computed:{currentStepOrder(){var t=this;return(0,o.default)(this.taskExecutionDetail.stepExecution,(function(e){return e.stepInstanceId===t.currentStepInstanceId}))+1},historyEnable(){return this.taskExecutionDetail.taskExecution.isScript?this.scriptHistoryList.length>0:!!this.taskExecutionDetail.taskExecution.isFile&&this.fileHistoryList.length>0}},created(){this.timer="";var t=this.$route.params.taskInstanceId,e=this.$route.query,s=e.stepInstanceId,i=e.retryCount,a=void 0===i?0:i;this.taskInstanceId=parseInt(t,10),this.stepInstanceId=parseInt(s,10),this.retryCount=parseInt(a,10),this.fetchData()},mounted(){var t=this;this.initHistory(),this.$once("hook:beforeDestroy",(function(){clearTimeout(t.timer)}))},methods:{fetchData(){var t=this;this.isLoading=!0,l.default.fetchTaskExecutionResult({id:this.taskInstanceId}).then((function(e){if(t.taskExecutionDetail=Object.freeze(e),e.finished||(t.timer=setTimeout((function(){t.reLoading()}),1e3)),!t.stepInstanceId){var s=(0,n.default)(e.stepExecution,1)[0],i=s.stepInstanceId,a=s.retryCount;t.stepInstanceId=i,t.retryCount=a}t.currentStepInstanceId=t.stepInstanceId,t.$emit("on-init",{taskInstanceId:t.taskInstanceId,stepInstanceId:t.stepInstanceId,retryCount:t.retryCount,taskStepList:e.stepExecution,isTask:t.taskExecutionDetail.taskExecution.isTask})})).catch((function(e){[400,1244006].includes(e.code)&&setTimeout((function(){t.$router.push({name:"historyList"})}),3e3)})).finally((function(){t.isLoading=!1}))},reLoading(){var t=this;this.taskExecutionDetail.taskExecution.isTask&&l.default.fetchTaskExecutionResult({id:this.taskInstanceId}).then((function(e){t.taskExecutionDetail=Object.freeze(e),e.finished||t.$pollingQueueRun(t.reLoading)}))},initHistory(){this.scriptHistoryList=Object.freeze(u.execScriptHistory.getItem()),this.fileHistoryList=Object.freeze(u.pushFileHistory.getItem())},handleShowHistory(){this.isShowHistory=!this.isShowHistory},handleGoRedoScriptExec(t){this.$router.push({name:"fastExecuteScript",params:{taskInstanceId:t.taskInstanceId},query:{from:"historyStep"}})},handleGoRedoFileExec(t){this.$router.push({name:"fastPushFile",params:{taskInstanceId:t.taskInstanceId},query:{from:"historyStep"}})},handleChangeStep(t){if(t.stepInstanceId!==this.currentStepInstanceId)if(t.isNotStart)this.$bkMessage({theme:"warning",message:r.default.t("history.该步骤还未执行"),limit:1});else if(t.isApproval)this.$bkMessage({theme:"warning",message:r.default.t("history.人工确认步骤不支持查看步骤详情"),limit:1});else{var e=t.stepInstanceId,s=t.retryCount;this.currentStepInstanceId=e;var i=(0,c.buildURLParams)(g(g({},this.$route.query),{},{stepInstanceId:e,retryCount:s}));window.history.replaceState({},"","?".concat(i)),this.$emit("on-init",{stepInstanceId:e,taskInstanceId:this.taskInstanceId,retryCount:s,taskStepList:this.taskExecutionDetail.stepExecution,isTask:this.taskExecutionDetail.taskExecution.isTask})}},handleTaskStatusUpdate(t){this.reLoading()}}};e.Z=m},69976:function(t,e,s){"use strict";var i=s(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,s(57024);var a=i(s(49431)),n=i(s(69753)),o=i(s(95675)),r=null,l={props:{activeId:{type:[String,Number]},data:{type:Object,required:!0}},data:()=>({isShowPopover:!1,confirmReason:"",popoverPosition:{top:0,left:0},arrowPlacement:"top"}),computed:{popoverCom(){return this.data.isApproval?a.default:this.data.isNotStart?o.default:n.default},popoverStyles(){var t=this.popoverPosition,e=t.top,s=t.left,i=t.zIndex;return{position:"absolute",top:"".concat(e,"px"),left:"".concat(s+72,"px"),"z-index":i}}},beforeDestroy(){this.destroyePopover()},methods:{handleSelect(){this.$emit("on-select",this.data)},handleTaskStatusUpdate(t){this.$emit("on-update",t)},handleShowPopover(){var t=this;r&&r.handleClosePopover(),this.isShowPopover=!0,r=this;var e=0;this.data.isApproval&&(e=15),this.$nextTick((function(){t.arrowPlacement="top";var s={top:0,left:0,zIndex:window.__bk_zIndex_manager.nextZIndex()},i=t.$refs.popover.$el,a=window.innerHeight,n=i.getBoundingClientRect().height,o=t.$el.getBoundingClientRect(),r=o.top,l=o.left;s.left=l,s.top=r+e,r+n+20>a&&(t.arrowPlacement="bottom",s.top=r-n+60),s.top<20&&(t.arrowPlacement="middle",s.top=r-n/2+30),document.body.appendChild(i),t.popoverPosition=s}))},handleHidePopover(){this.data.isApproval&&"success"!==this.data.displayStyle||(this.isShowPopover=!1)},handleClosePopover(){this.isShowPopover=!1},destroyePopover(){try{r=null,this.$refs.popover.$el&&document.body.hasChildNodes(this.$refs.popover.$el)&&document.body.removeChild(this.$refs.popover.$el)}catch(t){}}}};e.Z=l},28533:function(t,e,s){"use strict";var i=s(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0;var a=i(s(15399)),n=i(s(67713)),o={name:"",components:{StepAction:i(s(1156)).default},props:{data:{type:Object,required:!0}},data:()=>({confirmReason:""}),methods:{handleChangeStatus(t){var e=this;return n.default.updateTaskExecutionStepOperate({id:this.data.stepInstanceId,operationCode:t,confirmReason:this.confirmReason}).then((function(t){return e.$bkMessage({limit:1,theme:"success",message:a.default.t("history.操作成功")}),e.$emit("on-update",t),!0}))},handleClose(){this.$emit("on-close")}}};e.Z=o},40556:function(t,e){"use strict";Object.defineProperty(e,"X",{value:!0}),e.Z=void 0;var s={name:"",props:{data:{type:Object,required:!0}}};e.Z=s},37587:function(t,e){"use strict";Object.defineProperty(e,"X",{value:!0}),e.Z=void 0;var s={name:"",props:{data:{type:Object,required:!0}}};e.Z=s},99801:function(t,e,s){"use strict";var i=s(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,s(57024);var a={name:"",components:{GlobalVariable:i(s(19553)).default},props:{taskInstanceId:{type:Number,required:!0}},data:()=>({isShow:!1}),methods:{handleShowGlobalVariable(){this.isShow=!0}}};e.Z=a},94068:function(t,e,s){"use strict";var i=s(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,s(57024);var a={name:"",components:{OperationRecord:i(s(41547)).default},props:{taskInstanceId:{type:Number,required:!0}},data:()=>({isShow:!1}),methods:{handleShowOperationRecord(){this.isShow=!0},handleOperationRecordChange(){this.isShow=!1}}};e.Z=a},53676:function(t,e,s){"use strict";var i=s(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,s(57024);var a={name:"",components:{StepDetailView:i(s(49668)).default},props:{taskInstanceId:{type:Number,required:!0},stepInstanceId:{type:Number,required:!0}},data:()=>({isShow:!1}),methods:{handleShowStepDetail(){this.isShow=!0}}};e.Z=a},19751:function(t,e,s){"use strict";s(35927),s(45974),s(9042),s(43364);var i=s(22696);Object.defineProperty(e,"X",{value:!0}),e.Z=void 0,s(70969),s(87033),s(35948),s(94522),s(61026),s(92974),s(7170);var a=i(s(33610)),n=i(s(77094)),o=i(s(93435)),r=i(s(24437)),l=i(s(15399)),c=i(s(67713)),u=s(41980),d=i(s(34109)),p=i(s(59362)),h=i(s(1156)),v=i(s(75734)),f=i(s(19834)),g=i(s(27121)),m=i(s(19925)),y=i(s(88106)),_=i(s(21170)),S=i(s(65095)),k=i(s(82329)),b=i(s(39744)),w=i(s(21844));function C(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function x(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?C(Object(s),!0).forEach((function(e){(0,a.default)(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):C(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var I={name:"StepExecuteDetail",components:{ComposeFormItem:d.default,ExecutionStatusBar:p.default,StepAction:h.default,TaskStatus:v.default,ExecutionHistorySelect:f.default,GroupTab:g.default,IpList:m.default,ExecutionInfo:y.default,ExportLog:_.default,ViewGlobalVariable:S.default,ViewOperationRecord:k.default,ViewStepInfo:b.default},mixins:[w.default],data:()=>({isLoading:!1,isLogSearching:!1,isIPSearching:!1,searchModel:"log",taskStepList:[],data:{finished:!1,resultGroups:[],actions:[],isForcedEnable:!1},params:{id:0,retryCount:"",maxIpsPerResultGroup:0,keyword:"",searchIp:"",orderField:"",order:""},currentGroup:{resultType:"",tag:""},currentHost:{ip:"",retryCount:0},isTask:!1,isFile:!1,paginationChangeLoading:!1}),computed:{isSkeletonLoading(){return this.isLoading},stepTypeText(){var t=this,e="";if(this.isTask){var s=(0,r.default)(this.taskStepList,(function(e){return e.stepInstanceId===t.params.id}));s>-1&&(e+="Step ".concat(s+1,"/").concat(this.taskStepList.length))}return e=this.isFile?"".concat(e," ").concat(l.default.t("history.分发文件")):"".concat(e," ").concat(l.default.t("history.脚本执行"))},isHostLoading(){return!!this.data.finished&&this.isLoading},dispalyGroup(){var t=this,e=(0,o.default)(this.data.resultGroups,(function(e){return e.groupName===t.currentGroup.groupName}));return e||{agentTaskExecutionDetail:[],groupName:""}}},created(){this.taskInstanceId=0,this.isForceing=!1,this.$Progress.start()},beforeDestroy(){this.$Progress.finish()},methods:{fetchStep:(0,n.default)((function(){var t=this;this.params.id<1||this.params.maxIpsPerResultGroup<1||(this.isLoading=!0,c.default.fetchStepExecutionResult(x(x({},this.params),{},{resultType:this.currentGroup.resultType,tag:this.currentGroup.tag})).then((function(e){if(!t.isForceing){t.data=Object.freeze(e),t.isFile=e.isFile;var s=e.resultGroups;(0,o.default)(s,(function(e){return e.resultType===t.currentGroup.resultType&&e.tag===t.currentGroup.tag}))||(t.currentGroup=s[0]),e.finished?t.$Progress.finish():t.$pollingQueueRun(t.fetchStep)}})).catch((function(e){[400,1244007].includes(e.code)&&setTimeout((function(){t.$router.push({name:"historyList"})}),3e3)})).finally((function(){t.isLoading=!1,t.isLogSearching=!1,t.isIPSearching=!1,t.paginationChangeLoading=!1})))}),30),handleTaskInit(t){this.params=x(x({},this.params),{},{id:t.stepInstanceId,retryCount:t.retryCount}),this.taskInstanceId=t.taskInstanceId,this.isTask=t.isTask,this.taskStepList=Object.freeze(t.taskStepList),this.fetchStep()},handleRetryCountChange(t){this.params=x(x({},this.params),{},{retryCount:t}),this.fetchStep()},handelGroupChange(t){this.currentGroup=t,this.fetchStep()},handleHostChange(t){this.currentHost=Object.freeze(t)},handlePaginationChange(t){this.params.maxIpsPerResultGroup=t,this.paginationChangeLoading=!0,this.fetchStep()},handleSort(t){this.params=Object.assign({},this.params,t),this.fetchStep()},handleClearSearch(){this.params.keyword="",this.params.searchIp="",this.isLogSearching=!0,this.fetchStep()},handleCopyHost(){var t=this;c.default.fetchStepGroupHost(x(x({},this.params),{},{resultType:this.currentGroup.resultType,tag:this.currentGroup.tag})).then((function(e){if(e.length<1)t.$bkMessage({theme:"warning",message:l.default.t("history.暂无可复制IP"),limit:1});else{var s=e.map((function(t){return t.ip})).join("\n"),i="".concat(l.default.t("history.复制成功"),"（").concat(e.length," ").concat(l.default.t("history.个"),"IP）");(0,u.execCopy)(s,i)}}))},handleExportExecutionLog(){var t=this;c.default.fetchStepExecutionLogFile({id:this.params.id}).then((function(){t.$bkMessage({theme:"success",message:l.default.t("history.导出日志操作成功")})}))},handleStartForceTask(){this.isForceing=!0,this.$Progress.start()},handleCancelForceTask(){this.isForceing=!1,this.$Progress.start(),this.fetchStep()},handleForceTask(){var t=this;return this.$Progress.start(),c.default.updateTaskExecutionStepOperateTerminate({taskInstanceId:this.taskInstanceId}).then((function(){return t.messageSuccess(l.default.t("history.操作成功")),t.$refs.taskStatus.reLoading(),t.$refs.executionHistorySelect.reLoading(),t.fetchStep(),!0}))},handleStatusUpdate(t){var e=this;return this.$Progress.start(),c.default.updateTaskExecutionStepOperate({id:this.params.id,operationCode:t}).then((function(t){return e.params.retryCount=t.retryCount,e.$refs.taskStatus.reLoading(),e.$refs.executionHistorySelect.reLoading(),e.$bkMessage({limit:1,theme:"success",message:l.default.t("history.操作成功")}),e.fetchStep(),!0}))},handleIPSearch(t,e){e.isComposing||(""===t&&t!==this.params.searchIp||13===e.keyCode)&&(this.params.keyword="",this.params.searchIp=t,this.isIPSearching=!0,this.fetchStep())},handleLogSearch(t,e){e.isComposing||(""===t&&t!==this.params.keyword||13===e.keyCode||"click"===e.type)&&(this.params.keyword=t,this.params.searchIp="",this.isLogSearching=!0,this.searchModel="log",this.fetchStep())},routerBack(){var t=this.$route.query.from;"historyTask"!==t?"plan"!==t?"fastExecuteScript"!==t?"fastPushFile"!==t?this.$router.push({name:"historyList"}):this.$router.push({name:"fastPushFile",query:{from:"historyStep"}}):this.$router.push({name:"fastExecuteScript",query:{from:"historyStep"}}):this.$router.push({name:"historyTask",params:{id:this.taskInstanceId},query:{from:"plan"}}):this.$router.push({name:"historyTask",params:{id:this.taskInstanceId}})}}};e.Z=I},21844:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s={created(){this.stopPollingRun=!1,this._pollingTaskQueue=[],this._stepTimer=[1e3,1e3,1e3,1e3,2e3,2e3,2e3],this.startPollingQueueRun()},beforeDestroy(){this.stopPollingQueueRun()},methods:{$pollingQueueRun(t){this._pollingTaskQueue=[t]},startPollingQueueRun(){var t=this;if(!this.stopPollingRun){var e=1e3;if(this._pollingTaskQueue.length>0)this._pollingTaskQueue.shift()(),e=this._stepTimer.shift();e||(e=3e3),setTimeout((function(){t.startPollingQueueRun()}),e)}},stopPollingQueueRun(){this.stopPollingRun=!0,this._pollingTaskQueue=[]}}};e.default=s},69690:function(){},1844:function(){},70118:function(){},80440:function(){},21283:function(){},11476:function(){},22949:function(){},34492:function(){},72803:function(){},57040:function(){},64534:function(){},40235:function(){},97683:function(){},43560:function(){},68998:function(){},49668:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.isLoading},expression:"{ isLoading }"}]},[s("task-step-view",{attrs:{variable:t.variableList,data:t.stepInfo}})],1)};i._withStripped=!0;var a=s(12939),n=a.Z,o=(0,s(35471).Z)(n,i,[],!1,null,null,null);o.options.__file="src/views/executive-history/common/step-detail-view.vue";var r=o.exports},19834:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.isNeedRender?s("div",{ref:"target",staticClass:"step-execution-history-select"},[s("span",[t._v(t._s(t.retryCountText))]),t._v(" "),s("Icon",{staticStyle:{"font-size":"16px"},attrs:{type:"down-small"}}),t._v(" "),s("div",{ref:"content",staticClass:"dropdown-menu"},t._l(t.executionList,(function(e){return s("div",{key:e.createTime,staticClass:"menu-item",class:{active:e.retryCount===t.retryCount},on:{click:function(s){return t.handleSelectRetryCount(e.retryCount)}}},[s("div",{staticClass:"retry-count"},[t._v(t._s(e.text))]),t._v(" "),s("div",{staticClass:"time"},[t._v(t._s(e.createTime))])])})),0)],1):t._e()};i._withStripped=!0;var a=s(46863),n=a.Z,o=(s(31865),(0,s(35471).Z)(n,i,[],!1,null,null,null));o.options.__file="src/views/executive-history/step-detail/components/execution-history-select.vue";var r=o.exports},96285:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.isLoading,opacity:.1},expression:"{ isLoading, opacity: .1 }"}],ref:"contentBox",staticClass:"file-download-log",on:{scroll:t.handleScroll}},[s("div",t._l(t.renderList,(function(e,i){return s("file-item",{key:i,attrs:{index:i,"open-memo":t.openMemo,data:e,"render-content-map":t.renderContentMap,"is-content-loading":t.isAsyncContentLoading},on:{"on-toggle":t.handleToggle}})})),1),t._v(" "),t.renderNums<t.contentList.length?s("div",{ref:"load",staticClass:"load-more"},[s("div",{staticClass:"loading-flag"},[s("Icon",{attrs:{type:"loading-circle"}})],1),t._v(" "),s("div",[t._v(t._s(t.$t("history.加载中")))])]):t._e()])};i._withStripped=!0;var a=s(22552),n=a.Z,o=(s(25968),(0,s(35471).Z)(n,i,[],!1,null,null,null));o.options.__file="src/views/executive-history/step-detail/components/execution-info/file-log/index.vue";var r=o.exports},65518:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return i.X},default:function(){return o}});var i=s(27693),a=i.Z,n=(s(90927),(0,s(35471).Z)(a,undefined,undefined,!1,null,null,null));n.options.__file="src/views/executive-history/step-detail/components/execution-info/file-log/log-item.vue";var o=n.exports},88106:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"infoBox",staticClass:"step-execution-info-box",style:t.boxStyles},[s("div",{staticClass:"tab-container"},[s("div",{staticClass:"tab-title",class:t.host.result},[s("span",{staticClass:"host-ip"},[t._v(t._s(t.host.displayIp||"--"))])]),t._v(" "),s("div",{staticClass:"split-line"}),t._v(" "),t.isFile?t._e():s("div",{staticClass:"tab-item",class:{active:"scriptLog"===t.activePanel},on:{click:function(e){return t.handleTogglePanel("scriptLog")}}},[t._v("\n            "+t._s(t.$t("history.执行日志"))+"\n        ")]),t._v(" "),t.isFile?[s("div",{staticClass:"tab-item",class:{active:"download"===t.activePanel},on:{click:function(e){return t.handleTogglePanel("download")}}},[t._v("\n                "+t._s(t.$t("history.下载信息"))+"\n            ")]),t._v(" "),s("div",{staticClass:"tab-item",class:{active:"upload"===t.activePanel},on:{click:function(e){return t.handleTogglePanel("upload")}}},[t._v("\n                "+t._s(t.$t("history.上传源信息"))+"\n            ")])]:t._e(),t._v(" "),t.isTask&&!t.isFile?s("div",{staticClass:"tab-item",class:{active:"variable"===t.activePanel},on:{click:function(e){return t.handleTogglePanel("variable")}}},[t._v("\n            "+t._s(t.$t("history.变量明细"))+"\n        ")]):t._e(),t._v(" "),s("div",{staticClass:"extend-box"},["scriptLog"===t.activePanel?s("div",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:t.$t("history.下载日志"),expression:"$t('history.下载日志')"}],staticClass:"extend-item",on:{click:t.handleDownload}},[s("Icon",{attrs:{type:"download"}})],1):t._e(),t._v(" "),"scriptLog"===t.activePanel?s("div",{staticClass:"extend-item",on:{mouseenter:t.handleShowSetFont,mouseleave:t.handleHideSetFont}},[t._v("Aa")]):t._e(),t._v(" "),t.isFullscreen?t._e():s("div",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:t.$t("history.全屏"),expression:"$t('history.全屏')"}],staticClass:"extend-item",on:{click:t.handleFullscreen}},[s("Icon",{attrs:{type:"full-screen"}})],1),t._v(" "),t.isFullscreen?s("div",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:t.$t("history.还原"),expression:"$t('history.还原')"}],staticClass:"extend-item",on:{click:t.handleExitFullscreen}},[s("Icon",{attrs:{type:"un-full-screen"}})],1):t._e(),t._v(" "),"scriptLog"===t.activePanel?s("div",{staticClass:"extend-item",staticStyle:{"padding-left":"16px","border-left":"1px solid #262626"}},[s("bk-switcher",{attrs:{value:t.isScriptLogLineFeed,theme:"primary",size:"small"},on:{change:t.handleScriptLogLineFeedChange}}),t._v(" "),s("span",{staticStyle:{"padding-left":"7px","font-size":"12px",color:"#979ba5"}},[t._v(t._s(t.$t("history.自动换行")))])],1):t._e()])],2),t._v(" "),s("div",{staticClass:"tab-content-wraper",style:t.contentStyles},[s(t.renderCom,t._g(t._b({key:t.activePanel,ref:"view",tag:"component",attrs:{name:t.stepInstanceId+"_"+t.host.ip+"_"+t.retryCount,"step-instance-id":t.stepInstanceId,ip:t.host.ip,"retry-count":t.retryCount,"font-size":t.fontSize,mode:t.activePanel,"line-feed":t.isScriptLogLineFeed}},"component",t.$attrs,!1),t.$listeners))],1),t._v(" "),s("div",{staticClass:"font-setting",class:{active:t.isFontSet},on:{mouseenter:t.handleShowSetFont,mouseleave:t.handleHideSetFont}},[s("div",{staticClass:"font-setting-wraper"},[s("div",{staticClass:"font-item",class:{active:12===t.fontSize},staticStyle:{"font-size":"12px"},on:{click:function(e){return t.handleFontChange(12)}}},[t._v("Aa")]),t._v(" "),s("div",{staticClass:"line"}),t._v(" "),s("div",{staticClass:"font-item",class:{active:13===t.fontSize},staticStyle:{"font-size":"13px"},on:{click:function(e){return t.handleFontChange(13)}}},[t._v("Aa")]),t._v(" "),s("div",{staticClass:"line"}),t._v(" "),s("div",{staticClass:"font-item",class:{active:14===t.fontSize},staticStyle:{"font-size":"14px"},on:{click:function(e){return t.handleFontChange(14)}}},[t._v("Aa")])])])])};i._withStripped=!0;var a=s(63246),n=a.Z,o=(s(71186),(0,s(35471).Z)(n,i,[],!1,null,null,null));o.options.__file="src/views/executive-history/step-detail/components/execution-info/index.vue";var r=o.exports},4695:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.isLoading,opacity:.1},expression:"{\n        isLoading, opacity: .1,\n    }"}],staticClass:"step-execute-script-log"},[s("div",{staticClass:"log-wraper"},[t._m(0)]),t._v(" "),t.ip&&t.isRunning?s("div",{staticClass:"log-status"},[s("div",{staticClass:"log-loading"},[t._v(t._s(t.$t("history.执行中")))])]):t._e(),t._v(" "),s("div",{staticClass:"log-action-box"},[s("div",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:t.backTopTips,expression:"backTopTips"}],staticClass:"action-item",on:{click:t.handleScrollTop}},[s("Icon",{attrs:{type:"up-to-top"}})],1),t._v(" "),s("div",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:t.backBottomTips,expression:"backBottomTips"}],staticClass:"action-item action-bottom",on:{click:t.handleScrollBottom}},[s("Icon",{attrs:{type:"up-to-top"}})],1)])])};i._withStripped=!0;var a=s(18218),n=a.Z,o=(s(70032),(0,s(35471).Z)(n,i,[function(){var t=this.$createElement;return(this._self._c||t)("div",{staticStyle:{height:"100%"},attrs:{id:"executeScriptLog"}})}],!1,null,null,null));o.options.__file="src/views/executive-history/step-detail/components/execution-info/script-log/index.vue";var r=o.exports},1480:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.isLoading,opacity:.1},expression:"{ isLoading: isLoading, opacity: .1 }"}],staticClass:"step-execute-variable-view"},[s("scroll-faker",{attrs:{theme:"dark"}},[s("table",[s("thead",[s("tr",[s("td",{staticStyle:{width:"90px"}},[t._v(t._s(t.$t("history.变量名称")))]),t._v(" "),s("td",{staticStyle:{width:"90px"}},[t._v(t._s(t.$t("history.变量类型")))]),t._v(" "),s("td",[t._v(t._s(t.$t("history.变量值")))])])]),t._v(" "),s("tbody",t._l(t.variableList,(function(e,i){return s("tr",{key:i},[s("td",[t._v(t._s(e.name))]),t._v(" "),s("td",[t._v(t._s(e.typeText))]),t._v(" "),s("td",{staticClass:"variable-value"},[t._v(t._s(e.value))])])})),0)])])],1)};i._withStripped=!0;var a=s(84622),n=a.Z,o=(s(13667),(0,s(35471).Z)(n,i,[],!1,null,null,null));o.options.__file="src/views/executive-history/step-detail/components/execution-info/variable-view.vue";var r=o.exports},21170:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"download",staticClass:"step-execute-log-export",attrs:{"tippy-tips":t.isFile?t.$t("history.分发文件步骤不支持日志导出"):""},on:{click:t.handleShow}},[s("div",[t._v(t._s(t.$t("history.导出日志")))]),t._v(" "),t.isShowThumProcess?s("div",{staticClass:"thum-precess-bar",class:t.boxClass},[s("div",{staticClass:"thum-precess",style:{width:100*t.process+"%"}})]):t._e(),t._v(" "),s("div",{staticStyle:{display:"none"}},[s("div",{ref:"progress",staticClass:"step-execute-log-package",class:t.boxClass},[s("div",{staticClass:"package-baseinfo"},[s("div",{staticClass:"package-size"},[t._v(t._s(t.$t("history.文件大小"))+": "+t._s(t._f("formFileSize")(t.fileSize)))]),t._v(" "),s("div",{staticClass:"package-result"},[1===t.packageStatus?s("span",[t._v(t._s(t.$t("history.打包中"))+"…")]):t._e(),t._v(" "),2===t.packageStatus?s("span",[t._v(t._s(t.$t("history.打包中"))+"…")]):t._e(),t._v(" "),3===t.packageStatus?s("span",[s("span",[t._v(t._s(t.$t("history.打包失败，")))]),t._v(" "),s("a",{on:{click:t.handleGetLogFilePackageResult}},[t._v(t._s(t.$t("history.重试")))])]):t._e(),t._v(" "),4===t.packageStatus?s("span",[t._v(t._s(t.$t("history.准备就绪")))]):t._e()])]),t._v(" "),s("bk-progress",{key:t.resetKey,staticClass:"package-process",attrs:{size:"small",theme:"primary",percent:t.process,"show-text":!1}}),t._v(" "),1===t.packageStatus?s("div",{staticClass:"package-result-tips"},[t._v("\n                "+t._s(t.$t("history.温馨提示：打包耗时会受到总的日志内容大小影响，请耐心等待"))+"\n            ")]):t._e(),t._v(" "),2===t.packageStatus?s("div",{staticClass:"package-result-tips"},[t._v("\n                "+t._s(t.$t("history.温馨提示：文件打包中请勿关闭浏览器，以免导致任务中断"))+"\n            ")]):t._e(),t._v(" "),3===t.packageStatus?s("div",{staticClass:"package-result-tips"},[t._v("\n                "+t._s(t.$t("history.日志文件打包超时，可能因为日志量过大，请选择单台日志下载"))+"\n            ")]):t._e(),t._v(" "),4===t.packageStatus?s("div",{staticClass:"package-result-tips"},[s("span",[t._v(t._s(t.$t("history.日志压缩包已准备就绪，"))+t._s(t.$t("history.是否"))),s("a",{on:{click:t.handleDownload}},[t._v(t._s(t.$t("history.直接下载")))])]),t._v(" "),s("bk-button",{staticStyle:{"margin-top":"-5px","margin-left":"auto"},attrs:{theme:"primary"},on:{click:t.handleGetLogFilePackageResult}},[t._v("\n                    "+t._s(t.$t("history.重新打包"))+"\n                ")])],1):t._e()],1)])])};i._withStripped=!0;var a=s(75925),n=a.Z,o=(s(63289),(0,s(35471).Z)(n,i,[],!1,null,null,null));o.options.__file="src/views/executive-history/step-detail/components/export-log.vue";var r=o.exports},27121:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"step-execute-host-group",class:{hide:t.isHide}},[s("div",{ref:"groupTab",staticClass:"group-tab",class:{toggle:t.showGroupToggle}},[t._l(t.renderGroup,(function(e){return s("div",{key:e.resultType+e.tag,staticClass:"tab-item",class:{active:t.chooseGroupName===e.groupName},on:{click:function(s){return t.handleGroupChange(e)}}},[s("div",{directives:[{name:"bk-overflow-tips",rawName:"v-bk-overflow-tips"}],staticClass:"group-name"},[t._v(t._s(e.groupName))]),t._v(" "),e.tagMaxLength?s("Icon",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:t.$t("history.分组标签长度最大支持256，超过会被自动截断，请留意！"),expression:"$t('history.分组标签长度最大支持256，超过会被自动截断，请留意！')"}],staticClass:"max-length-info",attrs:{type:"info"}}):t._e(),t._v(" "),s("div",{staticClass:"group-nums"},[t._v(t._s(e.agentTaskSize))])],1)})),t._v(" "),t.showGroupToggle?s("div",{staticClass:"group-toggle",class:t.groupToggleClass},[s("div",{staticClass:"tab-more"},[s("div",{staticClass:"group-holder"},[t._v(t._s(t.groupHolder))]),t._v(" "),s("Icon",{staticClass:"toggle-flag",attrs:{type:"arrow-full-right"}})],1),t._v(" "),s("div",{staticClass:"dropdown-menu"},t._l(t.toggleGroup,(function(e,i){return s("div",{key:i,staticClass:"dropdowm-item",class:{active:t.chooseGroupName===e.groupName},on:{click:function(s){return t.handleGroupChange(e)}}},[s("div",{directives:[{name:"bk-overflow-tips",rawName:"v-bk-overflow-tips"}],staticClass:"group-name"},[t._v(t._s(e.groupName))]),t._v(" "),e.tagMaxLength?s("Icon",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips",value:t.$t("history.分组标签长度最大支持256，超过会被自动截断，请留意！"),expression:"$t('history.分组标签长度最大支持256，超过会被自动截断，请留意！')"}],staticClass:"max-length-info",attrs:{type:"info"}}):t._e(),t._v(" "),s("div",{staticClass:"group-nums"},[t._v(t._s(e.agentTaskSize))])],1)})),0)]):t._e()],2)])};i._withStripped=!0;var a=s(7435),n=a.Z,o=(s(58168),(0,s(35471).Z)(n,i,[],!1,null,"3fde80f6",null));o.options.__file="src/views/executive-history/step-detail/components/group-tab.vue";var r=o.exports},19925:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"step-execute-host-list",style:t.styles},[s("list-head",{staticClass:"ip-list-head",attrs:{columns:t.columnList,"show-columns":t.allShowColumn},on:{"on-sort":t.handleSort,"on-copy":t.handleCopyIP,"on-show-setting":t.handleShowSetting}}),t._v(" "),s("div",{ref:"list",staticClass:"ip-list-body"},[s("scroll-faker",{on:{"on-scroll":t.handleScroll}},[s("list-body",{attrs:{columns:t.columnList,"show-columns":t.allShowColumn,data:t.list},on:{"on-row-select":t.handleSelect}}),t._v(" "),t.hasMore?s("div",{ref:"loading",staticClass:"list-loading"},[s("div",{staticClass:"loading-flag"},[s("Icon",{attrs:{type:"loading-circle"}})],1),t._v(" "),s("div",[t._v(t._s(t.$t("history.加载中")))])]):t._e(),t._v(" "),t.list.length<1&&!t.listLoading?[t.searchValue?s("Empty",{staticStyle:{height:"100%"},attrs:{type:"search"}},[s("div",[s("div",{staticStyle:{"font-size":"14px",color:"#63656e"}},[t._v(t._s(t.$t("搜索结果为空")))]),t._v(" "),s("div",{staticStyle:{"margin-top":"8px","font-size":"12px","line-height":"16px",color:"#979ba5"}},[s("span",[t._v(t._s(t.$t("可以尝试调整关键词")))]),t._v(" "),[s("span",[t._v(t._s(t.$t("或")))]),t._v(" "),s("bk-button",{attrs:{text:""},on:{click:t.handleClearSearch}},[t._v("\n                                    "+t._s(t.$t("清空搜索条件"))+"\n                                ")])]],2)])]):s("Empty",{staticStyle:{height:"100%"}})]:t._e()],2)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.isSetting,expression:"isSetting"}],staticClass:"list-column-select"},[s("div",{staticClass:"select-body"},[s("div",{staticClass:"title"},[t._v(t._s(t.$t("history.字段显示设置")))]),t._v(" "),s("bk-checkbox",{attrs:{indeterminate:t.isIndeterminate,checked:t.isAllColumn},nativeOn:{click:function(e){return t.handleToggleAll.apply(null,arguments)}}},[t._v("\n                "+t._s(t.$t("history.全选"))+"\n            ")]),t._v(" "),s("bk-checkbox-group",{model:{value:t.tempAllShowColumn,callback:function(e){t.tempAllShowColumn=e},expression:"tempAllShowColumn"}},t._l(t.columnList,(function(e){return s("bk-checkbox",{key:e.name,staticClass:"select-column",attrs:{checked:e.checked,disabled:e.disabled,value:e.name}},[t._v("\n                    "+t._s(e.label)+"\n                ")])})),1)],1),t._v(" "),s("div",{staticClass:"select-footer"},[s("bk-button",{attrs:{theme:"primary"},on:{click:t.handleSubmitSetting}},[t._v("\n                "+t._s(t.$t("history.确定"))+"\n            ")]),t._v(" "),s("bk-button",{on:{click:t.handleHideSetting}},[t._v("\n                "+t._s(t.$t("history.取消"))+"\n            ")])],1)])],1)};i._withStripped=!0;var a=s(88841),n=a.Z,o=(s(1669),(0,s(35471).Z)(n,i,[],!1,null,null,null));o.options.__file="src/views/executive-history/step-detail/components/ip-list/index.vue";var r=o.exports},2823:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",{staticClass:"ip-table"},[s("colgroup",[t._l(t.columns,(function(e){return[t.showColumns.includes(e.name)?s("col",{key:e.name,attrs:{name:e.name,width:e.width}}):t._e()]})),t._v(" "),s("col",{key:"setting",attrs:{name:"setting",width:"40"}})],2),t._v(" "),s("tbody",t._l(t.data,(function(e){return s("tr",{key:e.key,class:{active:t.selectRow===e.key},on:{click:function(s){return t.handleSelect(e)}}},[t._l(t.showColumns,(function(i,a){return s("td",{key:i,class:0===a&&e.result},[t._v("\n                "+t._s(e[i])+"\n            ")])})),t._v(" "),s("td",{staticClass:"active-flag"},[t.selectRow===e.key?s("Icon",{attrs:{type:"arrow-full-right"}}):t._e()],1)],2)})),0)])};i._withStripped=!0;var a=s(57011),n=a.Z,o=(0,s(35471).Z)(n,i,[],!1,null,null,null);o.options.__file="src/views/executive-history/step-detail/components/ip-list/list-body.vue";var r=o.exports},26379:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",{staticClass:"ip-table"},[s("colgroup",[t._l(t.columns,(function(e){return[t.showColumns.includes(e.name)?s("col",{key:e.name,attrs:{name:e.name,width:e.width}}):t._e()]})),t._v(" "),s("col",{key:"setting",attrs:{name:"setting",width:"40"}})],2),t._v(" "),s("thead",[s("tr",[t._l(t.columns,(function(e){return[t.showColumns.includes(e.name)?s("th",{key:e.name,class:{sort:e.orderField},on:{click:function(s){return t.handleSort(e)}}},[s("span",[t._v(t._s(e.label))]),t._v(" "),"IP"===e.label?s("span",{staticClass:"copy-ip-btn",on:{click:t.handleCopyIP}},[t._v("\n                        "+t._s(t.$t("history.复制"))+"\n                    ")]):t._e(),t._v(" "),e.orderField?s("span",{staticClass:"sort-box",attrs:{"data-order":e.order}},[s("span",{staticClass:"top",class:{active:1===e.order}}),t._v(" "),s("span",{staticClass:"bottom",class:{active:0===e.order}})]):t._e()]):t._e()]})),t._v(" "),s("th",{staticClass:"list-action",on:{click:t.handleShowSetting}},[s("i",{staticClass:"bk-icon icon-cog-shape"})])],2)])])};i._withStripped=!0;var a=s(60236),n=a.Z,o=(0,s(35471).Z)(n,i,[],!1,null,null,null);o.options.__file="src/views/executive-history/step-detail/components/ip-list/list-head.vue";var r=o.exports},75734:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"task-execution-step-wraper",class:{column:t.taskExecutionDetail.taskExecution.isTask}},[t.taskExecutionDetail.taskExecution.isTask?s("div",{staticClass:"task-process"},[s("div",{staticClass:"process-wraper"},[s("scroll-faker",[s("task-step-start"),t._v(" "),t._l(t.taskExecutionDetail.stepExecution,(function(e){return s("task-step",{key:e.stepInstanceId,attrs:{data:e,"active-id":t.currentStepInstanceId},on:{"on-select":t.handleChangeStep,"on-update":t.handleTaskStatusUpdate}})})),t._v(" "),s("task-step-end",{attrs:{disable:!t.taskExecutionDetail.taskExecution.isSuccess}})],2)],1),t._v(" "),s("div",{staticClass:"execution-process"},[t._v("\n            "+t._s(t.currentStepOrder)+" / "+t._s(t.taskExecutionDetail.totalStep)+"\n        ")])]):t._e(),t._v(" "),s("div",{staticClass:"task-step-detail"},[t._t("default")],2),t._v(" "),t.historyEnable?s("div",{staticClass:"execution-history",class:{active:t.isShowHistory}},[s("div",{staticClass:"toggle-btn",on:{click:t.handleShowHistory}},[s("Icon",{staticClass:"toggle-flag",attrs:{type:"angle-double-left"}}),t._v(" "),s("div",{staticClass:"return-edit"},[t._v(t._s(t.$t("history.返回编辑")))])],1),t._v(" "),s("div",{staticClass:"history-content"},[t.taskExecutionDetail.taskExecution.isScript?t._l(t.scriptHistoryList,(function(e){return s("div",{key:e.id,staticClass:"item",on:{click:function(s){return t.handleGoRedoScriptExec(e)}}},[t._v("\n                    "+t._s(e.name)+"\n                ")])})):t._e(),t._v(" "),t.taskExecutionDetail.taskExecution.isFile?t._l(t.fileHistoryList,(function(e){return s("div",{key:e.id,staticClass:"item",on:{click:function(s){return t.handleGoRedoFileExec(e)}}},[t._v("\n                    "+t._s(e.name)+"\n                ")])})):t._e()],2)]):t._e()])};i._withStripped=!0;var a=s(63958),n=a.Z,o=(s(8062),(0,s(35471).Z)(n,i,[],!1,null,null,null));o.options.__file="src/views/executive-history/step-detail/components/task-status.vue";var r=o.exports},76376:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return n}});var i=function(t,e){var s=e._c;return s("div",{staticClass:"task-execute-bar-step end",class:{disabled:e.props.disable}},[s("div",{staticClass:"step-wraper"},[s("div",{staticClass:"step-icon"},[s("span",[e._v(e._s(e.parent.$t("history.终")))])])])])};i._withStripped=!0;var a=(0,s(35471).Z)({},i,[],!0,null,null,null);a.options.__file="src/views/executive-history/step-detail/components/task-step/end.vue";var n=a.exports},64031:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t,e=this,s=e.$createElement,i=e._self._c||s;return i("div",{staticClass:"task-execute-bar-step",class:(t={},t[e.data.displayStyle]=!0,t.active=e.data.stepInstanceId===e.activeId,t),on:{mouseenter:e.handleShowPopover,mouseleave:e.handleHidePopover,click:e.handleSelect}},[i("div",{staticClass:"step-wraper"},[i("div",{staticClass:"step-icon"},[i("Icon",{attrs:{type:e.data.icon}})],1),e._v(" "),e.data.isDoing?i("img",{staticClass:"loading-progress",attrs:{src:"/bk-job-frontend/static/images/task-loading.png"}}):e._e()]),e._v(" "),i("Icon",{staticClass:"step-next",attrs:{type:e.data.lastStepIcon,svg:""}}),e._v(" "),i(e.popoverCom,{directives:[{name:"show",rawName:"v-show",value:e.isShowPopover,expression:"isShowPopover"}],ref:"popover",tag:"component",class:["task-status-bar-step-popover",e.arrowPlacement],style:e.popoverStyles,attrs:{data:e.data},on:{"on-update":e.handleTaskStatusUpdate,"on-close":e.handleClosePopover}})],1)};i._withStripped=!0;var a=s(69976),n=a.Z,o=(s(83369),(0,s(35471).Z)(n,i,[],!1,null,null,null));o.options.__file="src/views/executive-history/step-detail/components/task-step/index.vue";var r=o.exports},36329:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return n}});var i=function(t,e){var s=e._c;return s("div",{key:"start",staticClass:"task-execute-bar-step start"},[s("div",{staticClass:"step-wraper"},[s("div",{staticClass:"step-icon"},[s("span",[e._v(e._s(e.parent.$t("history.始")))])])]),e._v(" "),s("Icon",{staticClass:"step-next",attrs:{type:"step-next",svg:""}})],1)};i._withStripped=!0;var a=(0,s(35471).Z)({},i,[],!0,null,null,null);a.options.__file="src/views/executive-history/step-detail/components/task-step/start.vue";var n=a.exports},49431:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t,e=this,s=e.$createElement,i=e._self._c||s;return i("div",{ref:"popover",staticClass:"task-execute-bar-step-confirm-popover-view",class:(t={},t[e.data.displayStyle]=!0,t["not-start"]=e.data.isNotStart,t)},[i("div",{staticClass:"confirm-wraper"},[i("div",{staticClass:"step-name"},[e._v(e._s(e.data.name))]),e._v(" "),i("div",{staticClass:"approval-info"},[e.data.roleNameList.length||e.data.userList.length?i("div",{staticClass:"approval-person"},[i("span",{staticClass:"persion-label"},[e._v(e._s(e.$t("history.确认人"))+"：")]),e._v(" "),e._l(e.data.roleNameList,(function(t){return i("div",{key:"role_"+t,staticClass:"person"},[i("Icon",{staticClass:"role-flag",attrs:{type:"user-group-gray"}}),e._v("\n                    "+e._s(t)+"\n                ")],1)})),e._v(" "),e._l(e.data.userList,(function(t){return i("div",{key:"user_"+t,staticClass:"person"},[i("Icon",{staticClass:"role-flag",attrs:{type:"user"}}),e._v("\n                    "+e._s(t)+"\n                ")],1)}))],2):e._e(),e._v(" "),e.data.notifyChannelNameList.length>0?i("div",{staticClass:"approval-channel"},[e._v("\n                "+e._s(e.$t("history.通知方式"))+"："+e._s(e.data.notifyChannelNameList.join("，"))+"\n            ")]):e._e()]),e._v(" "),e.data.confirmMessage?i("div",{staticClass:"step-desc"},[e._v(e._s(e.data.confirmMessage))]):e._e(),e._v(" "),e.data.isNotStart?e._e():[e.data.isApprovaling?i("bk-input",{staticClass:"confirm-reason",attrs:{type:"textarea",rows:3,maxlength:100,placeholder:e.$t("history.可在此处输入确认或终止的因由")},model:{value:e.confirmReason,callback:function(t){e.confirmReason=t},expression:"confirmReason"}}):e.data.operator?i("div",{staticClass:"confirm-reason-text"},[i("div",{staticClass:"person"},[e._v(e._s(e.data.operator))]),e._v(" "),i("span",{domProps:{innerHTML:e._s(e.data.confirmReasonHtml)}})]):e._e(),e._v(" "),e.data.actions.length>0?i("div",{staticClass:"step-action",on:{click:function(t){t.stopPropagation()}}},e._l(e.data.actions,(function(t){return i("step-action",{key:t,attrs:{name:t,"confirm-handler":function(t){return e.handleChangeStatus(t)}}})})),1):e._e()]],2),e._v(" "),"success"!==e.data.displayStyle?i("Icon",{staticClass:"approval-close",attrs:{type:"close"},on:{click:e.handleClose}}):e._e()],1)};i._withStripped=!0;var a=s(28533),n=a.Z,o=(s(1858),(0,s(35471).Z)(n,i,[],!1,null,null,null));o.options.__file="src/views/executive-history/step-detail/components/task-step/view/approval.vue";var r=o.exports},95675:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"task-execute-bar-step-description-popover"},[s("div",[t._v("\n        "+t._s(t.data.typeDesc)+":"),s("span",{staticClass:"value"},[t._v(t._s(t.data.name))])]),t._v(" "),s("div",[t._v("\n        "+t._s(t.$t("history.步骤状态"))+":"),s("span",{staticClass:"value"},[t._v("--")])]),t._v(" "),s("div",[t._v("\n        "+t._s(t.$t("history.步骤耗时"))+":"),s("span",{staticClass:"value"},[t._v("--")])])])};i._withStripped=!0;var a=s(40556),n=a.Z,o=(s(62388),(0,s(35471).Z)(n,i,[],!1,null,null,null));o.options.__file="src/views/executive-history/step-detail/components/task-step/view/no-start.vue";var r=o.exports},69753:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"task-execute-bar-step-description-popover"},[s("div",[t._v("\n        "+t._s(t.data.typeDesc)+":"),s("span",{staticClass:"value"},[t._v(t._s(t.data.name))])]),t._v(" "),s("div",[t._v("\n        "+t._s(t.$t("history.步骤状态"))+":"),s("span",{staticClass:"value",class:[t.data.displayStyle]},[t._v(t._s(t.data.statusDesc))])]),t._v(" "),s("div",[t._v("\n        "+t._s(t.$t("history.步骤耗时"))+":"),s("span",{staticClass:"value"},[t._v(t._s(t.data.totalTimeText))])])])};i._withStripped=!0;var a=s(37587),n=a.Z,o=(s(43941),(0,s(35471).Z)(n,i,[],!1,null,null,null));o.options.__file="src/views/executive-history/step-detail/components/task-step/view/normal.vue";var r=o.exports},65095:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("lower-component",[s("div",[s("div",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.bottom",value:t.$t("history.全局变量"),expression:"$t('history.全局变量')",modifiers:{bottom:!0}}],staticClass:"action-btn",on:{click:t.handleShowGlobalVariable}},[s("Icon",{attrs:{type:"global-var-line"}})],1),t._v(" "),s("jb-sideslider",{attrs:{"is-show":t.isShow,"quick-close":!0,title:t.$t("history.全局变量"),"show-footer":!1,width:960},on:{"update:isShow":function(e){t.isShow=e},"update:is-show":function(e){t.isShow=e}}},[s("global-variable",{attrs:{id:t.taskInstanceId}})],1)],1)])};i._withStripped=!0;var a=s(99801),n=a.Z,o=(0,s(35471).Z)(n,i,[],!1,null,null,null);o.options.__file="src/views/executive-history/step-detail/components/view-global-variable.vue";var r=o.exports},82329:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("lower-component",[s("div",[s("div",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.bottom",value:t.$t("history.操作记录"),expression:"$t('history.操作记录')",modifiers:{bottom:!0}}],staticClass:"action-btn",on:{click:t.handleShowOperationRecord}},[s("Icon",{attrs:{type:"history"}})],1),t._v(" "),s("jb-sideslider",{attrs:{"is-show":t.isShow,"quick-close":!0,title:t.$t("history.操作记录"),"show-footer":!1,width:900},on:{"update:isShow":function(e){t.isShow=e},"update:is-show":function(e){t.isShow=e}}},[s("operation-record",{attrs:{id:t.taskInstanceId},on:{"on-change":t.handleOperationRecordChange}})],1)],1)])};i._withStripped=!0;var a=s(94068),n=a.Z,o=(0,s(35471).Z)(n,i,[],!1,null,null,null);o.options.__file="src/views/executive-history/step-detail/components/view-operation-record.vue";var r=o.exports},39744:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("lower-component",[s("div",[s("div",{directives:[{name:"bk-tooltips",rawName:"v-bk-tooltips.bottom",value:t.$t("history.步骤内容"),expression:"$t('history.步骤内容')",modifiers:{bottom:!0}}],staticClass:"action-btn",on:{click:t.handleShowStepDetail}},[s("Icon",{attrs:{type:"detail-line"}})],1),t._v(" "),s("jb-sideslider",{attrs:{"is-show":t.isShow,title:t.$t("history.查看步骤内容"),"quick-close":!0,"show-footer":!1,width:960},on:{"update:isShow":function(e){t.isShow=e},"update:is-show":function(e){t.isShow=e}}},[s("step-detail-view",{attrs:{"task-id":t.taskInstanceId,id:t.stepInstanceId}})],1)],1)])};i._withStripped=!0;var a=s(53676),n=a.Z,o=(0,s(35471).Z)(n,i,[],!1,null,null,null);o.options.__file="src/views/executive-history/step-detail/components/view-step-info.vue";var r=o.exports},38201:function(t,e,s){"use strict";s.r(e),s.d(e,{__esModule:function(){return a.X},default:function(){return r}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"executive-history-step"},[s("task-status",{ref:"taskStatus",on:{"on-init":t.handleTaskInit}},[s("div",{staticClass:"step-info-header"},[s("div",{staticClass:"step-info-wraper"},[s("div",{staticClass:"step-type-text"},[t._v(t._s(t.stepTypeText))]),t._v(" "),s("div",{staticClass:"step-name-box"},[s("div",{staticClass:"step-name-text"},[t._v(t._s(t.data.name))]),t._v(" "),s("execution-history-select",{ref:"executionHistorySelect",attrs:{"step-instance-id":t.params.id,"retry-count":t.params.retryCount},on:{"on-change":t.handleRetryCountChange}})],1)]),t._v(" "),s("div",{staticClass:"step-action-box"},t._l(t.data.actions,(function(e){return s("step-action",{key:e,attrs:{name:e,"display-style":"step-detail","confirm-handler":function(e){return t.handleStatusUpdate(e)}}})})),1),t._v(" "),s("div",{staticClass:"log-search-box"},[s("compose-form-item",[s("bk-select",{staticStyle:{width:"100px"},attrs:{clearable:!1},model:{value:t.searchModel,callback:function(e){t.searchModel=e},expression:"searchModel"}},[s("bk-option",{attrs:{id:"log",name:t.$t("history.搜索日志")}}),t._v(" "),s("bk-option",{attrs:{id:"ip",name:t.$t("history.搜索 IP")}})],1),t._v(" "),"log"===t.searchModel?s("bk-input",{key:"log",staticStyle:{width:"292px"},attrs:{value:t.params.keyword,disabled:t.isFile,"tippy-tips":t.isFile?t.$t("history.分发文件步骤不支持日志搜索"):"","right-icon":"bk-icon icon-search"},on:{keyup:t.handleLogSearch}}):t._e(),t._v(" "),"ip"===t.searchModel?s("bk-input",{key:"ip",staticStyle:{width:"292px"},attrs:{value:t.params.searchIp,"right-icon":"bk-icon icon-search"},on:{keyup:t.handleIPSearch}}):t._e()],1),t._v(" "),t.isLogSearching?s("div",{staticClass:"search-loading"},[s("Icon",{staticClass:"loading-flag",attrs:{type:"loading"}})],1):t._e(),t._v(" "),t.isIPSearching?s("div",{staticClass:"search-loading"},[s("Icon",{staticClass:"loading-flag",attrs:{type:"loading"}})],1):t._e()],1),t._v(" "),s("export-log",{attrs:{"step-instance-id":t.params.id,"is-file":t.isFile}}),t._v(" "),s("div",{staticClass:"task-instance-action"},[t.isTask?s("view-global-variable",{attrs:{"task-instance-id":t.taskInstanceId}}):t._e(),t._v(" "),s("view-operation-record",{attrs:{"task-instance-id":t.taskInstanceId}}),t._v(" "),s("view-step-info",{attrs:{"task-instance-id":t.taskInstanceId,"step-instance-id":t.params.id}})],1)],1),t._v(" "),s("group-tab",{attrs:{data:t.data.resultGroups},on:{"on-change":t.handelGroupChange}}),t._v(" "),s("div",{staticClass:"detail-container"},[s("div",{directives:[{name:"bkloading",rawName:"v-bkloading",value:{isLoading:t.isHostLoading},expression:"{ isLoading: isHostLoading }"}],staticClass:"container-left"},[s("ip-list",{attrs:{name:t.data.stepInstanceId+"_"+t.dispalyGroup.groupName+"_"+t.params.retryCount+"_"+t.params.keyword+"_"+t.params.searchIp,total:t.dispalyGroup.agentTaskSize,"list-loading":t.isLoading,"pagination-loading":t.paginationChangeLoading,data:t.dispalyGroup.agentTaskExecutionDetail,"search-value":t.params.keyword+"_"+t.params.searchIp},on:{"on-pagination-change":t.handlePaginationChange,"on-copy":t.handleCopyHost,"on-sort":t.handleSort,"on-clear-search":t.handleClearSearch,"on-change":t.handleHostChange}})],1),t._v(" "),s("div",{staticClass:"container-right"},[t.data.stepInstanceId?s("execution-info",{attrs:{name:t.params.id+"_"+t.params.retryCount+"_"+t.dispalyGroup.groupName+"_"+t.currentHost.ip+"_"+t.params.keyword,"step-instance-id":t.data.stepInstanceId,"retry-count":t.params.retryCount,host:t.currentHost,"log-filter":t.params.keyword,"is-file":t.isFile,"is-task":t.isTask},on:{"on-search":t.handleLogSearch}}):t._e()],1)])],1),t._v(" "),t.data.name?s("execution-status-bar",{attrs:{type:"step",data:t.data}},[t.data.isForcedEnable?s("step-action",{key:"forced",attrs:{name:"forced","display-style":"step-detail","confirm-handler":t.handleForceTask},on:{"on-cancel":t.handleCancelForceTask,"on-show":t.handleStartForceTask}}):t._e()],1):t._e()],1)};i._withStripped=!0;var a=s(19751),n=a.Z,o=(s(46201),(0,s(35471).Z)(n,i,[],!1,null,null,null));o.options.__file="src/views/executive-history/step-detail/index.vue";var r=o.exports},31865:function(t,e,s){var i=s(69690);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(13570).Z)("561b9596",i,!1,{})},25968:function(t,e,s){var i=s(1844);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(13570).Z)("cdac7a66",i,!1,{})},90927:function(t,e,s){var i=s(70118);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(13570).Z)("e442f2b6",i,!1,{})},71186:function(t,e,s){var i=s(80440);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(13570).Z)("2bfbee76",i,!1,{})},70032:function(t,e,s){var i=s(21283);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(13570).Z)("7722241c",i,!1,{})},13667:function(t,e,s){var i=s(11476);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(13570).Z)("402245f6",i,!1,{})},63289:function(t,e,s){var i=s(22949);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(13570).Z)("528b8e55",i,!1,{})},58168:function(t,e,s){var i=s(34492);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(13570).Z)("1e4ddcf8",i,!1,{})},1669:function(t,e,s){var i=s(72803);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(13570).Z)("caf63472",i,!1,{})},8062:function(t,e,s){var i=s(57040);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(13570).Z)("12e5a00d",i,!1,{})},83369:function(t,e,s){var i=s(64534);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(13570).Z)("50437f52",i,!1,{})},1858:function(t,e,s){var i=s(40235);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(13570).Z)("4a8b2a70",i,!1,{})},62388:function(t,e,s){var i=s(97683);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(13570).Z)("37509054",i,!1,{})},43941:function(t,e,s){var i=s(43560);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(13570).Z)("90c58d90",i,!1,{})},46201:function(t,e,s){var i=s(68998);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[t.id,i,""]]),i.locals&&(t.exports=i.locals);(0,s(13570).Z)("cc95f26e",i,!1,{})}}]);